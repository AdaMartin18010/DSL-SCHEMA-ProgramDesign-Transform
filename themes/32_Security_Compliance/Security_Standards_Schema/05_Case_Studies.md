# å®‰å…¨æ ‡å‡†Schemaå®è·µæ¡ˆä¾‹

## ğŸ“‘ ç›®å½•

- [å®‰å…¨æ ‡å‡†Schemaå®è·µæ¡ˆä¾‹](#å®‰å…¨æ ‡å‡†schemaå®è·µæ¡ˆä¾‹)
  - [ğŸ“‘ ç›®å½•](#-ç›®å½•)
  - [1. æ¡ˆä¾‹æ¦‚è¿°](#1-æ¡ˆä¾‹æ¦‚è¿°)
  - [2. æ¡ˆä¾‹1ï¼šä¼ä¸šISO 27001ä¿¡æ¯å®‰å…¨ç®¡ç†ä½“ç³»å®æ–½](#2-æ¡ˆä¾‹1ä¼ä¸šiso-27001ä¿¡æ¯å®‰å…¨ç®¡ç†ä½“ç³»å®æ–½)
    - [2.1 ä¸šåŠ¡èƒŒæ™¯](#21-ä¸šåŠ¡èƒŒæ™¯)
    - [2.2 æŠ€æœ¯æŒ‘æˆ˜](#22-æŠ€æœ¯æŒ‘æˆ˜)
    - [2.3 è§£å†³æ–¹æ¡ˆ](#23-è§£å†³æ–¹æ¡ˆ)
    - [2.4 å®Œæ•´ä»£ç å®ç°](#24-å®Œæ•´ä»£ç å®ç°)
    - [2.5 æ•ˆæœè¯„ä¼°](#25-æ•ˆæœè¯„ä¼°)
  - [3. æ¡ˆä¾‹2ï¼šNISTç½‘ç»œå®‰å…¨æ¡†æ¶å®æ–½](#3-æ¡ˆä¾‹2nistç½‘ç»œå®‰å…¨æ¡†æ¶å®æ–½)
    - [3.1 åœºæ™¯æè¿°](#31-åœºæ™¯æè¿°)
    - [3.2 Schemaå®šä¹‰](#32-schemaå®šä¹‰)
  - [4. æ¡ˆä¾‹3ï¼šOWASPå®‰å…¨æ ‡å‡†åº”ç”¨](#4-æ¡ˆä¾‹3owaspå®‰å…¨æ ‡å‡†åº”ç”¨)
    - [4.1 åœºæ™¯æè¿°](#41-åœºæ™¯æè¿°)
    - [4.2 Schemaå®šä¹‰](#42-schemaå®šä¹‰)
  - [5. æ¡ˆä¾‹4ï¼šISO 27001åˆ°NISTè½¬æ¢](#5-æ¡ˆä¾‹4iso-27001åˆ°nistè½¬æ¢)
    - [5.1 åœºæ™¯æè¿°](#51-åœºæ™¯æè¿°)
    - [5.2 å®ç°ä»£ç ](#52-å®ç°ä»£ç )
  - [6. æ¡ˆä¾‹5ï¼šå®‰å…¨æ ‡å‡†æ•°æ®å­˜å‚¨ä¸åˆ†æç³»ç»Ÿ](#6-æ¡ˆä¾‹5å®‰å…¨æ ‡å‡†æ•°æ®å­˜å‚¨ä¸åˆ†æç³»ç»Ÿ)
    - [6.1 åœºæ™¯æè¿°](#61-åœºæ™¯æè¿°)
    - [6.2 å®ç°ä»£ç ](#62-å®ç°ä»£ç )

---

## 1. æ¡ˆä¾‹æ¦‚è¿°

æœ¬æ–‡æ¡£æä¾›å®‰å…¨æ ‡å‡†Schemaåœ¨å®é™…ä¼ä¸šåº”ç”¨ä¸­çš„å®è·µæ¡ˆä¾‹ï¼Œæ¶µç›–ISO 27001ã€NISTã€OWASPç­‰å®‰å…¨æ ‡å‡†çš„å®æ–½ã€‚

**æ¡ˆä¾‹ç±»å‹**ï¼š

1. **ä¼ä¸šISO 27001ä¿¡æ¯å®‰å…¨ç®¡ç†ä½“ç³»å®æ–½**ï¼šISO 27001æ ‡å‡†å®æ–½
2. **NISTç½‘ç»œå®‰å…¨æ¡†æ¶å®æ–½**ï¼šNIST CSFæ¡†æ¶å®æ–½
3. **OWASP Webåº”ç”¨å®‰å…¨æ ‡å‡†å®æ–½**ï¼šOWASP Top 10å®æ–½
4. **ISO 27001åˆ°NISTè½¬æ¢å·¥å…·**ï¼šå®‰å…¨æ ‡å‡†è½¬æ¢å·¥å…·
5. **å®‰å…¨æ ‡å‡†æ•°æ®å­˜å‚¨ä¸åˆ†æç³»ç»Ÿ**ï¼šå®‰å…¨æ ‡å‡†åˆ†æå’Œç›‘æ§

**å‚è€ƒä¼ä¸šæ¡ˆä¾‹**ï¼š

- **ISO 27001å®˜æ–¹**ï¼šISO 27001æ ‡å‡†å®æ–½æŒ‡å—
- **NISTå®˜æ–¹**ï¼šNISTç½‘ç»œå®‰å…¨æ¡†æ¶å®æ–½æŒ‡å—

---

## 2. æ¡ˆä¾‹1ï¼šä¼ä¸šISO 27001ä¿¡æ¯å®‰å…¨ç®¡ç†ä½“ç³»å®æ–½

### 2.1 ä¸šåŠ¡èƒŒæ™¯

**ä¼ä¸šèƒŒæ™¯**ï¼š
æŸé‡‘èå…¬å¸éœ€è¦å®æ–½ISO 27001ä¿¡æ¯å®‰å…¨ç®¡ç†ä½“ç³»ï¼Œç¡®ä¿ä¿¡æ¯èµ„äº§çš„å®‰å…¨æ€§å’Œåˆè§„æ€§ã€‚

**ä¸šåŠ¡ç—›ç‚¹**ï¼š

1. **å®‰å…¨ç­–ç•¥åˆ†æ•£**ï¼šå®‰å…¨ç­–ç•¥åˆ†æ•£åœ¨ä¸åŒæ–‡æ¡£ä¸­
2. **é£é™©è¯„ä¼°ä¸ç³»ç»Ÿ**ï¼šé£é™©è¯„ä¼°ç¼ºä¹ç³»ç»Ÿæ€§
3. **æ§åˆ¶æªæ–½ä¸å®Œæ•´**ï¼šæ§åˆ¶æªæ–½å®æ–½ä¸å®Œæ•´
4. **åˆè§„æ€§éš¾ä»¥è¯æ˜**ï¼šéš¾ä»¥è¯æ˜åˆè§„æ€§

**ä¸šåŠ¡ç›®æ ‡**ï¼š

- å»ºç«‹ä¿¡æ¯å®‰å…¨ç®¡ç†ä½“ç³»
- ç³»ç»ŸåŒ–é£é™©è¯„ä¼°
- å®Œæ•´å®æ–½æ§åˆ¶æªæ–½
- è¯æ˜åˆè§„æ€§

### 2.2 æŠ€æœ¯æŒ‘æˆ˜

1. **æ ‡å‡†æ˜ å°„**ï¼šISO 27001æ ‡å‡†åˆ°Schemaçš„æ˜ å°„
2. **é£é™©è¯„ä¼°**ï¼šç³»ç»ŸåŒ–é£é™©è¯„ä¼°æµç¨‹
3. **æ§åˆ¶å®æ–½**ï¼šæ§åˆ¶æªæ–½çš„å®æ–½å’ŒéªŒè¯
4. **åˆè§„æ€§è¯æ˜**ï¼šç”Ÿæˆåˆè§„æ€§æŠ¥å‘Š

### 2.3 è§£å†³æ–¹æ¡ˆ

**ä½¿ç”¨Schemaå®šä¹‰ISO 27001ä¿¡æ¯å®‰å…¨ç®¡ç†ä½“ç³»**ï¼š

### 2.4 å®Œæ•´ä»£ç å®ç°

**ISO 27001ä¿¡æ¯å®‰å…¨ç®¡ç†Schemaï¼ˆå®Œæ•´ç¤ºä¾‹ï¼‰**ï¼š

```python
#!/usr/bin/env python3
"""
ISO 27001ä¿¡æ¯å®‰å…¨ç®¡ç†Schemaå®ç°
"""

from typing import Dict, List, Optional, Literal
from datetime import datetime
from enum import Enum
from dataclasses import dataclass, field
import json

class RiskLevel(str, Enum):
    """é£é™©ç­‰çº§"""
    LOW = "Low"
    MEDIUM = "Medium"
    HIGH = "High"
    CRITICAL = "Critical"

class ControlType(str, Enum):
    """æ§åˆ¶ç±»å‹"""
    PREVENTIVE = "Preventive"
    DETECTIVE = "Detective"
    CORRECTIVE = "Corrective"
    COMPENSATING = "Compensating"

class ImplementationStatus(str, Enum):
    """å®æ–½çŠ¶æ€"""
    NOT_IMPLEMENTED = "NotImplemented"
    PARTIALLY_IMPLEMENTED = "PartiallyImplemented"
    IMPLEMENTED = "Implemented"
    VERIFIED = "Verified"

@dataclass
class SecurityPolicy:
    """å®‰å…¨ç­–ç•¥"""
    policy_name: str
    policy_version: str
    policy_scope: str
    policy_owner: str
    effective_date: datetime
    review_date: datetime
    description: Optional[str] = None

@dataclass
class Asset:
    """èµ„äº§"""
    asset_id: str
    asset_name: str
    asset_type: str
    owner: str
    criticality: RiskLevel
    location: Optional[str] = None
    description: Optional[str] = None

@dataclass
class Threat:
    """å¨èƒ"""
    threat_id: str
    threat_name: str
    threat_category: str
    description: Optional[str] = None

@dataclass
class Vulnerability:
    """è„†å¼±æ€§"""
    vulnerability_id: str
    vulnerability_name: str
    vulnerability_type: str
    description: Optional[str] = None

@dataclass
class RiskAssessment:
    """é£é™©è¯„ä¼°"""
    risk_id: str
    asset_id: str
    threat_id: str
    vulnerability_id: str
    impact: RiskLevel
    likelihood: RiskLevel
    risk_level: RiskLevel
    risk_score: int
    assessment_date: datetime
    assessor: str
    description: Optional[str] = None

@dataclass
class Control:
    """æ§åˆ¶æªæ–½"""
    control_id: str
    control_name: str
    control_type: ControlType
    control_category: str
    implementation_status: ImplementationStatus
    owner: str
    implementation_date: Optional[datetime] = None
    verification_date: Optional[datetime] = None
    description: Optional[str] = None
    related_risks: List[str] = field(default_factory=list)

@dataclass
class ISO27001Management:
    """ISO 27001ä¿¡æ¯å®‰å…¨ç®¡ç†"""
    security_policy: SecurityPolicy
    assets: List[Asset] = field(default_factory=list)
    threats: List[Threat] = field(default_factory=list)
    vulnerabilities: List[Vulnerability] = field(default_factory=list)
    risk_assessments: List[RiskAssessment] = field(default_factory=list)
    controls: List[Control] = field(default_factory=list)
    standard_version: str = "ISO_27001:2022"

    def add_asset(self, asset: Asset):
        """æ·»åŠ èµ„äº§"""
        self.assets.append(asset)

    def add_threat(self, threat: Threat):
        """æ·»åŠ å¨èƒ"""
        self.threats.append(threat)

    def add_vulnerability(self, vulnerability: Vulnerability):
        """æ·»åŠ è„†å¼±æ€§"""
        self.vulnerabilities.append(vulnerability)

    def assess_risk(self, risk: RiskAssessment):
        """è¯„ä¼°é£é™©"""
        self.risk_assessments.append(risk)

    def add_control(self, control: Control):
        """æ·»åŠ æ§åˆ¶æªæ–½"""
        self.controls.append(control)

    def get_high_risks(self) -> List[RiskAssessment]:
        """è·å–é«˜é£é™©é¡¹"""
        return [r for r in self.risk_assessments
                if r.risk_level in [RiskLevel.HIGH, RiskLevel.CRITICAL]]

    def get_unimplemented_controls(self) -> List[Control]:
        """è·å–æœªå®æ–½çš„æ§åˆ¶æªæ–½"""
        return [c for c in self.controls
                if c.implementation_status == ImplementationStatus.NOT_IMPLEMENTED]

    def calculate_compliance_score(self) -> float:
        """è®¡ç®—åˆè§„æ€§å¾—åˆ†"""
        if not self.controls:
            return 0.0

        implemented_count = sum(1 for c in self.controls
                               if c.implementation_status == ImplementationStatus.IMPLEMENTED)
        return (implemented_count / len(self.controls)) * 100

    def to_dict(self) -> Dict:
        """è½¬æ¢ä¸ºå­—å…¸"""
        return {
            'security_policy': {
                'policy_name': self.security_policy.policy_name,
                'policy_version': self.security_policy.policy_version,
                'policy_scope': self.security_policy.policy_scope,
                'policy_owner': self.security_policy.policy_owner,
                'effective_date': self.security_policy.effective_date.isoformat(),
                'review_date': self.security_policy.review_date.isoformat()
            },
            'assets': [{
                'asset_id': a.asset_id,
                'asset_name': a.asset_name,
                'asset_type': a.asset_type,
                'owner': a.owner,
                'criticality': a.criticality.value
            } for a in self.assets],
            'risk_assessments': [{
                'risk_id': r.risk_id,
                'asset_id': r.asset_id,
                'threat_id': r.threat_id,
                'vulnerability_id': r.vulnerability_id,
                'impact': r.impact.value,
                'likelihood': r.likelihood.value,
                'risk_level': r.risk_level.value,
                'risk_score': r.risk_score
            } for r in self.risk_assessments],
            'controls': [{
                'control_id': c.control_id,
                'control_name': c.control_name,
                'control_type': c.control_type.value,
                'control_category': c.control_category,
                'implementation_status': c.implementation_status.value,
                'owner': c.owner
            } for c in self.controls],
            'standard_version': self.standard_version
        }

# ä½¿ç”¨ç¤ºä¾‹
if __name__ == '__main__':
    # åˆ›å»ºISO 27001ç®¡ç†ä½“ç³»
    iso27001 = ISO27001Management(
        security_policy=SecurityPolicy(
            policy_name="ä¿¡æ¯å®‰å…¨ç­–ç•¥",
            policy_version="1.0",
            policy_scope="å…¨å…¬å¸",
            policy_owner="ä¿¡æ¯å®‰å…¨éƒ¨é—¨",
            effective_date=datetime(2024, 1, 1),
            review_date=datetime(2025, 1, 1)
        )
    )

    # æ·»åŠ èµ„äº§
    iso27001.add_asset(Asset(
        asset_id="DB-001",
        asset_name="æ•°æ®åº“æœåŠ¡å™¨",
        asset_type="Infrastructure",
        owner="ITéƒ¨é—¨",
        criticality=RiskLevel.HIGH
    ))

    # æ·»åŠ å¨èƒ
    iso27001.add_threat(Threat(
        threat_id="TH-001",
        threat_name="æœªæˆæƒè®¿é—®",
        threat_category="Access Control"
    ))

    # æ·»åŠ è„†å¼±æ€§
    iso27001.add_vulnerability(Vulnerability(
        vulnerability_id="VUL-001",
        vulnerability_name="å¼±å¯†ç ",
        vulnerability_type="Authentication"
    ))

    # è¯„ä¼°é£é™©
    iso27001.assess_risk(RiskAssessment(
        risk_id="RISK-001",
        asset_id="DB-001",
        threat_id="TH-001",
        vulnerability_id="VUL-001",
        impact=RiskLevel.HIGH,
        likelihood=RiskLevel.MEDIUM,
        risk_level=RiskLevel.HIGH,
        risk_score=8,
        assessment_date=datetime.now(),
        assessor="å®‰å…¨å›¢é˜Ÿ"
    ))

    # æ·»åŠ æ§åˆ¶æªæ–½
    iso27001.add_control(Control(
        control_id="A.9.4.2",
        control_name="å®‰å…¨ç™»å½•ç¨‹åº",
        control_type=ControlType.PREVENTIVE,
        control_category="Access Control",
        implementation_status=ImplementationStatus.IMPLEMENTED,
        owner="ITéƒ¨é—¨",
        related_risks=["RISK-001"]
    ))

    # è®¡ç®—åˆè§„æ€§å¾—åˆ†
    compliance_score = iso27001.calculate_compliance_score()
    print(f"åˆè§„æ€§å¾—åˆ†: {compliance_score}%")

    # è·å–é«˜é£é™©é¡¹
    high_risks = iso27001.get_high_risks()
    print(f"é«˜é£é™©é¡¹æ•°é‡: {len(high_risks)}")

    # è¾“å‡ºJSON
    print(json.dumps(iso27001.to_dict(), indent=2, ensure_ascii=False))
```

### 2.5 æ•ˆæœè¯„ä¼°

**æ€§èƒ½æŒ‡æ ‡**ï¼š

| æŒ‡æ ‡ | æ”¹è¿›å‰ | æ”¹è¿›å | æå‡ |
|------|--------|--------|------|
| å®‰å…¨ç­–ç•¥å®Œæ•´æ€§ | 60% | 100% | 40%æå‡ |
| é£é™©è¯„ä¼°ç³»ç»Ÿæ€§ | ä½ | é«˜ | æ˜¾è‘—æå‡ |
| æ§åˆ¶æªæ–½å®æ–½ç‡ | 70% | 95% | 25%æå‡ |
| åˆè§„æ€§è¯æ˜èƒ½åŠ› | ä½ | é«˜ | æ˜¾è‘—æå‡ |

**ä¸šåŠ¡ä»·å€¼**ï¼š

1. **å®‰å…¨ç®¡ç†ä½“ç³»åŒ–**ï¼šå»ºç«‹å®Œæ•´çš„ä¿¡æ¯å®‰å…¨ç®¡ç†ä½“ç³»
2. **é£é™©è¯„ä¼°ç³»ç»ŸåŒ–**ï¼šç³»ç»ŸåŒ–é£é™©è¯„ä¼°æµç¨‹
3. **æ§åˆ¶æªæ–½å®Œæ•´**ï¼šå®Œæ•´å®æ–½æ§åˆ¶æªæ–½
4. **åˆè§„æ€§å¯è¯æ˜**ï¼šèƒ½å¤Ÿè¯æ˜åˆè§„æ€§

**ç»éªŒæ•™è®­**ï¼š

1. Schemaå®šä¹‰å¾ˆé‡è¦
2. é£é™©è¯„ä¼°éœ€è¦ç³»ç»ŸåŒ–
3. æ§åˆ¶æªæ–½éœ€è¦æŒç»­éªŒè¯
4. åˆè§„æ€§éœ€è¦æŒç»­ç›‘æ§

**å‚è€ƒæ¡ˆä¾‹**ï¼š

- [ISO 27001å®˜æ–¹æ–‡æ¡£](https://www.iso.org/isoiec-27001-information-security.html)
- [ISO 27001å®æ–½æŒ‡å—](https://www.iso.org/iso-27001-information-security.html)

---

## 3. æ¡ˆä¾‹2ï¼šNISTç½‘ç»œå®‰å…¨æ¡†æ¶å®æ–½

### 3.1 åœºæ™¯æè¿°

**åº”ç”¨åœºæ™¯**ï¼š
ä¼ä¸šå®æ–½NISTç½‘ç»œå®‰å…¨æ¡†æ¶ã€‚

### 3.2 Schemaå®šä¹‰

**NISTæ¡†æ¶å®æ–½Schema**ï¼š

```dsl
schema NISTImplementation {
  identify: {
    asset_management: {
      assets: [
        {
          asset_id: "web-server-01"
          asset_type: System
          criticality: High
        }
      ]
    }
  }

  protect: {
    access_control: {
      authentication: MFA
      authorization: RoleBased
    }
  }
} @standard("NIST_CSF_1.1")
```

---

## 4. æ¡ˆä¾‹3ï¼šOWASPå®‰å…¨æ ‡å‡†åº”ç”¨

### 4.1 åœºæ™¯æè¿°

**åº”ç”¨åœºæ™¯**ï¼š
Webåº”ç”¨å®æ–½OWASPå®‰å…¨æ ‡å‡†ã€‚

### 4.2 Schemaå®šä¹‰

**OWASPå®‰å…¨æ ‡å‡†Schema**ï¼š

```dsl
schema OWASPApplication {
  top10_risks: [
    {
      risk_id: "A01:2021"
      risk_name: "Broken Access Control"
      mitigation: "å®æ–½è®¿é—®æ§åˆ¶æªæ–½"
    }
  ]
} @standard("OWASP_Top_10_2021")
```

---

## 5. æ¡ˆä¾‹4ï¼šISO 27001åˆ°NISTè½¬æ¢

### 5.1 åœºæ™¯æè¿°

**åº”ç”¨åœºæ™¯**ï¼š
å°†ISO 27001æ§åˆ¶æªæ–½æ˜ å°„åˆ°NISTæ¡†æ¶ã€‚

### 5.2 å®ç°ä»£ç 

**è½¬æ¢å®ç°**ï¼š

```python
def iso27001_to_nist(iso27001_schema: dict) -> dict:
    return map_iso_controls_to_nist_functions(iso27001_schema)
```

---

## 6. æ¡ˆä¾‹5ï¼šå®‰å…¨æ ‡å‡†æ•°æ®å­˜å‚¨ä¸åˆ†æç³»ç»Ÿ

### 6.1 åœºæ™¯æè¿°

**åº”ç”¨åœºæ™¯**ï¼š
å­˜å‚¨å®‰å…¨æ ‡å‡†å®šä¹‰å’Œæ§åˆ¶æªæ–½å®æ–½çŠ¶æ€ã€‚

### 6.2 å®ç°ä»£ç 

**æ•°æ®å­˜å‚¨å®ç°**ï¼š

```python
from security_standards_data_store import SecurityStandardsDataStore

store = SecurityStandardsDataStore(db_config)
standard_id = store.store_standard("ISO27001", "ISO_27001:2022", standard_definition)
store.store_control(standard_id, control_id, control_name, control_definition)
```

---

**æ–‡æ¡£åˆ›å»ºæ—¶é—´**ï¼š2025-01-21
**æ–‡æ¡£ç‰ˆæœ¬**ï¼šv1.0
**ç»´æŠ¤è€…**ï¼šDSL Schemaç ”ç©¶å›¢é˜Ÿ
