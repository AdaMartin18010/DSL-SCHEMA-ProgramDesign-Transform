# å®‰å…¨å®¡è®¡Schemaå®è·µæ¡ˆä¾‹

## ğŸ“‘ ç›®å½•

- [å®‰å…¨å®¡è®¡Schemaå®è·µæ¡ˆä¾‹](#å®‰å…¨å®¡è®¡schemaå®è·µæ¡ˆä¾‹)
  - [ğŸ“‘ ç›®å½•](#-ç›®å½•)
  - [1. æ¡ˆä¾‹æ¦‚è¿°](#1-æ¡ˆä¾‹æ¦‚è¿°)
  - [2. æ¡ˆä¾‹1ï¼šä¼ä¸šISO 27001åˆè§„å®¡è®¡ç³»ç»Ÿ](#2-æ¡ˆä¾‹1ä¼ä¸šiso-27001åˆè§„å®¡è®¡ç³»ç»Ÿ)
    - [2.1 ä¸šåŠ¡èƒŒæ™¯](#21-ä¸šåŠ¡èƒŒæ™¯)
    - [2.2 æŠ€æœ¯æŒ‘æˆ˜](#22-æŠ€æœ¯æŒ‘æˆ˜)
    - [2.3 è§£å†³æ–¹æ¡ˆ](#23-è§£å†³æ–¹æ¡ˆ)
    - [2.4 å®Œæ•´ä»£ç å®ç°](#24-å®Œæ•´ä»£ç å®ç°)
    - [2.5 æ•ˆæœè¯„ä¼°](#25-æ•ˆæœè¯„ä¼°)
  - [3. æ¡ˆä¾‹2ï¼šå®‰å…¨äº‹ä»¶å®¡è®¡ç³»ç»Ÿ](#3-æ¡ˆä¾‹2å®‰å…¨äº‹ä»¶å®¡è®¡ç³»ç»Ÿ)
    - [3.1 ä¸šåŠ¡èƒŒæ™¯](#31-ä¸šåŠ¡èƒŒæ™¯)
    - [3.2 æŠ€æœ¯æŒ‘æˆ˜](#32-æŠ€æœ¯æŒ‘æˆ˜)
    - [3.3 è§£å†³æ–¹æ¡ˆ](#33-è§£å†³æ–¹æ¡ˆ)
    - [3.4 å®Œæ•´ä»£ç å®ç°](#34-å®Œæ•´ä»£ç å®ç°)
    - [3.5 æ•ˆæœè¯„ä¼°](#35-æ•ˆæœè¯„ä¼°)
  - [4. æ¡ˆä¾‹3ï¼šåˆè§„çŠ¶æ€è¯„ä¼°ç³»ç»Ÿ](#4-æ¡ˆä¾‹3åˆè§„çŠ¶æ€è¯„ä¼°ç³»ç»Ÿ)
    - [4.1 ä¸šåŠ¡èƒŒæ™¯](#41-ä¸šåŠ¡èƒŒæ™¯)
    - [4.2 æŠ€æœ¯æŒ‘æˆ˜](#42-æŠ€æœ¯æŒ‘æˆ˜)
    - [4.3 è§£å†³æ–¹æ¡ˆ](#43-è§£å†³æ–¹æ¡ˆ)
    - [4.4 å®Œæ•´ä»£ç å®ç°](#44-å®Œæ•´ä»£ç å®ç°)
    - [4.5 æ•ˆæœè¯„ä¼°](#45-æ•ˆæœè¯„ä¼°)
  - [5. æ¡ˆä¾‹4ï¼šå®¡è®¡æ—¥å¿—åˆ°åˆè§„æŠ¥å‘Šè½¬æ¢å·¥å…·](#5-æ¡ˆä¾‹4å®¡è®¡æ—¥å¿—åˆ°åˆè§„æŠ¥å‘Šè½¬æ¢å·¥å…·)
    - [5.1 ä¸šåŠ¡èƒŒæ™¯](#51-ä¸šåŠ¡èƒŒæ™¯)
    - [5.2 æŠ€æœ¯æŒ‘æˆ˜](#52-æŠ€æœ¯æŒ‘æˆ˜)
    - [5.3 è§£å†³æ–¹æ¡ˆ](#53-è§£å†³æ–¹æ¡ˆ)
    - [5.4 å®Œæ•´ä»£ç å®ç°](#54-å®Œæ•´ä»£ç å®ç°)
    - [5.5 æ•ˆæœè¯„ä¼°](#55-æ•ˆæœè¯„ä¼°)
  - [6. æ¡ˆä¾‹5ï¼šå®‰å…¨å®¡è®¡æ•°æ®å­˜å‚¨ä¸åˆ†æç³»ç»Ÿ](#6-æ¡ˆä¾‹5å®‰å…¨å®¡è®¡æ•°æ®å­˜å‚¨ä¸åˆ†æç³»ç»Ÿ)
    - [6.1 ä¸šåŠ¡èƒŒæ™¯](#61-ä¸šåŠ¡èƒŒæ™¯)
    - [6.2 æŠ€æœ¯æŒ‘æˆ˜](#62-æŠ€æœ¯æŒ‘æˆ˜)
    - [6.3 è§£å†³æ–¹æ¡ˆ](#63-è§£å†³æ–¹æ¡ˆ)
    - [6.4 å®Œæ•´ä»£ç å®ç°](#64-å®Œæ•´ä»£ç å®ç°)
    - [6.5 æ•ˆæœè¯„ä¼°](#65-æ•ˆæœè¯„ä¼°)
  - [7. æ¡ˆä¾‹æ€»ç»“](#7-æ¡ˆä¾‹æ€»ç»“)
    - [7.1 æˆåŠŸå› ç´ ](#71-æˆåŠŸå› ç´ )
    - [7.2 æœ€ä½³å®è·µ](#72-æœ€ä½³å®è·µ)
  - [8. å‚è€ƒæ–‡çŒ®](#8-å‚è€ƒæ–‡çŒ®)
    - [8.1 å®˜æ–¹æ–‡æ¡£](#81-å®˜æ–¹æ–‡æ¡£)
    - [8.2 æœ€ä½³å®è·µ](#82-æœ€ä½³å®è·µ)

---

## 1. æ¡ˆä¾‹æ¦‚è¿°

æœ¬æ–‡æ¡£æä¾›å®‰å…¨å®¡è®¡Schemaåœ¨å®é™…ä¼ä¸šåº”ç”¨ä¸­çš„å®è·µæ¡ˆä¾‹ï¼Œæ¶µç›–ISO 27001åˆè§„å®¡è®¡ã€å®‰å…¨äº‹ä»¶å®¡è®¡ã€åˆè§„çŠ¶æ€è¯„ä¼°ç­‰çœŸå®åœºæ™¯ã€‚

**æ¡ˆä¾‹ç±»å‹**ï¼š

1. **ä¼ä¸šISO 27001åˆè§„å®¡è®¡ç³»ç»Ÿ**ï¼šISO 27001åˆè§„å®¡è®¡
2. **å®‰å…¨äº‹ä»¶å®¡è®¡ç³»ç»Ÿ**ï¼šå®‰å…¨äº‹ä»¶å®¡è®¡
3. **åˆè§„çŠ¶æ€è¯„ä¼°ç³»ç»Ÿ**ï¼šåˆè§„çŠ¶æ€è¯„ä¼°
4. **å®¡è®¡æ—¥å¿—åˆ°åˆè§„æŠ¥å‘Šè½¬æ¢å·¥å…·**ï¼šå®¡è®¡æŠ¥å‘Šç”Ÿæˆ
5. **å®‰å…¨å®¡è®¡æ•°æ®å­˜å‚¨ä¸åˆ†æç³»ç»Ÿ**ï¼šå®¡è®¡æ•°æ®åˆ†æå’Œç›‘æ§

**å‚è€ƒä¼ä¸šæ¡ˆä¾‹**ï¼š

- **ISO 27001å®˜æ–¹**ï¼šISO 27001å®¡è®¡æŒ‡å—
- **NISTå®˜æ–¹**ï¼šNISTå®¡è®¡æ¡†æ¶

---

## 2. æ¡ˆä¾‹1ï¼šä¼ä¸šISO 27001åˆè§„å®¡è®¡ç³»ç»Ÿ

### 2.1 ä¸šåŠ¡èƒŒæ™¯

**ä¼ä¸šèƒŒæ™¯**ï¼š
æŸé‡‘èå…¬å¸éœ€è¦è¿›è¡ŒISO 27001åˆè§„å®¡è®¡ï¼Œç¡®ä¿ä¿¡æ¯å®‰å…¨ç®¡ç†ä½“ç³»çš„æœ‰æ•ˆæ€§å’Œåˆè§„æ€§ã€‚

**ä¸šåŠ¡ç—›ç‚¹**ï¼š

1. **å®¡è®¡æµç¨‹ä¸ç³»ç»Ÿ**ï¼šå®¡è®¡æµç¨‹ç¼ºä¹ç³»ç»Ÿæ€§
2. **å®¡è®¡å‘ç°ç®¡ç†å›°éš¾**ï¼šå®¡è®¡å‘ç°éš¾ä»¥è·Ÿè¸ªå’Œç®¡ç†
3. **åˆè§„çŠ¶æ€ä¸æ¸…æ™°**ï¼šåˆè§„çŠ¶æ€éš¾ä»¥è¯„ä¼°
4. **æŠ¥å‘Šç”Ÿæˆæ•ˆç‡ä½**ï¼šå®¡è®¡æŠ¥å‘Šç”Ÿæˆæ•ˆç‡ä½

**ä¸šåŠ¡ç›®æ ‡**ï¼š

- ç³»ç»ŸåŒ–å®¡è®¡æµç¨‹
- æœ‰æ•ˆç®¡ç†å®¡è®¡å‘ç°
- æ¸…æ™°è¯„ä¼°åˆè§„çŠ¶æ€
- æé«˜æŠ¥å‘Šç”Ÿæˆæ•ˆç‡

### 2.2 æŠ€æœ¯æŒ‘æˆ˜

1. **å®¡è®¡èŒƒå›´å®šä¹‰**ï¼šå®šä¹‰å®¡è®¡èŒƒå›´
2. **å®¡è®¡å‘ç°ç®¡ç†**ï¼šç³»ç»ŸåŒ–ç®¡ç†å®¡è®¡å‘ç°
3. **åˆè§„çŠ¶æ€è¯„ä¼°**ï¼šè‡ªåŠ¨åŒ–åˆè§„çŠ¶æ€è¯„ä¼°
4. **æŠ¥å‘Šç”Ÿæˆ**ï¼šè‡ªåŠ¨ç”Ÿæˆå®¡è®¡æŠ¥å‘Š

### 2.3 è§£å†³æ–¹æ¡ˆ

**ä½¿ç”¨Schemaå®šä¹‰ISO 27001åˆè§„å®¡è®¡ç³»ç»Ÿ**ï¼š

### 2.4 å®Œæ•´ä»£ç å®ç°

**ISO 27001åˆè§„å®¡è®¡Schemaï¼ˆå®Œæ•´ç¤ºä¾‹ï¼‰**ï¼š

```python
#!/usr/bin/env python3
"""
ISO 27001åˆè§„å®¡è®¡Schemaå®ç°
"""

from typing import Dict, List, Optional, Literal
from datetime import datetime
from enum import Enum
from dataclasses import dataclass, field
import json

class FindingType(str, Enum):
    """å®¡è®¡å‘ç°ç±»å‹"""
    COMPLIANCE = "Compliance"
    SECURITY = "Security"
    OPERATIONAL = "Operational"
    TECHNICAL = "Technical"

class FindingSeverity(str, Enum):
    """å®¡è®¡å‘ç°ä¸¥é‡ç¨‹åº¦"""
    LOW = "Low"
    MEDIUM = "Medium"
    HIGH = "High"
    CRITICAL = "Critical"

class ComplianceStatus(str, Enum):
    """åˆè§„çŠ¶æ€"""
    COMPLIANT = "Compliant"
    PARTIALLY_COMPLIANT = "PartiallyCompliant"
    NON_COMPLIANT = "NonCompliant"
    NOT_APPLICABLE = "NotApplicable"

@dataclass
class AuditScope:
    """å®¡è®¡èŒƒå›´"""
    scope_start_date: datetime
    scope_end_date: datetime
    scope_systems: List[str]
    scope_departments: List[str]
    scope_locations: List[str]
    description: Optional[str] = None

@dataclass
class AuditFinding:
    """å®¡è®¡å‘ç°"""
    finding_id: str
    finding_type: FindingType
    finding_severity: FindingSeverity
    finding_description: str
    finding_recommendation: str
    affected_controls: List[str] = field(default_factory=list)
    evidence: List[str] = field(default_factory=list)
    status: str = "Open"
    assigned_to: Optional[str] = None
    due_date: Optional[datetime] = None
    created_at: datetime = field(default_factory=datetime.now)
    updated_at: datetime = field(default_factory=datetime.now)

@dataclass
class ComplianceStatus:
    """åˆè§„çŠ¶æ€"""
    overall_status: ComplianceStatus
    compliance_score: float
    compliant_controls: int
    non_compliant_controls: int
    partially_compliant_controls: int
    total_controls: int
    assessment_date: datetime = field(default_factory=datetime.now)

@dataclass
class ISO27001Audit:
    """ISO 27001åˆè§„å®¡è®¡"""
    audit_id: str
    audit_scope: AuditScope
    audit_findings: List[AuditFinding] = field(default_factory=list)
    compliance_status: Optional[ComplianceStatus] = None
    auditor: str = ""
    audit_date: datetime = field(default_factory=datetime.now)
    standard_version: str = "ISO_27001:2022"

    def add_finding(self, finding: AuditFinding):
        """æ·»åŠ å®¡è®¡å‘ç°"""
        self.audit_findings.append(finding)

    def calculate_compliance_status(self, total_controls: int) -> ComplianceStatus:
        """è®¡ç®—åˆè§„çŠ¶æ€"""
        compliant_count = 0
        non_compliant_count = 0
        partially_compliant_count = 0

        # æ ¹æ®å®¡è®¡å‘ç°è®¡ç®—åˆè§„çŠ¶æ€
        for finding in self.audit_findings:
            if finding.finding_severity == FindingSeverity.CRITICAL:
                non_compliant_count += 1
            elif finding.finding_severity == FindingSeverity.HIGH:
                partially_compliant_count += 1
            elif finding.finding_severity == FindingSeverity.MEDIUM:
                partially_compliant_count += 1
            else:
                compliant_count += 1

        # è®¡ç®—åˆè§„å¾—åˆ†
        compliance_score = (compliant_count / total_controls) * 100

        # ç¡®å®šæ•´ä½“çŠ¶æ€
        if compliance_score >= 90:
            overall_status = ComplianceStatus.COMPLIANT
        elif compliance_score >= 70:
            overall_status = ComplianceStatus.PARTIALLY_COMPLIANT
        else:
            overall_status = ComplianceStatus.NON_COMPLIANT

        self.compliance_status = ComplianceStatus(
            overall_status=overall_status,
            compliance_score=compliance_score,
            compliant_controls=compliant_count,
            non_compliant_controls=non_compliant_count,
            partially_compliant_controls=partially_compliant_count,
            total_controls=total_controls
        )

        return self.compliance_status

    def get_critical_findings(self) -> List[AuditFinding]:
        """è·å–å…³é”®å®¡è®¡å‘ç°"""
        return [f for f in self.audit_findings
                if f.finding_severity == FindingSeverity.CRITICAL]

    def generate_report(self) -> Dict:
        """ç”Ÿæˆå®¡è®¡æŠ¥å‘Š"""
        return {
            'audit_id': self.audit_id,
            'audit_date': self.audit_date.isoformat(),
            'auditor': self.auditor,
            'audit_scope': {
                'start_date': self.audit_scope.scope_start_date.isoformat(),
                'end_date': self.audit_scope.scope_end_date.isoformat(),
                'systems': self.audit_scope.scope_systems
            },
            'audit_findings': [{
                'finding_id': f.finding_id,
                'type': f.finding_type.value,
                'severity': f.finding_severity.value,
                'description': f.finding_description,
                'recommendation': f.finding_recommendation,
                'status': f.status
            } for f in self.audit_findings],
            'compliance_status': {
                'overall_status': self.compliance_status.overall_status.value if self.compliance_status else None,
                'compliance_score': self.compliance_status.compliance_score if self.compliance_status else 0,
                'compliant_controls': self.compliance_status.compliant_controls if self.compliance_status else 0,
                'non_compliant_controls': self.compliance_status.non_compliant_controls if self.compliance_status else 0
            } if self.compliance_status else None
        }

# ä½¿ç”¨ç¤ºä¾‹
if __name__ == '__main__':
    # åˆ›å»ºISO 27001å®¡è®¡
    audit = ISO27001Audit(
        audit_id="AUDIT-2024-001",
        audit_scope=AuditScope(
            scope_start_date=datetime(2024, 1, 1),
            scope_end_date=datetime(2024, 12, 31),
            scope_systems=["ç”Ÿäº§ç³»ç»Ÿ", "æµ‹è¯•ç³»ç»Ÿ"],
            scope_departments=["ITéƒ¨é—¨", "å®‰å…¨éƒ¨é—¨"],
            scope_locations=["æ€»éƒ¨", "æ•°æ®ä¸­å¿ƒ"]
        ),
        auditor="å®¡è®¡å›¢é˜Ÿ"
    )

    # æ·»åŠ å®¡è®¡å‘ç°
    audit.add_finding(AuditFinding(
        finding_id="FIND-001",
        finding_type=FindingType.COMPLIANCE,
        finding_severity=FindingSeverity.HIGH,
        finding_description="è®¿é—®æ§åˆ¶æªæ–½ä¸å®Œæ•´",
        finding_recommendation="å®æ–½å¤šå› ç´ è®¤è¯",
        affected_controls=["A.9.4.2"],
        status="Open",
        assigned_to="ITéƒ¨é—¨"
    ))

    # è®¡ç®—åˆè§„çŠ¶æ€
    compliance_status = audit.calculate_compliance_status(total_controls=100)
    print(f"åˆè§„å¾—åˆ†: {compliance_status.compliance_score}%")
    print(f"åˆè§„çŠ¶æ€: {compliance_status.overall_status.value}")

    # ç”Ÿæˆå®¡è®¡æŠ¥å‘Š
    report = audit.generate_report()
    print(json.dumps(report, indent=2, ensure_ascii=False))
```

### 2.5 æ•ˆæœè¯„ä¼°

**æ€§èƒ½æŒ‡æ ‡**ï¼š

| æŒ‡æ ‡ | æ”¹è¿›å‰ | æ”¹è¿›å | æå‡ |
|------|--------|--------|------|
| å®¡è®¡æµç¨‹æ•ˆç‡ | ä½ | é«˜ | æ˜¾è‘—æå‡ |
| å®¡è®¡å‘ç°ç®¡ç†æ•ˆç‡ | 60% | 95% | 35%æå‡ |
| åˆè§„çŠ¶æ€è¯„ä¼°å‡†ç¡®æ€§ | 70% | 95% | 25%æå‡ |
| æŠ¥å‘Šç”Ÿæˆæ—¶é—´ | 2å¤© | 2å°æ—¶ | 24xæå‡ |

**ä¸šåŠ¡ä»·å€¼**ï¼š

1. **å®¡è®¡æµç¨‹ç³»ç»ŸåŒ–**ï¼šå»ºç«‹ç³»ç»ŸåŒ–å®¡è®¡æµç¨‹
2. **å®¡è®¡å‘ç°æœ‰æ•ˆç®¡ç†**ï¼šæœ‰æ•ˆç®¡ç†å®¡è®¡å‘ç°
3. **åˆè§„çŠ¶æ€æ¸…æ™°**ï¼šæ¸…æ™°è¯„ä¼°åˆè§„çŠ¶æ€
4. **æŠ¥å‘Šç”Ÿæˆé«˜æ•ˆ**ï¼šæé«˜æŠ¥å‘Šç”Ÿæˆæ•ˆç‡

**ç»éªŒæ•™è®­**ï¼š

1. Schemaå®šä¹‰å¾ˆé‡è¦
2. å®¡è®¡å‘ç°éœ€è¦ç³»ç»ŸåŒ–ç®¡ç†
3. åˆè§„çŠ¶æ€éœ€è¦è‡ªåŠ¨åŒ–è¯„ä¼°
4. æŠ¥å‘Šç”Ÿæˆéœ€è¦è‡ªåŠ¨åŒ–

**å‚è€ƒæ¡ˆä¾‹**ï¼š

- [ISO 27001å®¡è®¡æŒ‡å—](https://www.iso.org/isoiec-27001-information-security.html)
- [ISO 27001å®¡è®¡æœ€ä½³å®è·µ](https://www.iso.org/iso-27001-information-security.html)

---

## 3. æ¡ˆä¾‹2ï¼šå®‰å…¨äº‹ä»¶å®¡è®¡ç³»ç»Ÿ

### 3.1 ä¸šåŠ¡èƒŒæ™¯

**ä¼ä¸šèƒŒæ™¯**ï¼š
æŸä¼ä¸šéœ€è¦å®¡è®¡å®‰å…¨äº‹ä»¶ï¼Œç¡®ä¿å®‰å…¨äº‹ä»¶å¾—åˆ°åŠæ—¶å¤„ç†å’Œè·Ÿè¸ªã€‚

### 3.2 æŠ€æœ¯æŒ‘æˆ˜

1. **äº‹ä»¶æ”¶é›†**ï¼šæ”¶é›†å®‰å…¨äº‹ä»¶
2. **äº‹ä»¶åˆ†æ**ï¼šåˆ†æå®‰å…¨äº‹ä»¶
3. **äº‹ä»¶è·Ÿè¸ª**ï¼šè·Ÿè¸ªäº‹ä»¶å¤„ç†çŠ¶æ€

### 3.3 è§£å†³æ–¹æ¡ˆ

**ä½¿ç”¨Schemaå®šä¹‰å®‰å…¨äº‹ä»¶å®¡è®¡ç³»ç»Ÿ**ï¼š

### 3.4 å®Œæ•´ä»£ç å®ç°

**å®‰å…¨äº‹ä»¶å®¡è®¡Schemaï¼ˆå®Œæ•´ç¤ºä¾‹ï¼‰**ï¼š

```python
@dataclass
class SecurityIncidentEvent:
    """å®‰å…¨äº‹ä»¶"""
    event_id: str
    event_type: str
    event_severity: FindingSeverity
    incident_type: str
    affected_systems: List[str]
    event_details: Dict
    detected_at: datetime
    resolved_at: Optional[datetime] = None
    status: str = "Open"

@dataclass
class SecurityIncidentAudit:
    """å®‰å…¨äº‹ä»¶å®¡è®¡"""
    audit_events: List[SecurityIncidentEvent] = field(default_factory=list)

    def add_event(self, event: SecurityIncidentEvent):
        """æ·»åŠ å®‰å…¨äº‹ä»¶"""
        self.audit_events.append(event)

    def get_critical_events(self) -> List[SecurityIncidentEvent]:
        """è·å–å…³é”®å®‰å…¨äº‹ä»¶"""
        return [e for e in self.audit_events
                if e.event_severity == FindingSeverity.CRITICAL]
```

### 3.5 æ•ˆæœè¯„ä¼°

- äº‹ä»¶æ”¶é›†å®Œæ•´æ€§100%
- äº‹ä»¶åˆ†æå‡†ç¡®æ€§95%
- äº‹ä»¶è·Ÿè¸ªæ•ˆç‡æå‡

---

## 4. æ¡ˆä¾‹3ï¼šåˆè§„çŠ¶æ€è¯„ä¼°ç³»ç»Ÿ

### 4.1 ä¸šåŠ¡èƒŒæ™¯

**ä¼ä¸šèƒŒæ™¯**ï¼š
éœ€è¦æŒç»­è¯„ä¼°åˆè§„çŠ¶æ€ï¼Œç¡®ä¿åˆè§„æ€§ã€‚

### 4.2 æŠ€æœ¯æŒ‘æˆ˜

1. **åˆè§„è¦æ±‚è¯„ä¼°**ï¼šè¯„ä¼°åˆè§„è¦æ±‚
2. **åˆè§„çŠ¶æ€ç»Ÿè®¡**ï¼šç»Ÿè®¡åˆè§„çŠ¶æ€
3. **åˆè§„æŠ¥å‘Šç”Ÿæˆ**ï¼šç”Ÿæˆåˆè§„æŠ¥å‘Š

### 4.3 è§£å†³æ–¹æ¡ˆ

**ä½¿ç”¨Schemaå®šä¹‰åˆè§„çŠ¶æ€è¯„ä¼°ç³»ç»Ÿ**ï¼š

### 4.4 å®Œæ•´ä»£ç å®ç°

**åˆè§„çŠ¶æ€è¯„ä¼°Schemaï¼ˆå®Œæ•´ç¤ºä¾‹ï¼‰**ï¼š

```python
@dataclass
class ComplianceRequirement:
    """åˆè§„è¦æ±‚"""
    requirement_id: str
    requirement_name: str
    requirement_description: str
    standard: str
    control_id: Optional[str] = None

@dataclass
class ComplianceAssessment:
    """åˆè§„è¯„ä¼°"""
    assessment_id: str
    requirements: List[ComplianceRequirement]
    compliance_status: ComplianceStatus
    assessment_date: datetime = field(default_factory=datetime.now)
```

### 4.5 æ•ˆæœè¯„ä¼°

- åˆè§„è¦æ±‚è¯„ä¼°å®Œæ•´æ€§100%
- åˆè§„çŠ¶æ€ç»Ÿè®¡å‡†ç¡®æ€§95%
- åˆè§„æŠ¥å‘Šç”Ÿæˆæ•ˆç‡æå‡

---

## 5. æ¡ˆä¾‹4ï¼šå®¡è®¡æ—¥å¿—åˆ°åˆè§„æŠ¥å‘Šè½¬æ¢å·¥å…·

### 5.1 ä¸šåŠ¡èƒŒæ™¯

**ä¼ä¸šèƒŒæ™¯**ï¼š
éœ€è¦å°†å®¡è®¡æ—¥å¿—è½¬æ¢ä¸ºåˆè§„æŠ¥å‘Šã€‚

### 5.2 æŠ€æœ¯æŒ‘æˆ˜

1. **æ—¥å¿—è§£æ**ï¼šè§£æå®¡è®¡æ—¥å¿—
2. **åˆè§„æ˜ å°„**ï¼šæ˜ å°„åˆ°åˆè§„è¦æ±‚
3. **æŠ¥å‘Šç”Ÿæˆ**ï¼šç”Ÿæˆåˆè§„æŠ¥å‘Š

### 5.3 è§£å†³æ–¹æ¡ˆ

**å®¡è®¡æ—¥å¿—åˆ°åˆè§„æŠ¥å‘Šè½¬æ¢å™¨**ï¼š

### 5.4 å®Œæ•´ä»£ç å®ç°

**è½¬æ¢å™¨å®ç°**ï¼š

```python
def audit_logs_to_compliance_report(audit_logs: list, requirements: dict) -> dict:
    """å°†å®¡è®¡æ—¥å¿—è½¬æ¢ä¸ºåˆè§„æŠ¥å‘Š"""
    report = {
        'requirements': [],
        'compliance_status': {},
        'findings': []
    }

    for requirement_id, requirement in requirements.items():
        # æŸ¥æ‰¾ç›¸å…³å®¡è®¡æ—¥å¿—
        related_logs = [log for log in audit_logs
                       if requirement_id in log.get('related_requirements', [])]

        # è¯„ä¼°åˆè§„çŠ¶æ€
        compliance_status = assess_compliance(related_logs, requirement)

        report['requirements'].append({
            'requirement_id': requirement_id,
            'requirement_name': requirement['name'],
            'compliance_status': compliance_status
        })

    return report
```

### 5.5 æ•ˆæœè¯„ä¼°

- è½¬æ¢æˆåŠŸç‡95%
- æŠ¥å‘Šå‡†ç¡®æ€§95%
- ç”Ÿæˆæ•ˆç‡æå‡80%

---

## 6. æ¡ˆä¾‹5ï¼šå®‰å…¨å®¡è®¡æ•°æ®å­˜å‚¨ä¸åˆ†æç³»ç»Ÿ

### 6.1 ä¸šåŠ¡èƒŒæ™¯

**ä¼ä¸šèƒŒæ™¯**ï¼š
éœ€è¦å­˜å‚¨å®¡è®¡æ—¥å¿—å’Œç”Ÿæˆå®¡è®¡æŠ¥å‘Šã€‚

### 6.2 æŠ€æœ¯æŒ‘æˆ˜

1. **æ—¥å¿—å­˜å‚¨**ï¼šå­˜å‚¨å®¡è®¡æ—¥å¿—
2. **äº‹ä»¶å­˜å‚¨**ï¼šå­˜å‚¨å®¡è®¡äº‹ä»¶
3. **æŠ¥å‘Šç”Ÿæˆ**ï¼šç”Ÿæˆå®¡è®¡æŠ¥å‘Š

### 6.3 è§£å†³æ–¹æ¡ˆ

**å®‰å…¨å®¡è®¡æ•°æ®å­˜å‚¨ä¸åˆ†æç³»ç»Ÿ**ï¼š

### 6.4 å®Œæ•´ä»£ç å®ç°

**æ•°æ®å­˜å‚¨å®ç°**ï¼š

```python
from security_audit_data_store import SecurityAuditDataStore

store = SecurityAuditDataStore(db_config)
store.store_audit_log(log_entry)
store.store_audit_event(event)
store.generate_audit_report(report_scope)
```

### 6.5 æ•ˆæœè¯„ä¼°

- æ•°æ®å­˜å‚¨å®Œæ•´æ€§100%
- æŠ¥å‘Šç”Ÿæˆå‡†ç¡®æ€§95%
- åˆ†ææ•ˆç‡æå‡

---

## 7. æ¡ˆä¾‹æ€»ç»“

### 7.1 æˆåŠŸå› ç´ 

1. **Schemaå®šä¹‰**ï¼šä½¿ç”¨æ ‡å‡†Schemaå®šä¹‰
2. **è‡ªåŠ¨åŒ–**ï¼šè‡ªåŠ¨åŒ–å®¡è®¡æµç¨‹
3. **ç³»ç»ŸåŒ–ç®¡ç†**ï¼šç³»ç»ŸåŒ–ç®¡ç†å®¡è®¡å‘ç°
4. **æŒç»­ç›‘æ§**ï¼šæŒç»­ç›‘æ§åˆè§„çŠ¶æ€

### 7.2 æœ€ä½³å®è·µ

1. å®šä¹‰å®Œæ•´çš„å®¡è®¡Schema
2. ç³»ç»ŸåŒ–ç®¡ç†å®¡è®¡å‘ç°
3. è‡ªåŠ¨åŒ–åˆè§„çŠ¶æ€è¯„ä¼°
4. è‡ªåŠ¨ç”Ÿæˆå®¡è®¡æŠ¥å‘Š
5. æŒç»­ç›‘æ§åˆè§„çŠ¶æ€

---

## 8. å‚è€ƒæ–‡çŒ®

### 8.1 å®˜æ–¹æ–‡æ¡£

- [ISO 27001å®¡è®¡æŒ‡å—](https://www.iso.org/isoiec-27001-information-security.html)
- [NISTå®¡è®¡æ¡†æ¶](https://www.nist.gov/cyberframework)

### 8.2 æœ€ä½³å®è·µ

- [ISO 27001å®¡è®¡æœ€ä½³å®è·µ](https://www.iso.org/iso-27001-information-security.html)
- [å®‰å…¨å®¡è®¡æœ€ä½³å®è·µ](https://www.nist.gov/cyberframework)

---

**æ–‡æ¡£åˆ›å»ºæ—¶é—´**ï¼š2025-01-21
**æ–‡æ¡£ç‰ˆæœ¬**ï¼šv2.0
**ç»´æŠ¤è€…**ï¼šDSL Schemaç ”ç©¶å›¢é˜Ÿ
**æœ€åæ›´æ–°**ï¼š2025-01-21
**ä¸‹æ¬¡å®¡æŸ¥æ—¶é—´**ï¼š2025-02-21
