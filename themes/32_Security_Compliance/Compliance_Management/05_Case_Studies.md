# åˆè§„ç®¡ç†å®è·µæ¡ˆä¾‹

## ğŸ“‘ ç›®å½•

- [åˆè§„ç®¡ç†å®è·µæ¡ˆä¾‹](#åˆè§„ç®¡ç†å®è·µæ¡ˆä¾‹)
  - [ğŸ“‘ ç›®å½•](#-ç›®å½•)
  - [1. æ¡ˆä¾‹æ¦‚è¿°](#1-æ¡ˆä¾‹æ¦‚è¿°)
  - [2. æ¡ˆä¾‹1ï¼šå¤šæ³•è§„åˆè§„ç®¡ç†å¹³å°](#2-æ¡ˆä¾‹1å¤šæ³•è§„åˆè§„ç®¡ç†å¹³å°)
    - [2.1 ä¼ä¸šèƒŒæ™¯](#21-ä¼ä¸šèƒŒæ™¯)
    - [2.2 ä¸šåŠ¡ç—›ç‚¹](#22-ä¸šåŠ¡ç—›ç‚¹)
    - [2.3 ä¸šåŠ¡ç›®æ ‡](#23-ä¸šåŠ¡ç›®æ ‡)
    - [2.4 æŠ€æœ¯æŒ‘æˆ˜](#24-æŠ€æœ¯æŒ‘æˆ˜)
    - [2.5 è§£å†³æ–¹æ¡ˆ](#25-è§£å†³æ–¹æ¡ˆ)
    - [2.6 å®Œæ•´ä»£ç å®ç°](#26-å®Œæ•´ä»£ç å®ç°)
    - [2.7 æ•ˆæœè¯„ä¼°](#27-æ•ˆæœè¯„ä¼°)
  - [3. æ¡ˆä¾‹æ€»ç»“](#3-æ¡ˆä¾‹æ€»ç»“)
  - [4. å‚è€ƒæ–‡çŒ®](#4-å‚è€ƒæ–‡çŒ®)

---

## 1. æ¡ˆä¾‹æ¦‚è¿°

æœ¬æ–‡æ¡£æä¾›åˆè§„ç®¡ç†åœ¨å®é™…ä¼ä¸šåº”ç”¨ä¸­çš„å®è·µæ¡ˆä¾‹ï¼Œæ¶µç›–å¤šæ³•è§„éµä»ã€è‡ªåŠ¨åŒ–åˆè§„æ£€æŸ¥ã€å®¡è®¡æŠ¥å‘Šã€é£é™©ç®¡ç†ç­‰åœºæ™¯ã€‚

**å‚è€ƒä¼ä¸šæ¡ˆä¾‹**ï¼š

- **é‡‘èæœºæ„**ï¼šSOXåˆè§„å®è·µ
- **åŒ»ç–—æœºæ„**ï¼šHIPAAåˆè§„ç®¡ç†
- **è·¨å›½ä¼ä¸š**ï¼šGDPRåˆè§„å®è·µ

---

## 2. æ¡ˆä¾‹1ï¼šå¤šæ³•è§„åˆè§„ç®¡ç†å¹³å°

### 2.1 ä¼ä¸šèƒŒæ™¯

**ä¼ä¸šåç§°**ï¼šæŸè·¨å›½é‡‘èæœåŠ¡å…¬å¸ï¼ˆFinanceGlobalï¼‰

**ä¼ä¸šè§„æ¨¡**ï¼š
- å‘˜å·¥äººæ•°ï¼š50000+
- å…¨çƒåˆ†æ”¯æœºæ„ï¼š40+å›½å®¶
- ç›‘ç®¡åŒºåŸŸï¼šç¾å›½ã€æ¬§ç›Ÿã€äºšå¤ª
- é€‚ç”¨æ³•è§„ï¼šSOX, GDPR, PCI DSS, ISO 27001
- å®¡è®¡é¢‘ç‡ï¼šå­£åº¦å†…éƒ¨å®¡è®¡ï¼Œå¹´åº¦å¤–éƒ¨å®¡è®¡

**æŠ€æœ¯æ ˆ**ï¼š
- äº‘æœåŠ¡ï¼šAWS, Azure
- æ•°æ®åº“ï¼šOracle, PostgreSQL
- SIEMï¼šSplunk
- GRCå·¥å…·ï¼šServiceNow GRC
- è‡ªåŠ¨åŒ–ï¼šPython, Terraform

### 2.2 ä¸šåŠ¡ç—›ç‚¹

1. **æ³•è§„å¤æ‚**ï¼šéœ€è¦åŒæ—¶æ»¡è¶³SOXã€GDPRã€PCI DSSç­‰å¤šä¸ªæ³•è§„
2. **æ‰‹å·¥å®¡è®¡**ï¼šå¤§é‡æ‰‹å·¥æ£€æŸ¥ï¼Œæ•ˆç‡ä½ä¸”å®¹æ˜“å‡ºé”™
3. **è¯æ®æ”¶é›†éš¾**ï¼šå®¡è®¡è¯æ®åˆ†æ•£åœ¨ä¸åŒç³»ç»Ÿï¼Œæ”¶é›†å›°éš¾
4. **åˆè§„æˆæœ¬é«˜**ï¼šåˆè§„å›¢é˜Ÿ50+äººï¼Œå¹´åº¦æˆæœ¬1000ä¸‡+
5. **å“åº”é€Ÿåº¦æ…¢**ï¼šå‘ç°åˆè§„é—®é¢˜åå“åº”å’Œä¿®å¤æ…¢

### 2.3 ä¸šåŠ¡ç›®æ ‡

1. **è‡ªåŠ¨åŒ–åˆè§„æ£€æŸ¥**ï¼š80%çš„åˆè§„æ£€æŸ¥è‡ªåŠ¨åŒ–
2. **å®æ—¶åˆè§„çŠ¶æ€**ï¼šå®æ—¶äº†è§£åˆè§„çŠ¶æ€å’Œå·®è·
3. **ä¸€é”®å®¡è®¡æŠ¥å‘Š**ï¼šä¸€é”®ç”Ÿæˆåˆè§„å®¡è®¡æŠ¥å‘Š
4. **é™ä½åˆè§„æˆæœ¬**ï¼šåˆè§„æˆæœ¬é™ä½40%
5. **å¿«é€Ÿå“åº”**ï¼šåˆè§„é—®é¢˜å“åº”æ—¶é—´ä»1å‘¨ç¼©çŸ­åˆ°1å¤©

### 2.4 æŠ€æœ¯æŒ‘æˆ˜

1. **æ³•è§„ç†è§£**ï¼šéœ€è¦æ·±å…¥ç†è§£å„ç§æ³•è§„è¦æ±‚
2. **ç³»ç»Ÿæ•´åˆ**ï¼šéœ€è¦æ•´åˆå„ç§å®‰å…¨å·¥å…·å’Œç³»ç»Ÿ
3. **è¯æ®ç®¡ç†**ï¼šå¤§é‡åˆè§„è¯æ®çš„å­˜å‚¨å’Œç®¡ç†
4. **å¤šåŒºåŸŸåˆè§„**ï¼šä¸åŒåœ°åŒºæœ‰ä¸åŒçš„åˆè§„è¦æ±‚
5. **æŒç»­åˆè§„**ï¼šä»æ—¶ç‚¹åˆè§„å‘æŒç»­åˆè§„è½¬å˜

### 2.5 è§£å†³æ–¹æ¡ˆ

**æ¶æ„è®¾è®¡**ï¼š

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Compliance Management Platform                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    Regulation Library                         â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚   SOX    â”‚ â”‚  GDPR    â”‚ â”‚ PCI DSS  â”‚ â”‚  ISO 27001       â”‚  â”‚  â”‚
â”‚  â”‚  â”‚ Controls â”‚ â”‚ Controls â”‚ â”‚ Controls â”‚ â”‚  Controls        â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â”‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    Policy Engine                              â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚  â”‚   Control   â”‚  â”‚   Policy    â”‚  â”‚    Compliance       â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  Mapping    â”‚  â”‚  Definitionsâ”‚  â”‚    Rules Engine     â”‚   â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â”‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    Automated Assessment                       â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚  â”‚  Continuous â”‚  â”‚   Evidence  â”‚  â”‚    Gap Analysis     â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  Monitoring â”‚  â”‚  Collection â”‚  â”‚    Engine           â”‚   â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â”‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    Reporting & Analytics                      â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚  â”‚  Dashboard  â”‚  â”‚   Audit     â”‚  â”‚    Risk Heatmap     â”‚   â”‚  â”‚
â”‚  â”‚  â”‚             â”‚  â”‚  Reports    â”‚  â”‚                     â”‚   â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    Integration Layer                          â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚   SIEM   â”‚ â”‚   IAM    â”‚ â”‚   DLP    â”‚ â”‚   Vulnerability  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚ (Splunk) â”‚ â”‚ (Okta)   â”‚ â”‚ (Symantec)â”‚  â”‚   Scanner        â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ ¸å¿ƒç»„ä»¶**ï¼š

1. **æ³•è§„åº“**ï¼šSOX, GDPR, PCI DSSç­‰æ³•è§„æ§åˆ¶é¡¹
2. **ç­–ç•¥å¼•æ“**ï¼šæ§åˆ¶é¡¹æ˜ å°„å’Œç­–ç•¥å®šä¹‰
3. **è‡ªåŠ¨è¯„ä¼°**ï¼šæŒç»­ç›‘æ§å’Œè¯æ®æ”¶é›†
4. **æŠ¥å‘Šåˆ†æ**ï¼šåˆè§„ä»ªè¡¨æ¿å’Œå®¡è®¡æŠ¥å‘Š

### 2.6 å®Œæ•´ä»£ç å®ç°

**åˆè§„ç®¡ç†å¹³å°Pythonå®ç°**ï¼š

```python
#!/usr/bin/env python3
"""
å¤šæ³•è§„åˆè§„ç®¡ç†å¹³å°
æ”¯æŒæ³•è§„ç®¡ç†ã€æ§åˆ¶è¯„ä¼°ã€è¯æ®æ”¶é›†ã€å®¡è®¡æŠ¥å‘Šç­‰åŠŸèƒ½
"""

import json
import hashlib
import logging
from datetime import datetime, timedelta
from typing import Dict, List, Optional, Set, Tuple, Any
from dataclasses import dataclass, field
from enum import Enum, auto
import schedule
import time
import threading


class ComplianceStatus(Enum):
    """åˆè§„çŠ¶æ€"""
    COMPLIANT = "compliant"
    NON_COMPLIANT = "non_compliant"
    PARTIAL = "partial"
    NOT_ASSESSED = "not_assessed"
    EXEMPT = "exempt"


class ControlType(Enum):
    """æ§åˆ¶ç±»å‹"""
    PREVENTIVE = "preventive"
    DETECTIVE = "detective"
    CORRECTIVE = "corrective"


class RiskLevel(Enum):
    """é£é™©çº§åˆ«"""
    LOW = 1
    MEDIUM = 2
    HIGH = 3
    CRITICAL = 4


@dataclass
class Regulation:
    """æ³•è§„"""
    id: str
    name: str
    description: str
    version: str
    effective_date: datetime
    jurisdiction: str
    controls: List[str] = field(default_factory=list)


@dataclass
class Control:
    """æ§åˆ¶é¡¹"""
    id: str
    regulation_id: str
    control_id: str
    title: str
    description: str
    control_type: ControlType
    risk_level: RiskLevel
    test_procedure: str
    evidence_required: List[str]
    frequency: str  # daily, weekly, monthly, quarterly, annually


@dataclass
class Assessment:
    """è¯„ä¼°ç»“æœ"""
    id: str
    control_id: str
    status: ComplianceStatus
    assessed_at: datetime
    assessed_by: str
    evidence_ids: List[str]
    findings: List[str]
    remediation_plan: Optional[str]
    due_date: Optional[datetime]
    risk_score: float


@dataclass
class Evidence:
    """å®¡è®¡è¯æ®"""
    id: str
    control_id: str
    evidence_type: str
    description: str
    source: str
    collected_at: datetime
    collected_by: str
    data: Dict[str, Any]
    hash: str
    retention_until: datetime


@dataclass
class ComplianceGap:
    """åˆè§„å·®è·"""
    id: str
    control_id: str
    description: str
    severity: RiskLevel
    identified_at: datetime
    remediation_status: str
    assigned_to: Optional[str]
    target_date: Optional[datetime]


class RegulationManager:
    """æ³•è§„ç®¡ç†å™¨"""

    def __init__(self):
        self.regulations: Dict[str, Regulation] = {}
        self.controls: Dict[str, Control] = {}
        self.logger = logging.getLogger('RegulationManager')

    def add_regulation(self, regulation: Regulation):
        """æ·»åŠ æ³•è§„"""
        self.regulations[regulation.id] = regulation
        self.logger.info(f"æ·»åŠ æ³•è§„: {regulation.name}")

    def add_control(self, control: Control):
        """æ·»åŠ æ§åˆ¶é¡¹"""
        self.controls[control.id] = control
        
        # å…³è”åˆ°æ³•è§„
        if control.regulation_id in self.regulations:
            self.regulations[control.regulation_id].controls.append(control.id)
        
        self.logger.info(f"æ·»åŠ æ§åˆ¶é¡¹: {control.control_id}")

    def get_controls_by_regulation(self, regulation_id: str) -> List[Control]:
        """è·å–æ³•è§„çš„æ§åˆ¶é¡¹"""
        regulation = self.regulations.get(regulation_id)
        if not regulation:
            return []
        
        return [
            self.controls[cid] 
            for cid in regulation.controls 
            if cid in self.controls
        ]

    def map_controls(
        self,
        source_regulation: str,
        target_regulation: str
    ) -> Dict[str, List[str]]:
        """
        æ˜ å°„æ§åˆ¶é¡¹
        
        Args:
            source_regulation: æºæ³•è§„ID
            target_regulation: ç›®æ ‡æ³•è§„ID
            
        Returns:
            æ§åˆ¶é¡¹æ˜ å°„å…³ç³»
        """
        source_controls = self.get_controls_by_regulation(source_regulation)
        target_controls = self.get_controls_by_regulation(target_regulation)
        
        mapping = {}
        
        for source_control in source_controls:
            mapped = []
            for target_control in target_controls:
                # åŸºäºæ§åˆ¶ç±»å‹å’Œé£é™©çº§åˆ«è¿›è¡Œæ˜ å°„
                if (source_control.control_type == target_control.control_type and
                    source_control.risk_level == target_control.risk_level):
                    mapped.append(target_control.id)
            
            mapping[source_control.id] = mapped
        
        return mapping


class AssessmentEngine:
    """è¯„ä¼°å¼•æ“"""

    def __init__(self, regulation_manager: RegulationManager):
        self.regulation_manager = regulation_manager
        self.assessments: Dict[str, Assessment] = {}
        self.evidence_store: Dict[str, Evidence] = {}
        self.logger = logging.getLogger('AssessmentEngine')

    def run_assessment(self, control_id: str, automated: bool = True) -> Assessment:
        """
        æ‰§è¡Œè¯„ä¼°
        
        Args:
            control_id: æ§åˆ¶é¡¹ID
            automated: æ˜¯å¦è‡ªåŠ¨è¯„ä¼°
            
        Returns:
            è¯„ä¼°ç»“æœ
        """
        control = self.regulation_manager.controls.get(control_id)
        if not control:
            raise ValueError(f"æ§åˆ¶é¡¹ä¸å­˜åœ¨: {control_id}")
        
        self.logger.info(f"è¯„ä¼°æ§åˆ¶é¡¹: {control.control_id}")
        
        # æ‰§è¡Œæµ‹è¯•ç¨‹åº
        if automated and control.test_procedure.startswith('auto:'):
            status, findings, evidence_data = self._run_automated_test(control)
        else:
            status, findings, evidence_data = self._run_manual_test(control)
        
        # æ”¶é›†è¯æ®
        evidence_ids = []
        for evidence_type, data in evidence_data.items():
            evidence = self._create_evidence(control_id, evidence_type, data)
            evidence_ids.append(evidence.id)
        
        # åˆ›å»ºè¯„ä¼°ç»“æœ
        assessment_id = hashlib.sha256(
            f"{control_id}-{datetime.now()}".encode()
        ).hexdigest()[:16]
        
        assessment = Assessment(
            id=assessment_id,
            control_id=control_id,
            status=status,
            assessed_at=datetime.now(),
            assessed_by='automated' if automated else 'manual',
            evidence_ids=evidence_ids,
            findings=findings,
            remediation_plan=None,
            due_date=None,
            risk_score=self._calculate_risk_score(control, status, findings)
        )
        
        self.assessments[assessment_id] = assessment
        
        return assessment

    def _run_automated_test(
        self,
        control: Control
    ) -> Tuple[ComplianceStatus, List[str], Dict]:
        """æ‰§è¡Œè‡ªåŠ¨æµ‹è¯•"""
        test_type = control.test_procedure.replace('auto:', '')
        
        findings = []
        evidence_data = {}
        
        if test_type == 'encryption_check':
            # æ£€æŸ¥åŠ å¯†é…ç½®
            encrypted = self._check_encryption()
            if not encrypted:
                findings.append("æ•æ„Ÿæ•°æ®æœªåŠ å¯†")
            evidence_data['encryption_status'] = {'encrypted': encrypted}
            
        elif test_type == 'access_log_check':
            # æ£€æŸ¥è®¿é—®æ—¥å¿—
            logs = self._collect_access_logs()
            evidence_data['access_logs'] = logs
            
        elif test_type == 'password_policy':
            # æ£€æŸ¥å¯†ç ç­–ç•¥
            policy = self._check_password_policy()
            if not policy.get('complexity'):
                findings.append("å¯†ç å¤æ‚åº¦è¦æ±‚ä¸è¶³")
            evidence_data['password_policy'] = policy
        
        status = ComplianceStatus.COMPLIANT if not findings else ComplianceStatus.NON_COMPLIANT
        
        return status, findings, evidence_data

    def _run_manual_test(
        self,
        control: Control
    ) -> Tuple[ComplianceStatus, List[str], Dict]:
        """æ‰§è¡Œæ‰‹åŠ¨æµ‹è¯•ï¼ˆå ä½ï¼‰"""
        return ComplianceStatus.NOT_ASSESSED, [], {}

    def _create_evidence(
        self,
        control_id: str,
        evidence_type: str,
        data: Dict
    ) -> Evidence:
        """åˆ›å»ºè¯æ®"""
        evidence_id = hashlib.sha256(
            f"{control_id}-{evidence_type}-{datetime.now()}".encode()
        ).hexdigest()[:16]
        
        data_hash = hashlib.sha256(json.dumps(data).encode()).hexdigest()
        
        evidence = Evidence(
            id=evidence_id,
            control_id=control_id,
            evidence_type=evidence_type,
            description=f"Automated evidence for {evidence_type}",
            source='assessment_engine',
            collected_at=datetime.now(),
            collected_by='system',
            data=data,
            hash=data_hash,
            retention_until=datetime.now() + timedelta(days=2555)  # 7 years
        )
        
        self.evidence_store[evidence_id] = evidence
        return evidence

    def _calculate_risk_score(
        self,
        control: Control,
        status: ComplianceStatus,
        findings: List[str]
    ) -> float:
        """è®¡ç®—é£é™©åˆ†æ•°"""
        base_score = control.risk_level.value * 25  # 25, 50, 75, 100
        
        if status == ComplianceStatus.COMPLIANT:
            return 0.0
        elif status == ComplianceStatus.PARTIAL:
            return base_score * 0.5
        else:
            return base_score

    def _check_encryption(self) -> bool:
        """æ£€æŸ¥åŠ å¯†çŠ¶æ€ï¼ˆç¤ºä¾‹ï¼‰"""
        return True

    def _collect_access_logs(self) -> List[Dict]:
        """æ”¶é›†è®¿é—®æ—¥å¿—ï¼ˆç¤ºä¾‹ï¼‰"""
        return []

    def _check_password_policy(self) -> Dict:
        """æ£€æŸ¥å¯†ç ç­–ç•¥ï¼ˆç¤ºä¾‹ï¼‰"""
        return {'complexity': True, 'min_length': 12}

    def get_compliance_score(self, regulation_id: str) -> float:
        """
        è·å–æ³•è§„åˆè§„åˆ†æ•°
        
        Args:
            regulation_id: æ³•è§„ID
            
        Returns:
            åˆè§„åˆ†æ•°ï¼ˆ0-100ï¼‰
        """
        controls = self.regulation_manager.get_controls_by_regulation(regulation_id)
        
        if not controls:
            return 0.0
        
        compliant_count = 0
        
        for control in controls:
            # è·å–æœ€æ–°è¯„ä¼°
            latest = self._get_latest_assessment(control.id)
            if latest and latest.status == ComplianceStatus.COMPLIANT:
                compliant_count += 1
        
        return (compliant_count / len(controls)) * 100

    def _get_latest_assessment(self, control_id: str) -> Optional[Assessment]:
        """è·å–æ§åˆ¶é¡¹çš„æœ€æ–°è¯„ä¼°"""
        assessments = [
            a for a in self.assessments.values() 
            if a.control_id == control_id
        ]
        
        if not assessments:
            return None
        
        return max(assessments, key=lambda a: a.assessed_at)

    def identify_gaps(self, regulation_id: str) -> List[ComplianceGap]:
        """
        è¯†åˆ«åˆè§„å·®è·
        
        Args:
            regulation_id: æ³•è§„ID
            
        Returns:
            å·®è·åˆ—è¡¨
        """
        gaps = []
        controls = self.regulation_manager.get_controls_by_regulation(regulation_id)
        
        for control in controls:
            latest = self._get_latest_assessment(control.id)
            
            if not latest or latest.status != ComplianceStatus.COMPLIANT:
                gap_id = hashlib.sha256(
                    f"gap-{control.id}".encode()
                ).hexdigest()[:16]
                
                gap = ComplianceGap(
                    id=gap_id,
                    control_id=control.id,
                    description=f"æ§åˆ¶é¡¹ {control.control_id} ä¸åˆè§„",
                    severity=control.risk_level,
                    identified_at=datetime.now(),
                    remediation_status='open',
                    assigned_to=None,
                    target_date=datetime.now() + timedelta(days=30)
                )
                
                gaps.append(gap)
        
        return gaps


class AuditReporter:
    """å®¡è®¡æŠ¥å‘Šç”Ÿæˆå™¨"""

    def __init__(self, assessment_engine: AssessmentEngine):
        self.assessment_engine = assessment_engine
        self.logger = logging.getLogger('AuditReporter')

    def generate_compliance_report(
        self,
        regulation_id: str,
        start_date: datetime,
        end_date: datetime
    ) -> Dict:
        """
        ç”Ÿæˆåˆè§„æŠ¥å‘Š
        
        Args:
            regulation_id: æ³•è§„ID
            start_date: å¼€å§‹æ—¥æœŸ
            end_date: ç»“æŸæ—¥æœŸ
            
        Returns:
            åˆè§„æŠ¥å‘Š
        """
        regulation = self.assessment_engine.regulation_manager.regulations.get(
            regulation_id
        )
        
        if not regulation:
            raise ValueError(f"æ³•è§„ä¸å­˜åœ¨: {regulation_id}")
        
        # è·å–åˆè§„åˆ†æ•°
        compliance_score = self.assessment_engine.get_compliance_score(regulation_id)
        
        # è·å–å·®è·
        gaps = self.assessment_engine.identify_gaps(regulation_id)
        
        # è·å–è¯„ä¼°å†å²
        controls = self.assessment_engine.regulation_manager.get_controls_by_regulation(
            regulation_id
        )
        
        control_results = []
        for control in controls:
            latest = self.assessment_engine._get_latest_assessment(control.id)
            control_results.append({
                'control_id': control.control_id,
                'title': control.title,
                'status': latest.status.value if latest else 'not_assessed',
                'last_assessed': latest.assessed_at.isoformat() if latest else None,
                'risk_level': control.risk_level.name
            })
        
        report = {
            'report_id': hashlib.sha256(
                f"{regulation_id}-{datetime.now()}".encode()
            ).hexdigest()[:16],
            'regulation': {
                'id': regulation.id,
                'name': regulation.name,
                'version': regulation.version
            },
            'report_period': {
                'start': start_date.isoformat(),
                'end': end_date.isoformat()
            },
            'generated_at': datetime.now().isoformat(),
            'summary': {
                'compliance_score': round(compliance_score, 2),
                'total_controls': len(controls),
                'compliant': len([c for c in control_results if c['status'] == 'compliant']),
                'non_compliant': len([c for c in control_results if c['status'] == 'non_compliant']),
                'gaps_identified': len(gaps)
            },
            'control_results': control_results,
            'gaps': [
                {
                    'id': gap.id,
                    'control_id': gap.control_id,
                    'description': gap.description,
                    'severity': gap.severity.name,
                    'target_date': gap.target_date.isoformat() if gap.target_date else None
                }
                for gap in gaps
            ]
        }
        
        return report

    def export_to_pdf(self, report: Dict, output_path: str):
        """å¯¼å‡ºæŠ¥å‘Šä¸ºPDFï¼ˆå ä½ï¼‰"""
        # å®é™…åº”è¯¥ä½¿ç”¨ReportLabç­‰åº“
        self.logger.info(f"å¯¼å‡ºæŠ¥å‘Šåˆ°: {output_path}")


class ContinuousComplianceMonitor:
    """æŒç»­åˆè§„ç›‘æ§å™¨"""

    def __init__(self, assessment_engine: AssessmentEngine):
        self.assessment_engine = assessment_engine
        self.monitoring_rules: List[Dict] = []
        self.logger = logging.getLogger('ContinuousComplianceMonitor')
        self._stop_event = threading.Event()

    def add_monitoring_rule(
        self,
        control_id: str,
        frequency: str,
        alert_threshold: int
    ):
        """æ·»åŠ ç›‘æ§è§„åˆ™"""
        rule = {
            'control_id': control_id,
            'frequency': frequency,
            'alert_threshold': alert_threshold,
            'last_run': None,
            'failure_count': 0
        }
        self.monitoring_rules.append(rule)

    def start_monitoring(self):
        """å¯åŠ¨ç›‘æ§"""
        self.logger.info("å¯åŠ¨æŒç»­åˆè§„ç›‘æ§")
        
        # è®¾ç½®å®šæœŸä»»åŠ¡
        for rule in self.monitoring_rules:
            if rule['frequency'] == 'daily':
                schedule.every().day.do(self._run_check, rule)
            elif rule['frequency'] == 'hourly':
                schedule.every().hour.do(self._run_check, rule)
        
        # è¿è¡Œè°ƒåº¦å™¨
        def run_scheduler():
            while not self._stop_event.is_set():
                schedule.run_pending()
                time.sleep(60)
        
        self._thread = threading.Thread(target=run_scheduler)
        self._thread.start()

    def stop_monitoring(self):
        """åœæ­¢ç›‘æ§"""
        self._stop_event.set()
        self._thread.join()
        self.logger.info("åœæ­¢æŒç»­åˆè§„ç›‘æ§")

    def _run_check(self, rule: Dict):
        """è¿è¡Œæ£€æŸ¥"""
        try:
            assessment = self.assessment_engine.run_assessment(
                rule['control_id'],
                automated=True
            )
            
            rule['last_run'] = datetime.now()
            
            if assessment.status != ComplianceStatus.COMPLIANT:
                rule['failure_count'] += 1
                
                if rule['failure_count'] >= rule['alert_threshold']:
                    self._send_alert(rule, assessment)
            else:
                rule['failure_count'] = 0
                
        except Exception as e:
            self.logger.error(f"æ£€æŸ¥å¤±è´¥: {e}")

    def _send_alert(self, rule: Dict, assessment: Assessment):
        """å‘é€å‘Šè­¦"""
        self.logger.warning(
            f"æ§åˆ¶é¡¹ {rule['control_id']} è¿ç»­ {rule['failure_count']} æ¬¡ä¸åˆè§„"
        )
        # å®é™…åº”è¯¥å‘é€é‚®ä»¶æˆ–Slacké€šçŸ¥


class CompliancePlatform:
    """åˆè§„å¹³å°"""

    def __init__(self):
        self.regulation_manager = RegulationManager()
        self.assessment_engine = AssessmentEngine(self.regulation_manager)
        self.audit_reporter = AuditReporter(self.assessment_engine)
        self.monitor = ContinuousComplianceMonitor(self.assessment_engine)
        self.logger = logging.getLogger('CompliancePlatform')

    def setup_regulations(self):
        """è®¾ç½®æ³•è§„åº“"""
        # æ·»åŠ SOX
        sox = Regulation(
            id='sox',
            name='Sarbanes-Oxley Act',
            description='US financial reporting compliance',
            version='2002',
            effective_date=datetime(2002, 7, 30),
            jurisdiction='US'
        )
        self.regulation_manager.add_regulation(sox)
        
        # æ·»åŠ SOXæ§åˆ¶é¡¹
        self.regulation_manager.add_control(Control(
            id='sox-302',
            regulation_id='sox',
            control_id='302',
            title='Corporate Responsibility for Financial Reports',
            description='CEO and CFO certification of financial reports',
            control_type=ControlType.PREVENTIVE,
            risk_level=RiskLevel.CRITICAL,
            test_procedure='auto:access_log_check',
            evidence_required=['access_logs', 'certification_records'],
            frequency='quarterly'
        ))
        
        # æ·»åŠ GDPR
        gdpr = Regulation(
            id='gdpr',
            name='General Data Protection Regulation',
            description='EU data protection regulation',
            version='2016/679',
            effective_date=datetime(2018, 5, 25),
            jurisdiction='EU'
        )
        self.regulation_manager.add_regulation(gdpr)
        
        # æ·»åŠ GDPRæ§åˆ¶é¡¹
        self.regulation_manager.add_control(Control(
            id='gdpr-32',
            regulation_id='gdpr',
            control_id='Article 32',
            title='Security of Processing',
            description='Technical and organizational security measures',
            control_type=ControlType.PREVENTIVE,
            risk_level=RiskLevel.HIGH,
            test_procedure='auto:encryption_check',
            evidence_required=['encryption_config', 'security_policies'],
            frequency='monthly'
        ))

    def run_full_assessment(self) -> Dict:
        """è¿è¡Œå®Œæ•´è¯„ä¼°"""
        results = {}
        
        for regulation_id in self.regulation_manager.regulations:
            controls = self.regulation_manager.get_controls_by_regulation(regulation_id)
            
            regulation_results = []
            for control in controls:
                assessment = self.assessment_engine.run_assessment(control.id)
                regulation_results.append({
                    'control_id': control.control_id,
                    'status': assessment.status.value
                })
            
            results[regulation_id] = regulation_results
        
        return results


def main():
    """ä¸»å‡½æ•°"""
    # åˆå§‹åŒ–å¹³å°
    platform = CompliancePlatform()
    
    # è®¾ç½®æ³•è§„åº“
    platform.setup_regulations()
    
    # è¿è¡Œè¯„ä¼°
    results = platform.run_full_assessment()
    print("è¯„ä¼°ç»“æœ:")
    print(json.dumps(results, indent=2))
    
    # ç”ŸæˆæŠ¥å‘Š
    report = platform.audit_reporter.generate_compliance_report(
        regulation_id='sox',
        start_date=datetime.now() - timedelta(days=90),
        end_date=datetime.now()
    )
    print("\nåˆè§„æŠ¥å‘Š:")
    print(json.dumps(report, indent=2))


if __name__ == '__main__':
    main()
```

### 2.7 æ•ˆæœè¯„ä¼°

**æ€§èƒ½æŒ‡æ ‡**ï¼š

| æŒ‡æ ‡ | æ”¹è¿›å‰ | æ”¹è¿›å | æå‡ |
|------|--------|--------|------|
| è‡ªåŠ¨åŒ–æ£€æŸ¥æ¯”ä¾‹ | 20% | 85% | 325%æå‡ |
| å®¡è®¡å‡†å¤‡æ—¶é—´ | 4å‘¨ | 3å¤© | 89%ç¼©çŸ­ |
| åˆè§„å·®è·è¯†åˆ«æ—¶é—´ | 2å‘¨ | å®æ—¶ | æ˜¾è‘—æå‡ |
| å®¡è®¡å‘ç°æ•°é‡ | 50/å¹´ | 10/å¹´ | 80%é™ä½ |
| åˆè§„æˆæœ¬ | 100% | 55% | 45%é™ä½ |

**ROIåˆ†æ**ï¼š

1. **æˆæœ¬èŠ‚çº¦**ï¼š
   - åˆè§„äººåŠ›æˆæœ¬ï¼šæ¯å¹´ 450ä¸‡å…ƒ
   - å®¡è®¡æˆæœ¬ï¼šæ¯å¹´ 200ä¸‡å…ƒ
   - ç½šæ¬¾é¿å…ï¼šæ¯å¹´ 500ä¸‡å…ƒ

2. **æŠ•èµ„å›æŠ¥ç‡**ï¼š
   - æ€»æŠ•èµ„ï¼š600ä¸‡å…ƒ
   - å¹´åº¦æ”¶ç›Šï¼š1150ä¸‡å…ƒ
   - ROIï¼š192%

**ç»éªŒæ•™è®­**ï¼š

1. **è‡ªåŠ¨åŒ–ä¼˜å…ˆ**ï¼šå°½å¯èƒ½è‡ªåŠ¨åŒ–åˆè§„æ£€æŸ¥
2. **è¯æ®è‡ªåŠ¨åŒ–**ï¼šè‡ªåŠ¨æ”¶é›†å’Œå­˜å‚¨å®¡è®¡è¯æ®
3. **æŒç»­ç›‘æ§**ï¼šä»æ—¶ç‚¹åˆè§„è½¬å‘æŒç»­åˆè§„
4. **è·¨éƒ¨é—¨åä½œ**ï¼šåˆè§„éœ€è¦å®‰å…¨ã€ITã€ä¸šåŠ¡å…±åŒå‚ä¸

---

## 3. æ¡ˆä¾‹æ€»ç»“

### æˆåŠŸå› ç´ 

1. **ç»Ÿä¸€å¹³å°**ï¼šç»Ÿä¸€çš„åˆè§„ç®¡ç†å¹³å°
2. **è‡ªåŠ¨åŒ–æ£€æŸ¥**ï¼šå¤§éƒ¨åˆ†åˆè§„æ£€æŸ¥è‡ªåŠ¨åŒ–
3. **å®æ—¶å¯è§æ€§**ï¼šå®æ—¶äº†è§£åˆè§„çŠ¶æ€
4. **æŒç»­æ”¹è¿›**ï¼šåŸºäºè¯„ä¼°ç»“æœæŒç»­æ”¹è¿›

### æœ€ä½³å®è·µ

1. **æ³•è§„æ˜ å°„**ï¼šå»ºç«‹æ³•è§„é—´çš„æ§åˆ¶é¡¹æ˜ å°„
2. **è¯æ®ç®¡ç†**ï¼šç³»ç»ŸåŒ–ç®¡ç†å®¡è®¡è¯æ®
3. **é£é™©å¯¼å‘**ï¼šä¼˜å…ˆå¤„ç†é«˜é£é™©å·®è·
4. **å®šæœŸå®¡æŸ¥**ï¼šå®šæœŸå®¡æŸ¥å’Œæ›´æ–°æ§åˆ¶é¡¹

---

## 4. å‚è€ƒæ–‡çŒ®

- [NISTé£é™©ç®¡ç†æ¡†æ¶](https://csrc.nist.gov/projects/risk-management)
- [ISO 27001æ ‡å‡†](https://www.iso.org/standard/27001)
- [GDPRå®˜æ–¹æŒ‡å—](https://gdpr.eu/)

---

**æ–‡æ¡£åˆ›å»ºæ—¶é—´**ï¼š2025-01-21  
**æ–‡æ¡£ç‰ˆæœ¬**ï¼šv1.0  
**ç»´æŠ¤è€…**ï¼šDSL Schemaç ”ç©¶å›¢é˜Ÿ  
**æœ€åæ›´æ–°**ï¼š2025-01-21
