# å¯å†ç”Ÿèƒ½æºSchemaå®è·µæ¡ˆä¾‹

## ğŸ“‘ ç›®å½•

- [å¯å†ç”Ÿèƒ½æºSchemaå®è·µæ¡ˆä¾‹](#å¯å†ç”Ÿèƒ½æºschemaå®è·µæ¡ˆä¾‹)
  - [ğŸ“‘ ç›®å½•](#-ç›®å½•)
  - [1. æ¡ˆä¾‹æ¦‚è¿°](#1-æ¡ˆä¾‹æ¦‚è¿°)
  - [2. æ¡ˆä¾‹1ï¼šå¤§å‹é£ç”µåœºæ™ºæ…§è¿ç»´å¹³å°](#2-æ¡ˆä¾‹1å¤§å‹é£ç”µåœºæ™ºæ…§è¿ç»´å¹³å°)
    - [2.1 ä¸šåŠ¡èƒŒæ™¯](#21-ä¸šåŠ¡èƒŒæ™¯)
    - [2.2 ä¸šåŠ¡ç—›ç‚¹](#22-ä¸šåŠ¡ç—›ç‚¹)
    - [2.3 ä¸šåŠ¡ç›®æ ‡](#23-ä¸šåŠ¡ç›®æ ‡)
    - [2.4 æŠ€æœ¯æŒ‘æˆ˜](#24-æŠ€æœ¯æŒ‘æˆ˜)
    - [2.5 Schemaå®šä¹‰](#25-schemaå®šä¹‰)
    - [2.6 å®Œæ•´ä»£ç å®ç°](#26-å®Œæ•´ä»£ç å®ç°)
    - [2.7 æ•ˆæœè¯„ä¼°](#27-æ•ˆæœè¯„ä¼°)
  - [3. æ¡ˆä¾‹2ï¼šåˆ†å¸ƒå¼å…‰ä¼ç”µç«™æ™ºèƒ½ç®¡ç†å¹³å°](#3-æ¡ˆä¾‹2åˆ†å¸ƒå¼å…‰ä¼ç”µç«™æ™ºèƒ½ç®¡ç†å¹³å°)
    - [3.1 ä¸šåŠ¡èƒŒæ™¯](#31-ä¸šåŠ¡èƒŒæ™¯)
    - [3.2 ä¸šåŠ¡ç—›ç‚¹](#32-ä¸šåŠ¡ç—›ç‚¹)
    - [3.3 ä¸šåŠ¡ç›®æ ‡](#33-ä¸šåŠ¡ç›®æ ‡)
    - [3.4 æŠ€æœ¯æŒ‘æˆ˜](#34-æŠ€æœ¯æŒ‘æˆ˜)
    - [3.5 å®Œæ•´ä»£ç å®ç°](#35-å®Œæ•´ä»£ç å®ç°)
    - [3.6 æ•ˆæœè¯„ä¼°](#36-æ•ˆæœè¯„ä¼°)
  - [4. æ¡ˆä¾‹æ€»ç»“](#4-æ¡ˆä¾‹æ€»ç»“)

---

## 1. æ¡ˆä¾‹æ¦‚è¿°

æœ¬æ–‡æ¡£æä¾›å¯å†ç”Ÿèƒ½æºSchemaåœ¨é£ç”µã€å…‰ä¼ç­‰é¢†åŸŸçš„å®è·µæ¡ˆä¾‹ã€‚

---

## 2. æ¡ˆä¾‹1ï¼šå¤§å‹é£ç”µåœºæ™ºæ…§è¿ç»´å¹³å°

### 2.1 ä¸šåŠ¡èƒŒæ™¯

**ä¼ä¸šæ¦‚å†µ**ï¼šæŸæ–°èƒ½æºå‘ç”µé›†å›¢ï¼ˆä»¥ä¸‹ç®€ç§°"Gé£ç”µ"ï¼‰ï¼Œæ˜¯å›½å†…é¢†å…ˆçš„é£ç”µè¿è¥å•†ï¼Œåœ¨å…¨å›½æ‹¥æœ‰é£ç”µåœº35ä¸ªï¼Œè£…æœºæ€»å®¹é‡è¶…è¿‡800ä¸‡åƒç“¦ï¼Œå¹´å‘ç”µé‡è¶…è¿‡200äº¿åƒç“¦æ—¶ã€‚

### 2.2 ä¸šåŠ¡ç—›ç‚¹

1. **é£æœºæ•…éšœç‡é«˜**ï¼šå¹´å‡æ•…éšœåœæœºæ—¶é—´è¶…è¿‡200å°æ—¶ï¼Œå•å°é£æœºå¹´å‘ç”µé‡æŸå¤±çº¦15ä¸‡åƒç“¦æ—¶
2. **è¿ç»´æˆæœ¬é«˜æ˜‚**ï¼šå·¡æ£€ç»´æŠ¤ä¾èµ–äººå·¥ï¼Œå•å°é£æœºå¹´è¿ç»´æˆæœ¬è¶…è¿‡8ä¸‡å…ƒ
3. **å¤‡ä»¶åº“å­˜ç§¯å‹**ï¼šå…³é”®å¤‡ä»¶åº“å­˜å‘¨è½¬å¤©æ•°è¶…è¿‡180å¤©ï¼Œèµ„é‡‘å ç”¨è¶…è¿‡2äº¿å…ƒ
4. **å‘ç”µé‡é¢„æµ‹ä¸å‡†**ï¼šçŸ­æœŸåŠŸç‡é¢„æµ‹å‡†ç¡®ç‡ä»…75%ï¼Œå½±å“ç”µç½‘è°ƒåº¦å’Œç»“ç®—
5. **å®‰å…¨éšæ‚£çªå‡º**ï¼šé«˜ç©ºä½œä¸šé£é™©å¤§ï¼Œå¹´å‡å‘ç”Ÿå®‰å…¨äº‹æ•…2-3èµ·

### 2.3 ä¸šåŠ¡ç›®æ ‡

1. **é™ä½æ•…éšœç‡**ï¼šæ•…éšœåœæœºæ—¶é—´å‡å°‘50%ï¼Œå¹´å‘ç”µé‡æå‡5%
2. **é™ä½è¿ç»´æˆæœ¬**ï¼šé€šè¿‡é¢„æµ‹æ€§ç»´æŠ¤ï¼Œè¿ç»´æˆæœ¬é™ä½30%
3. **ä¼˜åŒ–å¤‡ä»¶ç®¡ç†**ï¼šå¤‡ä»¶åº“å­˜å‘¨è½¬å¤©æ•°ç¼©çŸ­è‡³90å¤©ä»¥å†…
4. **æå‡é¢„æµ‹ç²¾åº¦**ï¼šçŸ­æœŸåŠŸç‡é¢„æµ‹å‡†ç¡®ç‡è¾¾åˆ°90%ä»¥ä¸Š
5. **å¼ºåŒ–å®‰å…¨ç®¡ç†**ï¼šå®ç°è¿œç¨‹å·¡æ£€ï¼Œæœç»é«˜ç©ºä½œä¸šå®‰å…¨äº‹æ•…

### 2.4 æŠ€æœ¯æŒ‘æˆ˜

1. **æµ·é‡ä¼ æ„Ÿå™¨æ•°æ®å¤„ç†**ï¼šå•å°é£æœºä¼ æ„Ÿå™¨è¶…è¿‡500ä¸ªï¼Œæ•°æ®é‡‡æ ·é¢‘ç‡100Hz
2. **é£æœºæ•…éšœè¯Šæ–­ç®—æ³•**ï¼šéœ€è¦åŸºäºæŒ¯åŠ¨ã€æ¸©åº¦ã€ç”µæµç­‰å¤šç»´æ•°æ®è¿›è¡Œæ•…éšœé¢„æµ‹
3. **å¤æ‚ç¯å¢ƒé€‚åº”æ€§**ï¼šéœ€è¦é€‚åº”æµ·ä¸Šã€å±±åœ°ã€é«˜åŸç­‰ä¸åŒç¯å¢ƒ
4. **ç”µç½‘è°ƒåº¦å¯¹æ¥**ï¼šéœ€è¦ä¸ç”µç½‘è°ƒåº¦ç³»ç»Ÿå®æ—¶å¯¹æ¥ï¼Œæ»¡è¶³è°ƒå³°è°ƒé¢‘è¦æ±‚

### 2.5 Schemaå®šä¹‰

```json
{
  "wind_farm_id": "WF-001",
  "wind_farm_name": "æŸæµ·ä¸Šé£ç”µåœº",
  "capacity_mw": 300,
  "turbines": [
    {
      "turbine_id": "WT-001",
      "turbine_model": "WTG-6000",
      "capacity_kw": 6000,
      "status": "running",
      "measurements": {
        "wind_speed": 12.5,
        "wind_direction": 135,
        "power_output": 4800,
        "rotor_speed": 12.8,
        "nacelle_temp": 45.2,
        "gearbox_temp": 65.3,
        "generator_temp": 78.5
      }
    }
  ]
}
```

### 2.6 å®Œæ•´ä»£ç å®ç°

```python
#!/usr/bin/env python3
"""
é£ç”µåœºæ™ºæ…§è¿ç»´å¹³å°
åŠŸèƒ½ï¼šé£æœºç›‘æ§ã€æ•…éšœé¢„æµ‹ã€åŠŸç‡é¢„æµ‹ã€è¿ç»´ç®¡ç†
"""

import numpy as np
from datetime import datetime, timedelta
from typing import Dict, List, Optional
from dataclasses import dataclass, field
import random

@dataclass
class WindTurbine:
    """é£åŠ›å‘ç”µæœº"""
    turbine_id: str
    model: str
    capacity_kw: float
    status: str = "running"
    measurements: Dict[str, float] = field(default_factory=dict)
    vibration_data: List[float] = field(default_factory=list)
    
    def calculate_health_index(self) -> float:
        """è®¡ç®—å¥åº·æŒ‡æ•°"""
        # åŸºäºæŒ¯åŠ¨æ•°æ®è®¡ç®—å¥åº·åº¦
        if not self.vibration_data:
            return 100.0
        
        vibration_rms = np.sqrt(np.mean(np.square(self.vibration_data)))
        # æŒ¯åŠ¨è¶Šå¤§å¥åº·åº¦è¶Šä½
        health = max(0, 100 - vibration_rms * 10)
        return round(health, 2)
    
    def predict_fault(self) -> Optional[str]:
        """é¢„æµ‹æ•…éšœ"""
        health = self.calculate_health_index()
        
        if health < 60:
            return "gearbox_wear"
        elif health < 75:
            return "generator_overheat"
        elif health < 85:
            return "blade_imbalance"
        
        return None

@dataclass
class WindFarm:
    """é£ç”µåœº"""
    farm_id: str
    name: str
    capacity_mw: float
    turbines: Dict[str, WindTurbine] = field(default_factory=dict)
    
    def get_total_output(self) -> float:
        """è·å–æ€»è¾“å‡ºåŠŸç‡"""
        return sum(t.measurements.get("power_output", 0) 
                  for t in self.turbines.values())
    
    def get_available_capacity(self) -> float:
        """è·å–å¯ç”¨å®¹é‡"""
        return sum(t.capacity_kw for t in self.turbines.values() 
                  if t.status == "running")
    
    def predict_power(self, hours_ahead: int = 4) -> List[float]:
        """é¢„æµ‹æœªæ¥åŠŸç‡"""
        # ç®€åŒ–çš„åŠŸç‡é¢„æµ‹æ¨¡å‹
        current_power = self.get_total_output()
        predictions = []
        
        for i in range(hours_ahead):
            # æ¨¡æ‹ŸåŠŸç‡æ³¢åŠ¨
            variation = random.uniform(-0.2, 0.2)
            predicted = current_power * (1 + variation)
            predictions.append(round(predicted, 2))
        
        return predictions
    
    def get_maintenance_schedule(self) -> List[Dict]:
        """è·å–ç»´æŠ¤è®¡åˆ’"""
        schedule = []
        
        for turbine_id, turbine in self.turbines.items():
            fault = turbine.predict_fault()
            if fault:
                schedule.append({
                    "turbine_id": turbine_id,
                    "priority": "high" if turbine.calculate_health_index() < 60 else "medium",
                    "predicted_fault": fault,
                    "suggested_date": (datetime.now() + timedelta(days=7)).strftime("%Y-%m-%d"),
                    "health_index": turbine.calculate_health_index()
                })
        
        return sorted(schedule, key=lambda x: x["health_index"])


class WindFarmOAMSystem:
    """é£ç”µåœºè¿ç»´ç³»ç»Ÿ"""
    
    def __init__(self, wind_farm: WindFarm):
        self.wind_farm = wind_farm
        self.maintenance_records: List[Dict] = []
        self.fault_alerts: List[Dict] = []
    
    def collect_data(self, turbine_id: str):
        """é‡‡é›†é£æœºæ•°æ®"""
        turbine = self.wind_farm.turbines.get(turbine_id)
        if not turbine:
            return
        
        # æ¨¡æ‹Ÿæ•°æ®é‡‡é›†
        turbine.measurements = {
            "wind_speed": random.uniform(8, 15),
            "wind_direction": random.uniform(0, 360),
            "power_output": random.uniform(0.6, 1.0) * turbine.capacity_kw,
            "rotor_speed": random.uniform(10, 15),
            "nacelle_temp": random.uniform(40, 50),
            "gearbox_temp": random.uniform(60, 70),
            "generator_temp": random.uniform(70, 80)
        }
        
        # æ¨¡æ‹ŸæŒ¯åŠ¨æ•°æ®
        turbine.vibration_data = [random.uniform(0.5, 3.0) for _ in range(100)]
    
    def check_faults(self):
        """æ£€æŸ¥æ•…éšœ"""
        for turbine_id, turbine in self.wind_farm.turbines.items():
            fault = turbine.predict_fault()
            if fault:
                self.fault_alerts.append({
                    "timestamp": datetime.now().isoformat(),
                    "turbine_id": turbine_id,
                    "fault_type": fault,
                    "health_index": turbine.calculate_health_index()
                })
    
    def generate_report(self) -> Dict:
        """ç”Ÿæˆè¿è¥æŠ¥å‘Š"""
        total_capacity = sum(t.capacity_kw for t in self.wind_farm.turbines.values())
        running_count = sum(1 for t in self.wind_farm.turbines.values() if t.status == "running")
        total_output = self.wind_farm.get_total_output()
        
        # è®¡ç®—å®¹é‡å› å­
        capacity_factor = total_output / total_capacity if total_capacity > 0 else 0
        
        # åŠŸç‡é¢„æµ‹
        power_prediction = self.wind_farm.predict_power(24)
        
        return {
            "farm_id": self.wind_farm.farm_id,
            "report_time": datetime.now().isoformat(),
            "total_turbines": len(self.wind_farm.turbines),
            "running_turbines": running_count,
            "total_capacity_mw": total_capacity / 1000,
            "current_output_mw": total_output / 1000,
            "capacity_factor": round(capacity_factor, 3),
            "power_prediction_24h": power_prediction,
            "maintenance_tasks": len(self.wind_farm.get_maintenance_schedule()),
            "fault_alerts": len(self.fault_alerts)
        }


def main():
    """é£ç”µåœºè¿ç»´ç³»ç»Ÿæ¼”ç¤º"""
    
    print("=" * 60)
    print("é£ç”µåœºæ™ºæ…§è¿ç»´å¹³å°æ¼”ç¤º")
    print("=" * 60)
    
    # åˆ›å»ºé£ç”µåœº
    wind_farm = WindFarm(
        farm_id="WF-001",
        name="æŸæµ·ä¸Šé£ç”µåœº",
        capacity_mw=300
    )
    
    # æ·»åŠ é£æœº
    for i in range(1, 51):
        turbine = WindTurbine(
            turbine_id=f"WT-{i:03d}",
            model="WTG-6000",
            capacity_kw=6000
        )
        wind_farm.turbines[turbine.turbine_id] = turbine
    
    print(f"\né£ç”µåœº: {wind_farm.name}")
    print(f"æ€»è£…æœºå®¹é‡: {wind_farm.capacity_mw} MW")
    print(f"é£æœºæ•°é‡: {len(wind_farm.turbines)} å°")
    
    # åˆå§‹åŒ–è¿ç»´ç³»ç»Ÿ
    oam = WindFarmOAMSystem(wind_farm)
    
    # æ¨¡æ‹Ÿæ•°æ®é‡‡é›†
    print("\n[1] æ•°æ®é‡‡é›†")
    for turbine_id in list(wind_farm.turbines.keys())[:5]:
        oam.collect_data(turbine_id)
        turbine = wind_farm.turbines[turbine_id]
        print(f"  {turbine_id}: åŠŸç‡={turbine.measurements.get('power_output', 0):.0f}kW, "
              f"å¥åº·åº¦={turbine.calculate_health_index()}%")
    
    # æ•…éšœæ£€æµ‹
    print("\n[2] æ•…éšœæ£€æµ‹")
    oam.check_faults()
    if oam.fault_alerts:
        for alert in oam.fault_alerts[:3]:
            print(f"  è­¦å‘Š: {alert['turbine_id']} - {alert['fault_type']}")
    else:
        print("  æœªæ£€æµ‹åˆ°æ•…éšœ")
    
    # ç»´æŠ¤è®¡åˆ’
    print("\n[3] ç»´æŠ¤è®¡åˆ’")
    schedule = wind_farm.get_maintenance_schedule()
    if schedule:
        for task in schedule[:3]:
            print(f"  {task['turbine_id']}: {task['predicted_fault']}, "
                  f"å»ºè®®æ—¥æœŸ: {task['suggested_date']}")
    else:
        print("  æš‚æ— ç»´æŠ¤ä»»åŠ¡")
    
    # è¿è¥æŠ¥å‘Š
    print("\n[4] è¿è¥æŠ¥å‘Š")
    report = oam.generate_report()
    print(f"  å½“å‰æ€»å‡ºåŠ›: {report['current_output_mw']:.1f} MW")
    print(f"  å®¹é‡å› å­: {report['capacity_factor']:.1%}")
    print(f"  24å°æ—¶é¢„æµ‹å‘ç”µé‡: {sum(report['power_prediction_24h']):.0f} MWh")


if __name__ == "__main__":
    main()
```

### 2.7 æ•ˆæœè¯„ä¼°

| æŒ‡æ ‡ | åŸºçº¿å€¼ | ç›®æ ‡å€¼ | å®é™…å€¼ | è¾¾æˆç‡ |
|------|--------|--------|--------|--------|
| æ•…éšœåœæœºæ—¶é—´ | 200å°æ—¶/å¹´ | å‡å°‘50% | å‡å°‘60% | 120% |
| è¿ç»´æˆæœ¬ | 8ä¸‡å…ƒ/å°/å¹´ | é™ä½30% | é™ä½35% | 117% |
| å¤‡ä»¶å‘¨è½¬å¤©æ•° | 180å¤© | â‰¤90å¤© | 75å¤© | 120% |
| åŠŸç‡é¢„æµ‹å‡†ç¡®ç‡ | 75% | â‰¥90% | 92% | 102% |

**ROIåˆ†æ**ï¼š
- é¡¹ç›®æ€»æŠ•èµ„ï¼š5000ä¸‡å…ƒ
- å¹´åº¦æ€»æ”¶ç›Šï¼š1.2äº¿å…ƒ
- **æŠ•èµ„å›æ”¶æœŸï¼š5ä¸ªæœˆ**
- **3å¹´ROIï¼š620%**

---

## 3. æ¡ˆä¾‹2ï¼šåˆ†å¸ƒå¼å…‰ä¼ç”µç«™æ™ºèƒ½ç®¡ç†å¹³å°

### 3.1 ä¸šåŠ¡èƒŒæ™¯

**ä¼ä¸šæ¦‚å†µ**ï¼šæŸç»¼åˆèƒ½æºæœåŠ¡å…¬å¸ï¼ˆä»¥ä¸‹ç®€ç§°"Hå…‰ä¼"ï¼‰ï¼Œåœ¨å…¨å›½è¿è¥åˆ†å¸ƒå¼å…‰ä¼ç”µç«™è¶…è¿‡500ä¸ªï¼Œæ€»è£…æœºå®¹é‡è¶…è¿‡2GWï¼ŒæœåŠ¡ä¼ä¸šå®¢æˆ·è¶…è¿‡3000å®¶ã€‚

### 3.2 ä¸šåŠ¡ç—›ç‚¹

1. **ç”µç«™åˆ†æ•£éš¾ç®¡ç†**ï¼šç”µç«™éå¸ƒå…¨å›½200å¤šä¸ªåŸå¸‚ï¼Œç°åœºå·¡æ£€æˆæœ¬é«˜
2. **å‘ç”µæ•ˆç‡ä½**ï¼šç°å°˜é®æŒ¡ã€ç»„ä»¶è¡°å‡ç­‰å› ç´ å¯¼è‡´å‘ç”µé‡æŸå¤±è¶…è¿‡10%
3. **ç»“ç®—å¯¹è´¦å¤æ‚**ï¼šç”µä»·æ”¿ç­–å¤šæ ·ï¼Œç»“ç®—è§„åˆ™å¤æ‚ï¼Œå¯¹è´¦é”™è¯¯ç‡é«˜
4. **å®‰å…¨éšæ‚£å¤š**ï¼šç›´æµæ‹‰å¼§ã€çƒ­æ–‘æ•ˆåº”ç­‰å®‰å…¨éšæ‚£éš¾ä»¥åŠæ—¶å‘ç°
5. **æ•°æ®åˆ†æå¼±**ï¼šç¼ºä¹ç»Ÿä¸€çš„æ•°æ®å¹³å°ï¼Œæ— æ³•æ”¯æ’‘ç²¾ç»†åŒ–è¿è¥

### 3.3 ä¸šåŠ¡ç›®æ ‡

1. **é›†ä¸­ç›‘æ§ç®¡ç†**ï¼šå®ç°500ä¸ªç”µç«™çš„è¿œç¨‹é›†ä¸­ç›‘æ§ï¼Œæ•…éšœå“åº”æ—¶é—´ç¼©çŸ­è‡³30åˆ†é’Ÿ
2. **æå‡å‘ç”µæ•ˆç‡**ï¼šé€šè¿‡æ™ºèƒ½æ¸…æ´—å’Œè¿ç»´ä¼˜åŒ–ï¼Œå‘ç”µé‡æå‡8%ä»¥ä¸Š
3. **è‡ªåŠ¨åŒ–ç»“ç®—**ï¼šå®ç°ç”µè´¹ç»“ç®—è‡ªåŠ¨åŒ–ï¼Œå¯¹è´¦å‡†ç¡®ç‡æå‡è‡³99.9%
4. **å®‰å…¨é¢„è­¦**ï¼šå»ºç«‹å®‰å…¨éšæ‚£é¢„è­¦æœºåˆ¶ï¼Œé‡å¤§å®‰å…¨äº‹æ•…é›¶å‘ç”Ÿ
5. **æ•°æ®é©±åŠ¨å†³ç­–**ï¼šå»ºç«‹æ•°æ®åˆ†æå¹³å°ï¼Œæ”¯æ’‘æŠ•èµ„å†³ç­–å’Œè¿è¥ä¼˜åŒ–

### 3.4 æŠ€æœ¯æŒ‘æˆ˜

1. **å¼‚æ„è®¾å¤‡æ¥å…¥**ï¼šä¸åŒå‚å•†é€†å˜å™¨ã€æ±‡æµç®±ç­‰è®¾å¤‡é€šä¿¡åè®®å„å¼‚
2. **å¼±ç½‘ç¯å¢ƒé€‚åº”**ï¼šéƒ¨åˆ†åè¿œåœ°åŒºç½‘ç»œä¸ç¨³å®šï¼Œéœ€è¦ç¦»çº¿ç¼“å­˜æœºåˆ¶
3. **æµ·é‡æ•°æ®å­˜å‚¨**ï¼š500ä¸ªç”µç«™å¹´æ•°æ®é‡è¶…è¿‡10PBï¼Œéœ€è¦é«˜æ•ˆå­˜å‚¨æ–¹æ¡ˆ
4. **è¾¹ç¼˜è®¡ç®—èƒ½åŠ›**ï¼šéœ€è¦åœ¨è¾¹ç¼˜ä¾§è¿›è¡Œæ•°æ®é¢„å¤„ç†å’Œæ•…éšœæ£€æµ‹

### 3.5 å®Œæ•´ä»£ç å®ç°

```python
#!/usr/bin/env python3
"""
åˆ†å¸ƒå¼å…‰ä¼ç”µç«™æ™ºèƒ½ç®¡ç†å¹³å°
åŠŸèƒ½ï¼šç”µç«™ç›‘æ§ã€å‘ç”µåˆ†æã€è¿ç»´è°ƒåº¦ã€ç»“ç®—ç®¡ç†
"""

from datetime import datetime, date
from typing import Dict, List, Optional
from dataclasses import dataclass, field
from decimal import Decimal
import random


@dataclass
class PVPlant:
    """å…‰ä¼ç”µç«™"""
    plant_id: str
    plant_name: str
    location: str
    capacity_kw: float
    install_date: date
    
    # å®æ—¶æ•°æ®
    current_power: float = 0.0
    daily_generation: float = 0.0
    total_generation: float = 0.0
    
    # æ•ˆç‡æŒ‡æ ‡
    pr_value: float = 0.0  # ç³»ç»Ÿæ•ˆç‡
    irradiance: float = 0.0  # è¾ç…§åº¦
    module_temp: float = 0.0  # ç»„ä»¶æ¸©åº¦


@dataclass
class Inverter:
    """é€†å˜å™¨"""
    inverter_id: str
    plant_id: str
    capacity_kw: float
    status: str = "normal"  # normal, warning, fault
    
    dc_voltage: float = 0.0
    dc_current: float = 0.0
    ac_power: float = 0.0
    ac_voltage: float = 0.0
    ac_current: float = 0.0
    efficiency: float = 0.0
    temperature: float = 0.0


@dataclass
class GenerationRecord:
    """å‘ç”µé‡è®°å½•"""
    plant_id: str
    date: date
    generation_kwh: float
    irradiation_kwh_m2: float
    pr_value: float
    revenue: Decimal


class DistributedPVPlatform:
    """åˆ†å¸ƒå¼å…‰ä¼ç®¡ç†å¹³å°"""
    
    def __init__(self):
        self.plants: Dict[str, PVPlant] = {}
        self.inverters: Dict[str, Inverter] = {}
        self.generation_records: List[GenerationRecord] = []
        self.alerts: List[Dict] = []
    
    def add_plant(self, plant: PVPlant):
        """æ·»åŠ ç”µç«™"""
        self.plants[plant.plant_id] = plant
    
    def add_inverter(self, inverter: Inverter):
        """æ·»åŠ é€†å˜å™¨"""
        self.inverters[inverter.inverter_id] = inverter
    
    def collect_data(self, plant_id: str):
        """é‡‡é›†ç”µç«™æ•°æ®"""
        plant = self.plants.get(plant_id)
        if not plant:
            return
        
        # æ¨¡æ‹Ÿå®æ—¶æ•°æ®
        plant.irradiance = random.uniform(800, 1000)
        plant.module_temp = random.uniform(45, 65)
        
        # è®¡ç®—å½“å‰åŠŸç‡
        inverters = [inv for inv in self.inverters.values() if inv.plant_id == plant_id]
        total_ac_power = 0.0
        
        for inv in inverters:
            inv.dc_voltage = random.uniform(600, 800)
            inv.dc_current = random.uniform(100, 150)
            inv.ac_power = inv.dc_voltage * inv.dc_current * 0.98 / 1000  # kW
            inv.ac_voltage = random.uniform(380, 400)
            inv.ac_current = inv.ac_power * 1000 / inv.ac_voltage / 1.732
            inv.efficiency = random.uniform(0.97, 0.99)
            inv.temperature = random.uniform(40, 60)
            total_ac_power += inv.ac_power
        
        plant.current_power = total_ac_power
        plant.daily_generation += total_ac_power * 0.25  # 15åˆ†é’Ÿæ•°æ®
        
        # è®¡ç®—ç³»ç»Ÿæ•ˆç‡PR
        theoretical_power = plant.capacity_kw * (plant.irradiance / 1000)
        plant.pr_value = (total_ac_power / theoretical_power * 100) if theoretical_power > 0 else 0
    
    def check_alerts(self):
        """æ£€æŸ¥å‘Šè­¦"""
        for inv_id, inv in self.inverters.items():
            if inv.temperature > 70:
                self.alerts.append({
                    "timestamp": datetime.now().isoformat(),
                    "level": "warning",
                    "device": inv_id,
                    "message": f"é€†å˜å™¨æ¸©åº¦è¿‡é«˜: {inv.temperature:.1f}Â°C"
                })
            
            if inv.efficiency < 0.95:
                self.alerts.append({
                    "timestamp": datetime.now().isoformat(),
                    "level": "warning",
                    "device": inv_id,
                    "message": f"é€†å˜å™¨æ•ˆç‡åä½: {inv.efficiency:.1%}"
                })
    
    def calculate_settlement(self, plant_id: str, year: int, month: int) -> Dict:
        """è®¡ç®—ç»“ç®—"""
        plant = self.plants.get(plant_id)
        if not plant:
            return {}
        
        # æŸ¥è¯¢å½“æœˆå‘ç”µé‡è®°å½•
        records = [r for r in self.generation_records 
                  if r.plant_id == plant_id and r.date.year == year and r.date.month == month]
        
        total_generation = sum(r.generation_kwh for r in records)
        total_revenue = sum(r.revenue for r in records)
        
        # æ¨¡æ‹Ÿç”µä»·
        feed_in_tariff = Decimal('0.45')  # ä¸Šç½‘ç”µä»·å…ƒ/kWh
        subsidy = Decimal('0.15')  # è¡¥è´´å…ƒ/kWh
        
        grid_revenue = Decimal(str(total_generation)) * feed_in_tariff
        subsidy_revenue = Decimal(str(total_generation)) * subsidy
        
        return {
            "plant_id": plant_id,
            "year": year,
            "month": month,
            "total_generation_kwh": round(total_generation, 2),
            "grid_revenue": round(grid_revenue, 2),
            "subsidy_revenue": round(subsidy_revenue, 2),
            "total_revenue": round(grid_revenue + subsidy_revenue, 2)
        }
    
    def generate_daily_report(self) -> Dict:
        """ç”Ÿæˆæ—¥æŠ¥"""
        total_capacity = sum(p.capacity_kw for p in self.plants.values())
        total_generation = sum(p.daily_generation for p in self.plants.values())
        total_plants = len(self.plants)
        
        # è®¡ç®—ç­‰æ•ˆå‘ç”µå°æ—¶æ•°
        equivalent_hours = total_generation / total_capacity if total_capacity > 0 else 0
        
        return {
            "report_date": date.today().isoformat(),
            "total_plants": total_plants,
            "total_capacity_mw": round(total_capacity / 1000, 2),
            "daily_generation_mwh": round(total_generation / 1000, 2),
            "equivalent_hours": round(equivalent_hours, 2),
            "active_alerts": len(self.alerts),
            "plants_online": sum(1 for p in self.plants.values() if p.current_power > 0)
        }


def main():
    """åˆ†å¸ƒå¼å…‰ä¼å¹³å°æ¼”ç¤º"""
    
    print("=" * 60)
    print("åˆ†å¸ƒå¼å…‰ä¼ç”µç«™æ™ºèƒ½ç®¡ç†å¹³å°æ¼”ç¤º")
    print("=" * 60)
    
    platform = DistributedPVPlatform()
    
    # åˆ›å»ºç”µç«™
    print("\n[1] åˆ›å»ºç”µç«™")
    for i in range(1, 6):
        plant = PVPlant(
            plant_id=f"PLANT-{i:03d}",
            plant_name=f"åˆ†å¸ƒå¼ç”µç«™{i}å·",
            location=random.choice(["æ±Ÿè‹", "æµ™æ±Ÿ", "å±±ä¸œ", "æ²³åŒ—", "å¹¿ä¸œ"]),
            capacity_kw=random.choice([500, 1000, 2000, 3000]),
            install_date=date(2023, random.randint(1, 12), 1)
        )
        platform.add_plant(plant)
        
        # ä¸ºæ¯ä¸ªç”µç«™æ·»åŠ é€†å˜å™¨
        for j in range(1, 4):
            inverter = Inverter(
                inverter_id=f"INV-{i:03d}-{j:02d}",
                plant_id=plant.plant_id,
                capacity_kw=plant.capacity_kw / 3
            )
            platform.add_inverter(inverter)
    
    print(f"å·²åˆ›å»º {len(platform.plants)} ä¸ªç”µç«™")
    print(f"æ€»è£…æœºå®¹é‡: {sum(p.capacity_kw for p in platform.plants.values()) / 1000:.1f} MW")
    
    # æ•°æ®é‡‡é›†
    print("\n[2] å®æ—¶æ•°æ®é‡‡é›†")
    for plant_id in list(platform.plants.keys())[:3]:
        platform.collect_data(plant_id)
        plant = platform.plants[plant_id]
        print(f"  {plant.plant_name}: å½“å‰åŠŸç‡={plant.current_power:.1f}kW, "
              f"PR={plant.pr_value:.1f}%")
    
    # å‘Šè­¦æ£€æŸ¥
    print("\n[3] å‘Šè­¦æ£€æŸ¥")
    platform.check_alerts()
    if platform.alerts:
        for alert in platform.alerts[:3]:
            print(f"  [{alert['level'].upper()}] {alert['device']}: {alert['message']}")
    else:
        print("  æ— å‘Šè­¦")
    
    # æ—¥æŠ¥
    print("\n[4] è¿è¥æ—¥æŠ¥")
    report = platform.generate_daily_report()
    print(f"  ç”µç«™æ•°é‡: {report['total_plants']}")
    print(f"  æ€»è£…æœºå®¹é‡: {report['total_capacity_mw']} MW")
    print(f"  æ—¥å‘ç”µé‡: {report['daily_generation_mwh']} MWh")
    print(f"  ç­‰æ•ˆå‘ç”µå°æ—¶æ•°: {report['equivalent_hours']} h")


if __name__ == "__main__":
    main()
```

### 3.6 æ•ˆæœè¯„ä¼°

| æŒ‡æ ‡ | åŸºçº¿å€¼ | ç›®æ ‡å€¼ | å®é™…å€¼ | è¾¾æˆç‡ |
|------|--------|--------|--------|--------|
| æ•…éšœå“åº”æ—¶é—´ | 4å°æ—¶ | â‰¤30åˆ†é’Ÿ | 25åˆ†é’Ÿ | 120% |
| å‘ç”µé‡æå‡ | åŸºå‡† | æå‡8% | æå‡10% | 125% |
| å¯¹è´¦å‡†ç¡®ç‡ | 95% | â‰¥99.9% | 99.95% | 100% |
| é‡å¤§å®‰å…¨äº‹æ•… | å¹´å‡2èµ· | 0èµ· | 0èµ· | 100% |

**ROIåˆ†æ**ï¼š
- é¡¹ç›®æ€»æŠ•èµ„ï¼š3000ä¸‡å…ƒ
- å¹´åº¦æ€»æ”¶ç›Šï¼š8000ä¸‡å…ƒ
- **æŠ•èµ„å›æ”¶æœŸï¼š4.5ä¸ªæœˆ**
- **3å¹´ROIï¼š700%**

---

## 4. æ¡ˆä¾‹æ€»ç»“

é€šè¿‡é£ç”µã€å…‰ä¼ä¸¤ä¸ªæ¡ˆä¾‹çš„å®æ–½ï¼ŒéªŒè¯äº†å¯å†ç”Ÿèƒ½æºSchemaåœ¨æ–°èƒ½æºé¢†åŸŸçš„åº”ç”¨ä»·å€¼ï¼š

**å…³é”®æˆåŠŸå› ç´ **ï¼š
1. è®¾å¤‡æ ‡å‡†åŒ–æ¥å…¥æ˜¯å‰æ
2. é¢„æµ‹æ€§ç»´æŠ¤æ˜¯é™æœ¬å¢æ•ˆçš„å…³é”®
3. æ•°æ®é©±åŠ¨å†³ç­–æ˜¯æå‡è¿è¥æ•ˆç‡çš„æ ¸å¿ƒ

**æŠ€æœ¯æ¼”è¿›æ–¹å‘**ï¼š
1. æ•°å­—å­ªç”ŸæŠ€æœ¯æ·±åº¦åº”ç”¨
2. AIæŠ€æœ¯åœ¨åŠŸç‡é¢„æµ‹ã€æ•…éšœè¯Šæ–­çš„æ·±åº¦åº”ç”¨
3. æºç½‘è·å‚¨ä¸€ä½“åŒ–ååŒæ§åˆ¶

**åˆ›å»ºæ—¶é—´**ï¼š2025-01-21  
**æœ€åæ›´æ–°**ï¼š2025-02-15
