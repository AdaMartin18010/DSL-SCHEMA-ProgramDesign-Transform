# å»ºç­‘ä¿¡æ¯æ¨¡å‹(BIM)Schemaå®è·µæ¡ˆä¾‹

## ğŸ“‘ ç›®å½•

- [1. æ¡ˆä¾‹æ¦‚è¿°](#1-æ¡ˆä¾‹æ¦‚è¿°)
- [2. ä¼ä¸šèƒŒæ™¯](#2-ä¼ä¸šèƒŒæ™¯)
- [3. ä¸šåŠ¡ç—›ç‚¹ä¸ç›®æ ‡](#3-ä¸šåŠ¡ç—›ç‚¹ä¸ç›®æ ‡)
- [4. æŠ€æœ¯æŒ‘æˆ˜](#4-æŠ€æœ¯æŒ‘æˆ˜)
- [5. è§£å†³æ–¹æ¡ˆæ¶æ„](#5-è§£å†³æ–¹æ¡ˆæ¶æ„)
- [6. å®Œæ•´å®ç°ä»£ç ](#6-å®Œæ•´å®ç°ä»£ç )
- [7. æ•ˆæœè¯„ä¼°ä¸ROIåˆ†æ](#7-æ•ˆæœè¯„ä¼°ä¸roiåˆ†æ)
- [8. è¯¦ç»†æ¡ˆä¾‹å®ç°](#8-è¯¦ç»†æ¡ˆä¾‹å®ç°)

---

## 1. æ¡ˆä¾‹æ¦‚è¿°

æœ¬æ–‡æ¡£æä¾›å»ºç­‘ä¿¡æ¯æ¨¡å‹Schemaåœ¨å®é™…åº”ç”¨ä¸­çš„å®Œæ•´å®è·µæ¡ˆä¾‹ï¼Œæ¶µç›–å»ºç­‘è®¾è®¡ã€æ–½å·¥ç®¡ç†ã€è¿ç»´ç®¡ç†ç­‰å…¨ç”Ÿå‘½å‘¨æœŸåœºæ™¯ã€‚é€šè¿‡Schemaé©±åŠ¨çš„æ–¹æ³•ï¼Œå®ç°å»ºç­‘æ•°æ®çš„ç»“æ„åŒ–ç®¡ç†å’Œæ™ºèƒ½åˆ†æã€‚

---

## 2. ä¼ä¸šèƒŒæ™¯

### 2.1 ä¼ä¸šæ¦‚å†µ

**ä¼ä¸šåç§°**ï¼šä¸­å»ºæ•°å­—ç§‘æŠ€é›†å›¢æœ‰é™å…¬å¸ï¼ˆè™šæ„æ¡ˆä¾‹ä¼ä¸šï¼‰

**ä¼ä¸šè§„æ¨¡**ï¼š
- å¹´è¥ä¸šé¢ï¼š120äº¿å…ƒäººæ°‘å¸
- å‘˜å·¥æ€»æ•°ï¼š8,500äºº
- åœ¨å»ºé¡¹ç›®ï¼š45ä¸ªï¼ˆæ€»å»ºç­‘é¢ç§¯è¶…è¿‡800ä¸‡å¹³æ–¹ç±³ï¼‰
- ä¸šåŠ¡è¦†ç›–ï¼šå»ºç­‘è®¾è®¡ã€æ–½å·¥æ€»æ‰¿åŒ…ã€è®¾æ–½è¿ç»´

**æ ¸å¿ƒä¸šåŠ¡**ï¼š
- å¤§å‹å•†ä¸šç»¼åˆä½“è®¾è®¡ä¸æ–½å·¥
- æ™ºæ…§åŸå¸‚å»ºè®¾
- ç»¿è‰²å»ºç­‘è®¤è¯å’¨è¯¢
- å»ºç­‘æ•°å­—åŒ–è¿ç»´æœåŠ¡

**æ•°å­—åŒ–ç°çŠ¶**ï¼š
- å·²éƒ¨ç½²Revitã€AutoCADç­‰è®¾è®¡è½¯ä»¶
- ä½¿ç”¨ä¼ ç»ŸExcelç®¡ç†é¡¹ç›®æ•°æ®
- å„éƒ¨é—¨æ•°æ®å­¤å²›ä¸¥é‡
- ç¼ºä¹ç»Ÿä¸€çš„æ•°æ®æ ‡å‡†å’Œäº¤æ¢æ ¼å¼

---

## 3. ä¸šåŠ¡ç—›ç‚¹ä¸ç›®æ ‡

### 3.1 äº”å¤§ä¸šåŠ¡ç—›ç‚¹

| åºå· | ç—›ç‚¹ | å…·ä½“è¡¨ç° | å½±å“ç¨‹åº¦ |
|------|------|----------|----------|
| 1 | **æ•°æ®å­¤å²›ä¸¥é‡** | è®¾è®¡ã€æ–½å·¥ã€è¿ç»´éƒ¨é—¨ä½¿ç”¨ä¸åŒç³»ç»Ÿï¼Œæ•°æ®æ— æ³•äº’é€š | é«˜ |
| 2 | **ç‰ˆæœ¬ç®¡ç†æ··ä¹±** | è®¾è®¡å›¾çº¸ç‰ˆæœ¬ä¼—å¤šï¼Œç°åœºæ–½å·¥ä½¿ç”¨é”™è¯¯ç‰ˆæœ¬é¢‘å‘ | é«˜ |
| 3 | **å˜æ›´ç®¡ç†å›°éš¾** | è®¾è®¡å˜æ›´ä¿¡æ¯ä¼ é€’æ»åï¼Œå¯¼è‡´è¿”å·¥æˆæœ¬å¢åŠ  | é«˜ |
| 4 | **è¿›åº¦è·Ÿè¸ªæ»å** | ä¾èµ–äººå·¥æ±‡æŠ¥ï¼Œæ— æ³•å®æ—¶æŒæ¡é¡¹ç›®è¿›åº¦ | ä¸­ |
| 5 | **æˆæœ¬æ§åˆ¶ç²—æ”¾** | ç¼ºä¹ç²¾å‡†çš„ææ–™ç»Ÿè®¡å’Œæˆæœ¬é¢„æµ‹èƒ½åŠ› | ä¸­ |

### 3.2 äº”å¤§ä¸šåŠ¡ç›®æ ‡

| åºå· | ç›®æ ‡ | å…·ä½“æŒ‡æ ‡ | å®ŒæˆæœŸé™ |
|------|------|----------|----------|
| 1 | **å»ºç«‹ç»Ÿä¸€æ•°æ®æ ‡å‡†** | åˆ¶å®šä¼ä¸šçº§BIM Schemaæ ‡å‡†ï¼Œè¦†ç›–å…¨ç”Ÿå‘½å‘¨æœŸ | 6ä¸ªæœˆ |
| 2 | **å®ç°æ•°æ®äº’é€š** | è®¾è®¡-æ–½å·¥-è¿ç»´æ•°æ®æ— ç¼æµè½¬ï¼Œæ•°æ®å…±äº«ç‡>95% | 12ä¸ªæœˆ |
| 3 | **æå‡è®¾è®¡æ•ˆç‡** | è‡ªåŠ¨åŒ–ç”ŸæˆCOBieæ•°æ®ï¼Œå‡å°‘äººå·¥å¤„ç†æ—¶é—´80% | 9ä¸ªæœˆ |
| 4 | **ä¼˜åŒ–æ–½å·¥ç®¡ç†** | å®æ—¶è¿›åº¦è·Ÿè¸ªï¼Œè¿›åº¦åå·®æ§åˆ¶åœ¨5%ä»¥å†… | 12ä¸ªæœˆ |
| 5 | **é™ä½è¿è¥æˆæœ¬** | é€šè¿‡æ™ºèƒ½è¿ç»´ï¼Œèƒ½è€—é™ä½15%ï¼Œç»´æŠ¤æˆæœ¬é™ä½20% | 24ä¸ªæœˆ |

---

## 4. æŠ€æœ¯æŒ‘æˆ˜

### 4.1 äº”å¤§æŠ€æœ¯æŒ‘æˆ˜

1. **å¤šæºå¼‚æ„æ•°æ®èåˆ**
   - IFCã€gbXMLã€COBieç­‰å¤šç§æ ¼å¼å¹¶å­˜
   - ä¸åŒè½¯ä»¶å‚å•†æ•°æ®æ ¼å¼å·®å¼‚å¤§
   - éœ€è¦ç»Ÿä¸€çš„æ•°æ®è½¬æ¢å’ŒéªŒè¯æœºåˆ¶

2. **å¤§è§„æ¨¡æ•°æ®å¤„ç†æ€§èƒ½**
   - å•ä¸ªIFCæ–‡ä»¶å¯è¾¾æ•°GB
   - éœ€è¦é«˜æ•ˆçš„ç©ºé—´ç´¢å¼•å’ŒæŸ¥è¯¢
   - å®æ—¶æ¸²æŸ“å’Œå¯è§†åŒ–è¦æ±‚é«˜

3. **å¤æ‚å…³ç³»å»ºæ¨¡**
   - å»ºç­‘å…ƒç´ ä¹‹é—´çš„ç©ºé—´å…³ç³»å¤æ‚
   - éœ€è¦æ”¯æŒç‰ˆæœ¬è¿½æº¯å’Œå˜æ›´å†å²
   - å¤šå±‚çº§åˆ†è§£ç»“æ„ï¼ˆé¡¹ç›®-å•ä½“-æ¥¼å±‚-æˆ¿é—´-å…ƒç´ ï¼‰

4. **å®æ—¶ååŒç¼–è¾‘**
   - å¤šä¸“ä¸šåŒæ—¶è®¾è®¡éœ€è¦å†²çªæ£€æµ‹
   - å˜æ›´çš„å®æ—¶åŒæ­¥å’Œä¼ æ’­
   - æƒé™æ§åˆ¶å’Œå®¡è®¡è¿½è¸ª

5. **æ•°æ®å®‰å…¨ä¸åˆè§„**
   - å»ºç­‘æ•°æ®æ¶‰åŠå•†ä¸šæœºå¯†
   - éœ€è¦ç¬¦åˆISO 19650ç­‰å›½é™…æ ‡å‡†
   - æ•°æ®ä¸»æƒå’Œéšç§ä¿æŠ¤è¦æ±‚

---

## 5. è§£å†³æ–¹æ¡ˆæ¶æ„

### 5.1 æ€»ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    åº”ç”¨å±‚ (Application)                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ è®¾è®¡ç®¡ç†  â”‚  â”‚ æ–½å·¥ç®¡ç†  â”‚  â”‚ è¿ç»´ç®¡ç†  â”‚  â”‚ æ•°æ®åˆ†æ  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    æœåŠ¡å±‚ (Service)                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Schema   â”‚  â”‚ æ•°æ®è½¬æ¢  â”‚  â”‚ å†²çªæ£€æµ‹  â”‚  â”‚ æƒé™ç®¡ç†  â”‚    â”‚
â”‚  â”‚ éªŒè¯å¼•æ“  â”‚  â”‚ å¼•æ“     â”‚  â”‚ å¼•æ“     â”‚  â”‚ æœåŠ¡     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    æ•°æ®å±‚ (Data)                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ BIMæ¨¡å‹  â”‚  â”‚ é¡¹ç›®æ•°æ®  â”‚  â”‚ è®¾å¤‡æ•°æ®  â”‚  â”‚ å†å²æ•°æ®  â”‚    â”‚
â”‚  â”‚ æ•°æ®åº“   â”‚  â”‚ å­˜å‚¨     â”‚  â”‚ å­˜å‚¨     â”‚  â”‚ å½’æ¡£     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    æ ‡å‡†å±‚ (Standard)                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ IFC4     â”‚  â”‚ gbXML    â”‚  â”‚ COBie    â”‚  â”‚ ä¼ä¸šSchemaâ”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6. å®Œæ•´å®ç°ä»£ç 

### 6.1 BIM Schemaæ ¸å¿ƒå®ç°

```python
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
BIM Schemaå®è·µæ¡ˆä¾‹ - å®Œæ•´å®ç°
ä¼ä¸šï¼šä¸­å»ºæ•°å­—ç§‘æŠ€é›†å›¢æœ‰é™å…¬å¸
ä½œè€…ï¼šSchemaå·¥ç¨‹å›¢é˜Ÿ
ç‰ˆæœ¬ï¼š2.0.0
"""

import json
import uuid
from datetime import datetime, date
from typing import Dict, List, Optional, Any, Union
from dataclasses import dataclass, field, asdict
from enum import Enum
import logging

# é…ç½®æ—¥å¿—
logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)


class ElementType(Enum):
    """å»ºç­‘å…ƒç´ ç±»å‹æšä¸¾"""
    WALL = "Wall"
    DOOR = "Door"
    WINDOW = "Window"
    COLUMN = "Column"
    BEAM = "Beam"
    SLAB = "Slab"
    ROOF = "Roof"
    STAIR = "Stair"
    RAILING = "Railing"


class MaterialType(Enum):
    """ææ–™ç±»å‹æšä¸¾"""
    CONCRETE = "Concrete"
    STEEL = "Steel"
    GLASS = "Glass"
    WOOD = "Wood"
    BRICK = "Brick"
    INSULATION = "Insulation"


class ProjectStatus(Enum):
    """é¡¹ç›®çŠ¶æ€æšä¸¾"""
    PLANNING = "Planning"
    DESIGN = "Design"
    CONSTRUCTION = "Construction"
    COMMISSIONING = "Commissioning"
    OPERATION = "Operation"


@dataclass
class Point3D:
    """ä¸‰ç»´ç‚¹åæ ‡"""
    x: float = 0.0
    y: float = 0.0
    z: float = 0.0
    
    def to_dict(self) -> Dict:
        return {"x": self.x, "y": self.y, "z": self.z}


@dataclass
class Dimensions:
    """å°ºå¯¸ä¿¡æ¯"""
    length: float = 0.0
    width: float = 0.0
    height: float = 0.0
    thickness: float = 0.0
    
    @property
    def volume(self) -> float:
        return self.length * self.width * self.height
    
    @property
    def surface_area(self) -> float:
        return 2 * (self.length * self.width + self.length * self.height + self.width * self.height)
    
    def to_dict(self) -> Dict:
        return {
            "length": self.length,
            "width": self.width,
            "height": self.height,
            "thickness": self.thickness,
            "volume": self.volume,
            "surface_area": self.surface_area
        }


@dataclass
class Material:
    """ææ–™å®šä¹‰"""
    material_id: str
    name: str
    material_type: MaterialType
    density: float = 0.0  # kg/mÂ³
    thermal_conductivity: float = 0.0  # W/(mÂ·K)
    specific_heat: float = 0.0  # J/(kgÂ·K)
    strength: float = 0.0  # MPa
    cost_per_unit: float = 0.0  # å…ƒ/kg
    
    def to_dict(self) -> Dict:
        return {
            "material_id": self.material_id,
            "name": self.name,
            "material_type": self.material_type.value,
            "density": self.density,
            "thermal_conductivity": self.thermal_conductivity,
            "specific_heat": self.specific_heat,
            "strength": self.strength,
            "cost_per_unit": self.cost_per_unit
        }


@dataclass
class Geometry:
    """å‡ ä½•ä¿¡æ¯"""
    placement: Point3D = field(default_factory=Point3D)
    dimensions: Dimensions = field(default_factory=Dimensions)
    representation_type: str = "SweptSolid"
    
    def to_dict(self) -> Dict:
        return {
            "placement": self.placement.to_dict(),
            "dimensions": self.dimensions.to_dict(),
            "representation_type": self.representation_type
        }


@dataclass
class BuildingElement:
    """å»ºç­‘å…ƒç´ """
    element_id: str
    element_type: ElementType
    global_id: str
    name: str
    description: str = ""
    tag: str = ""
    geometry: Geometry = field(default_factory=Geometry)
    material: Optional[Material] = None
    properties: Dict[str, Any] = field(default_factory=dict)
    created_at: datetime = field(default_factory=datetime.now)
    modified_at: datetime = field(default_factory=datetime.now)
    
    def __post_init__(self):
        if not self.global_id:
            self.global_id = str(uuid.uuid4())
    
    def to_dict(self) -> Dict:
        result = {
            "element_id": self.element_id,
            "element_type": self.element_type.value,
            "global_id": self.global_id,
            "name": self.name,
            "description": self.description,
            "tag": self.tag,
            "geometry": self.geometry.to_dict(),
            "material": self.material.to_dict() if self.material else None,
            "properties": self.properties,
            "created_at": self.created_at.isoformat(),
            "modified_at": self.modified_at.isoformat()
        }
        return result
    
    def calculate_cost(self) -> float:
        """è®¡ç®—å…ƒç´ æˆæœ¬"""
        if self.material:
            volume = self.geometry.dimensions.volume
            density = self.material.density
            cost_per_unit = self.material.cost_per_unit
            return volume * density * cost_per_unit
        return 0.0


@dataclass
class Space:
    """ç©ºé—´å®šä¹‰"""
    space_id: str
    global_id: str
    name: str
    space_type: str
    long_name: str = ""
    description: str = ""
    geometry: Geometry = field(default_factory=Geometry)
    floor: str = ""
    elevation: float = 0.0
    height: float = 0.0
    area: float = 0.0
    volume: float = 0.0
    elements: List[str] = field(default_factory=list)
    
    def __post_init__(self):
        if not self.global_id:
            self.global_id = str(uuid.uuid4())
        if not self.area and self.geometry:
            # ç®€åŒ–çš„é¢ç§¯è®¡ç®—
            self.area = self.geometry.dimensions.length * self.geometry.dimensions.width
        if not self.volume and self.geometry:
            self.volume = self.area * self.height
    
    def to_dict(self) -> Dict:
        return {
            "space_id": self.space_id,
            "global_id": self.global_id,
            "name": self.name,
            "space_type": self.space_type,
            "long_name": self.long_name,
            "description": self.description,
            "geometry": self.geometry.to_dict(),
            "floor": self.floor,
            "elevation": self.elevation,
            "height": self.height,
            "area": self.area,
            "volume": self.volume,
            "elements": self.elements
        }


@dataclass
class Floor:
    """æ¥¼å±‚å®šä¹‰"""
    floor_id: str
    global_id: str
    name: str
    elevation: float = 0.0
    height: float = 0.0
    area: float = 0.0
    spaces: List[str] = field(default_factory=list)
    
    def __post_init__(self):
        if not self.global_id:
            self.global_id = str(uuid.uuid4())
    
    def to_dict(self) -> Dict:
        return {
            "floor_id": self.floor_id,
            "global_id": self.global_id,
            "name": self.name,
            "elevation": self.elevation,
            "height": self.height,
            "area": self.area,
            "spaces": self.spaces
        }


@dataclass
class BIMProject:
    """BIMé¡¹ç›®"""
    project_id: str
    project_name: str
    description: str = ""
    status: ProjectStatus = ProjectStatus.PLANNING
    start_date: Optional[date] = None
    end_date: Optional[date] = None
    building_elements: List[BuildingElement] = field(default_factory=list)
    spaces: List[Space] = field(default_factory=list)
    floors: List[Floor] = field(default_factory=list)
    materials: List[Material] = field(default_factory=list)
    created_at: datetime = field(default_factory=datetime.now)
    
    def add_element(self, element: BuildingElement) -> None:
        """æ·»åŠ å»ºç­‘å…ƒç´ """
        self.building_elements.append(element)
        logger.info(f"Added building element: {element.name} ({element.element_id})")
    
    def add_space(self, space: Space) -> None:
        """æ·»åŠ ç©ºé—´"""
        self.spaces.append(space)
        logger.info(f"Added space: {space.name} ({space.space_id})")
    
    def add_floor(self, floor: Floor) -> None:
        """æ·»åŠ æ¥¼å±‚"""
        self.floors.append(floor)
        logger.info(f"Added floor: {floor.name} ({floor.floor_id})")
    
    def add_material(self, material: Material) -> None:
        """æ·»åŠ ææ–™"""
        self.materials.append(material)
        logger.info(f"Added material: {material.name} ({material.material_id})")
    
    def get_elements_by_type(self, element_type: ElementType) -> List[BuildingElement]:
        """æŒ‰ç±»å‹è·å–å»ºç­‘å…ƒç´ """
        return [e for e in self.building_elements if e.element_type == element_type]
    
    def get_total_cost(self) -> float:
        """è®¡ç®—é¡¹ç›®æ€»æˆæœ¬"""
        return sum(e.calculate_cost() for e in self.building_elements)
    
    def get_statistics(self) -> Dict:
        """è·å–é¡¹ç›®ç»Ÿè®¡ä¿¡æ¯"""
        element_counts = {}
        for et in ElementType:
            count = len(self.get_elements_by_type(et))
            if count > 0:
                element_counts[et.value] = count
        
        total_area = sum(s.area for s in self.spaces)
        total_volume = sum(s.volume for s in self.spaces)
        
        return {
            "project_id": self.project_id,
            "project_name": self.project_name,
            "status": self.status.value,
            "element_count": len(self.building_elements),
            "space_count": len(self.spaces),
            "floor_count": len(self.floors),
            "material_count": len(self.materials),
            "element_types": element_counts,
            "total_area": round(total_area, 2),
            "total_volume": round(total_volume, 2),
            "total_cost": round(self.get_total_cost(), 2)
        }
    
    def to_dict(self) -> Dict:
        """è½¬æ¢ä¸ºå­—å…¸"""
        return {
            "project_id": self.project_id,
            "project_name": self.project_name,
            "description": self.description,
            "status": self.status.value,
            "start_date": self.start_date.isoformat() if self.start_date else None,
            "end_date": self.end_date.isoformat() if self.end_date else None,
            "building_elements": [e.to_dict() for e in self.building_elements],
            "spaces": [s.to_dict() for s in self.spaces],
            "floors": [f.to_dict() for f in self.floors],
            "materials": [m.to_dict() for m in self.materials],
            "statistics": self.get_statistics(),
            "created_at": self.created_at.isoformat()
        }
    
    def export_to_json(self, file_path: str) -> None:
        """å¯¼å‡ºä¸ºJSONæ–‡ä»¶"""
        with open(file_path, 'w', encoding='utf-8') as f:
            json.dump(self.to_dict(), f, ensure_ascii=False, indent=2)
        logger.info(f"Project exported to: {file_path}")


class BIMSchemaManager:
    """BIM Schemaç®¡ç†å™¨"""
    
    def __init__(self):
        self.projects: Dict[str, BIMProject] = {}
        self.material_library: Dict[str, Material] = {}
    
    def create_project(self, project_id: str, project_name: str, **kwargs) -> BIMProject:
        """åˆ›å»ºæ–°é¡¹ç›®"""
        project = BIMProject(project_id=project_id, project_name=project_name, **kwargs)
        self.projects[project_id] = project
        logger.info(f"Created project: {project_name} ({project_id})")
        return project
    
    def get_project(self, project_id: str) -> Optional[BIMProject]:
        """è·å–é¡¹ç›®"""
        return self.projects.get(project_id)
    
    def add_material_to_library(self, material: Material) -> None:
        """æ·»åŠ ææ–™åˆ°åº“"""
        self.material_library[material.material_id] = material
        logger.info(f"Added material to library: {material.name}")
    
    def get_material_from_library(self, material_id: str) -> Optional[Material]:
        """ä»åº“ä¸­è·å–ææ–™"""
        return self.material_library.get(material_id)
    
    def validate_project(self, project: BIMProject) -> List[str]:
        """éªŒè¯é¡¹ç›®æ•°æ®å®Œæ•´æ€§"""
        errors = []
        
        # æ£€æŸ¥å¿…å¡«å­—æ®µ
        if not project.project_id:
            errors.append("Project ID is required")
        if not project.project_name:
            errors.append("Project name is required")
        
        # æ£€æŸ¥å…ƒç´ å¼•ç”¨
        element_ids = {e.element_id for e in project.building_elements}
        for space in project.spaces:
            for elem_id in space.elements:
                if elem_id not in element_ids:
                    errors.append(f"Space {space.space_id} references unknown element: {elem_id}")
        
        # æ£€æŸ¥ææ–™å¼•ç”¨
        material_ids = {m.material_id for m in project.materials}
        for element in project.building_elements:
            if element.material and element.material.material_id not in material_ids:
                errors.append(f"Element {element.element_id} references unknown material")
        
        return errors


# ============================================================
# å®é™…ä¸šåŠ¡åœºæ™¯å®ç°
# ============================================================

def create_office_building_project() -> BIMProject:
    """
    åˆ›å»ºåŠå…¬æ¥¼é¡¹ç›®ç¤ºä¾‹
    è¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„BIMé¡¹ç›®åˆ›å»ºç¤ºä¾‹ï¼ŒåŒ…å«å¤šç§å»ºç­‘å…ƒç´ ã€ç©ºé—´å’Œææ–™
    """
    
    # åˆ›å»ºSchemaç®¡ç†å™¨
    manager = BIMSchemaManager()
    
    # åˆ›å»ºé¡¹ç›®
    project = manager.create_project(
        project_id="PROJ-2025-OFFICE-001",
        project_name="æ™ºæ…§åŠå…¬å¤§å¦Aåº§",
        description="ä½äºå¸‚ä¸­å¿ƒçš„28å±‚æ™ºæ…§åŠå…¬å»ºç­‘ï¼Œæ€»å»ºç­‘é¢ç§¯85000å¹³æ–¹ç±³",
        status=ProjectStatus.DESIGN,
        start_date=date(2025, 1, 1),
        end_date=date(2027, 12, 31)
    )
    
    # æ·»åŠ ææ–™åº“
    materials = [
        Material(
            material_id="MAT-CONC-C30",
            name="C30æ··å‡åœŸ",
            material_type=MaterialType.CONCRETE,
            density=2400.0,
            thermal_conductivity=1.51,
            specific_heat=920.0,
            strength=30.0,
            cost_per_unit=0.45
        ),
        Material(
            material_id="MAT-STEEL-HRB400",
            name="HRB400é’¢ç­‹",
            material_type=MaterialType.STEEL,
            density=7850.0,
            thermal_conductivity=50.0,
            specific_heat=460.0,
            strength=400.0,
            cost_per_unit=3.8
        ),
        Material(
            material_id="MAT-GLASS-LOWE",
            name="Low-Eä¸­ç©ºç»ç’ƒ",
            material_type=MaterialType.GLASS,
            density=2500.0,
            thermal_conductivity=0.8,
            specific_heat=840.0,
            strength=120.0,
            cost_per_unit=12.5
        ),
        Material(
            material_id="MAT-INSUL-XPS",
            name="XPSä¿æ¸©æ¿",
            material_type=MaterialType.INSULATION,
            density=35.0,
            thermal_conductivity=0.03,
            specific_heat=1400.0,
            strength=0.3,
            cost_per_unit=8.0
        )
    ]
    
    for mat in materials:
        project.add_material(mat)
        manager.add_material_to_library(mat)
    
    # åˆ›å»ºæ¥¼å±‚
    for i in range(1, 29):
        floor = Floor(
            floor_id=f"FLOOR-{i:02d}",
            name=f"ç¬¬{i}å±‚" if i > 1 else "é¦–å±‚",
            elevation=(i - 1) * 4.2,
            height=4.2 if i > 1 else 5.5,
            area=3035.7
        )
        project.add_floor(floor)
    
    # åˆ›å»ºç©ºé—´ï¼ˆæ¯å±‚2ä¸ªæ ‡å‡†åŠå…¬åŒºï¼‰
    for floor_idx in range(1, 29):
        floor_id = f"FLOOR-{floor_idx:02d}"
        for area_idx in range(1, 3):
            space = Space(
                space_id=f"SPACE-{floor_idx:02d}-{area_idx:02d}",
                name=f"{floor_id}-åŠå…¬åŒº{area_idx}",
                space_type="Office",
                long_name=f"ç¬¬{floor_idx}å±‚åŠå…¬åŒº{area_idx}",
                description="æ ‡å‡†å¼€æ”¾å¼åŠå…¬åŒºåŸŸ",
                geometry=Geometry(
                    placement=Point3D(x=(area_idx-1)*35, y=0, z=(floor_idx-1)*4.2),
                    dimensions=Dimensions(length=35, width=43.37, height=4.2)
                ),
                floor=floor_id,
                elevation=(floor_idx - 1) * 4.2,
                height=4.2,
                area=1517.85,
                volume=6374.97
            )
            project.add_space(space)
    
    # åˆ›å»ºå»ºç­‘å…ƒç´ ç¤ºä¾‹ï¼ˆå¤–å¢™ï¼‰
    for floor_idx in range(1, 29):
        # ä¸œä¾§å¤–å¢™
        wall_east = BuildingElement(
            element_id=f"WALL-E-{floor_idx:02d}",
            element_type=ElementType.WALL,
            global_id=str(uuid.uuid4()),
            name=f"ç¬¬{floor_idx}å±‚ä¸œä¾§å¤–å¢™",
            description="é’¢ç­‹æ··å‡åœŸå¤–å¢™ï¼Œå¸¦Low-Eä¸­ç©ºç»ç’ƒå¹•å¢™",
            tag=f"W-E-{floor_idx:02d}",
            geometry=Geometry(
                placement=Point3D(x=0, y=0, z=(floor_idx-1)*4.2),
                dimensions=Dimensions(length=86.74, height=4.2, thickness=0.3),
                representation_type="SweptSolid"
            ),
            material=manager.get_material_from_library("MAT-CONC-C30"),
            properties={
                "fire_rating": "2å°æ—¶",
                "sound_insulation": "45dB",
                "thermal_resistance": "3.5 mÂ²Â·K/W"
            }
        )
        project.add_element(wall_east)
        
        # å—ä¾§ç»ç’ƒå¹•å¢™
        if floor_idx > 1:  # é¦–å±‚ä¸ºå…¥å£å¤§å…ï¼Œæ— æ ‡å‡†å¹•å¢™
            curtain_wall = BuildingElement(
                element_id=f"WALL-S-GLASS-{floor_idx:02d}",
                element_type=ElementType.WALL,
                global_id=str(uuid.uuid4()),
                name=f"ç¬¬{floor_idx}å±‚å—ä¾§ç»ç’ƒå¹•å¢™",
                description="Low-Eä¸­ç©ºç»ç’ƒå¹•å¢™ç³»ç»Ÿ",
                tag=f"CW-S-{floor_idx:02d}",
                geometry=Geometry(
                    placement=Point3D(x=0, y=43.37, z=(floor_idx-1)*4.2),
                    dimensions=Dimensions(length=70, height=3.6, thickness=0.05),
                    representation_type="BRep"
                ),
                material=manager.get_material_from_library("MAT-GLASS-LOWE"),
                properties={
                    "u_value": "1.8 W/(mÂ²Â·K)",
                    "shgc": "0.35",
                    "light_transmittance": "0.72"
                }
            )
            project.add_element(curtain_wall)
    
    # åˆ›å»ºç»“æ„æŸ±
    for floor_idx in range(1, 29):
        for col_idx in range(1, 17):  # æ¯å±‚16æ ¹æŸ±å­
            column = BuildingElement(
                element_id=f"COL-{floor_idx:02d}-{col_idx:02d}",
                element_type=ElementType.COLUMN,
                global_id=str(uuid.uuid4()),
                name=f"ç¬¬{floor_idx}å±‚ç»“æ„æŸ±{col_idx}",
                description="C30é’¢ç­‹æ··å‡åœŸæŸ±",
                tag=f"C-{floor_idx:02d}-{col_idx:02d}",
                geometry=Geometry(
                    placement=Point3D(x=(col_idx % 4) * 21.685, y=(col_idx // 4) * 14.457, z=(floor_idx-1)*4.2),
                    dimensions=Dimensions(length=0.8, width=0.8, height=4.2),
                    representation_type="SweptSolid"
                ),
                material=manager.get_material_from_library("MAT-CONC-C30"),
                properties={
                    "load_capacity": "8000 kN",
                    "reinforcement_ratio": "1.5%"
                }
            )
            project.add_element(column)
    
    # éªŒè¯é¡¹ç›®
    errors = manager.validate_project(project)
    if errors:
        logger.warning(f"Project validation warnings: {errors}")
    else:
        logger.info("Project validation passed")
    
    return project


def generate_cobie_data(project: BIMProject) -> Dict:
    """
    ç”ŸæˆCOBieæ ¼å¼çš„äº¤ä»˜æ•°æ®
    COBie (Construction Operations Building Information Exchange)
    æ˜¯è®¾æ–½ç®¡ç†é˜¶æ®µçš„æ ‡å‡†æ•°æ®äº¤æ¢æ ¼å¼
    """
    
    cobie_data = {
        "version": "2.4",
        "generated_date": datetime.now().isoformat(),
        "project_info": {
            "project_id": project.project_id,
            "project_name": project.project_name,
            "description": project.description
        },
        "sheets": {}
    }
    
    # Contact è¡¨
    cobie_data["sheets"]["Contact"] = [
        {
            "Email": "architect@example.com",
            "CreatedBy": "System",
            "CreatedOn": datetime.now().strftime("%Y-%m-%d"),
            "Category": "Architect",
            "Company": "ä¸­å»ºè®¾è®¡é™¢",
            "Phone": "+86-10-12345678"
        },
        {
            "Email": "contractor@example.com", 
            "CreatedBy": "System",
            "CreatedOn": datetime.now().strftime("%Y-%m-%d"),
            "Category": "Contractor",
            "Company": "ä¸­å»ºæ–½å·¥å•ä½",
            "Phone": "+86-10-87654321"
        }
    ]
    
    # Facility è¡¨
    cobie_data["sheets"]["Facility"] = [
        {
            "Name": project.project_name,
            "CreatedBy": "architect@example.com",
            "CreatedOn": project.created_at.strftime("%Y-%m-%d"),
            "Category": "Office Building",
            "ProjectName": project.project_name,
            "SiteName": "å¸‚ä¸­å¿ƒå•†åŠ¡åŒº",
            "LinearUnits": "Meters",
            "AreaUnits": "SquareMeters",
            "VolumeUnits": "CubicMeters",
            "CurrencyUnit": "CNY"
        }
    ]
    
    # Floor è¡¨
    cobie_data["sheets"]["Floor"] = [
        {
            "Name": floor.name,
            "CreatedBy": "architect@example.com",
            "CreatedOn": datetime.now().strftime("%Y-%m-%d"),
            "Category": "Level",
            "Elevation": floor.elevation,
            "Height": floor.height
        }
        for floor in project.floors[:5]  # åªå–å‰5å±‚ä½œä¸ºç¤ºä¾‹
    ]
    
    # Space è¡¨
    cobie_data["sheets"]["Space"] = [
        {
            "Name": space.name,
            "CreatedBy": "architect@example.com",
            "CreatedOn": datetime.now().strftime("%Y-%m-%d"),
            "Category": space.space_type,
            "FloorName": space.floor,
            "Description": space.description,
            "GrossArea": space.area,
            "NetArea": space.area * 0.85  # å‡è®¾å‡€é¢ç§¯ä¸º85%
        }
        for space in project.spaces[:10]  # åªå–å‰10ä¸ªç©ºé—´ä½œä¸ºç¤ºä¾‹
    ]
    
    # Type è¡¨
    type_map = {}
    for element in project.building_elements[:20]:  # åªå–å‰20ä¸ªå…ƒç´ 
        type_name = element.element_type.value
        if type_name not in type_map:
            type_map[type_name] = {
                "Name": f"{type_name}-Type-01",
                "CreatedBy": "architect@example.com",
                "CreatedOn": datetime.now().strftime("%Y-%m-%d"),
                "Category": type_name,
                "Description": f"Standard {type_name}",
                "Manufacturer": element.material.name if element.material else "Unknown"
            }
    cobie_data["sheets"]["Type"] = list(type_map.values())
    
    # Component è¡¨
    cobie_data["sheets"]["Component"] = [
        {
            "Name": element.name,
            "CreatedBy": "architect@example.com",
            "CreatedOn": datetime.now().strftime("%Y-%m-%d"),
            "TypeName": element.element_type.value,
            "Space": element.properties.get("space", ""),
            "Description": element.description,
            "TagNumber": element.tag,
            "InstallationDate": (project.start_date or date.today()).strftime("%Y-%m-%d")
        }
        for element in project.building_elements[:20]
    ]
    
    logger.info(f"Generated COBie data with {len(cobie_data['sheets'])} sheets")
    return cobie_data


def analyze_energy_performance(project: BIMProject) -> Dict:
    """
    åˆ†æå»ºç­‘èƒ½è€—æ€§èƒ½
    åŸºäºgbXMLæ ‡å‡†çš„èƒ½è€—åˆ†æ
    """
    
    # è®¡ç®—å»ºç­‘å¤–å£³çƒ­å·¥æ€§èƒ½
    exterior_walls = [e for e in project.building_elements 
                      if e.element_type == ElementType.WALL]
    
    total_wall_area = 0
    total_u_value_area_product = 0
    
    for wall in exterior_walls:
        area = wall.geometry.dimensions.length * wall.geometry.dimensions.height
        total_wall_area += area
        
        # ç®€åŒ–çš„Uå€¼è®¡ç®—
        if wall.material:
            thickness = wall.geometry.dimensions.thickness
            conductivity = wall.material.thermal_conductivity
            u_value = conductivity / thickness if thickness > 0 else 0.5
            total_u_value_area_product += u_value * area
    
    average_u_value = (total_u_value_area_product / total_wall_area 
                       if total_wall_area > 0 else 0)
    
    # ä¼°ç®—å»ºç­‘èƒ½è€—
    total_area = sum(s.area for s in project.spaces)
    total_volume = sum(s.volume for s in project.spaces)
    
    # ç®€åŒ–çš„èƒ½è€—ä¼°ç®—æ¨¡å‹
    # å‡è®¾ï¼šç©ºè°ƒèƒ½è€— = ä½“ç§¯ Ã— æ¢æ°”æ¬¡æ•° Ã— æ¸©å·® Ã— æ—¶é—´ Ã— èƒ½æ•ˆç³»æ•°
    air_changes_per_hour = 6  # åŠå…¬å»ºç­‘æ ‡å‡†
    temp_diff = 15  # å®¤å†…å¤–æ¸©å·® (Â°C)
    operating_hours = 2500  # å¹´è¿è¡Œå°æ—¶
    cop = 3.0  # åˆ¶å†·æ€§èƒ½ç³»æ•°
    
    hvac_energy = (total_volume * air_changes_per_hour * temp_diff * 
                   operating_hours * 1.2 * 1005 / (3600 * cop * 1000))  # kWh
    
    # ç…§æ˜èƒ½è€—ä¼°ç®—
    lighting_power_density = 12  # W/mÂ² (åŠå…¬å»ºç­‘æ ‡å‡†)
    lighting_energy = total_area * lighting_power_density * operating_hours / 1000  # kWh
    
    # è®¾å¤‡èƒ½è€—ä¼°ç®—
    equipment_power_density = 15  # W/mÂ²
    equipment_energy = total_area * equipment_power_density * operating_hours / 1000  # kWh
    
    total_energy = hvac_energy + lighting_energy + equipment_energy
    
    analysis_result = {
        "building_id": project.project_id,
        "analysis_date": datetime.now().isoformat(),
        "envelope_performance": {
            "total_exterior_wall_area": round(total_wall_area, 2),
            "average_wall_u_value": round(average_u_value, 3),
            "wall_performance_rating": "Good" if average_u_value < 0.5 else "Fair"
        },
        "energy_consumption": {
            "hvac": round(hvac_energy, 2),
            "lighting": round(lighting_energy, 2),
            "equipment": round(equipment_energy, 2),
            "total": round(total_energy, 2)
        },
        "energy_metrics": {
            "consumption_per_area": round(total_energy / total_area, 2) if total_area > 0 else 0,
            "consumption_per_volume": round(total_energy / total_volume, 2) if total_volume > 0 else 0
        },
        "optimization_suggestions": [
            "å»ºè®®æé«˜å¤–å¢™ä¿æ¸©æ€§èƒ½è‡³Uå€¼<0.4 W/(mÂ²Â·K)",
            "è€ƒè™‘é‡‡ç”¨LEDç…§æ˜ç³»ç»Ÿé™ä½ç…§æ˜èƒ½è€—30%",
            "ä¼˜åŒ–ç©ºè°ƒç³»ç»Ÿè¿è¡Œç­–ç•¥ï¼Œé‡‡ç”¨å˜é¢‘æŠ€æœ¯"
        ]
    }
    
    logger.info(f"Energy analysis completed. Total consumption: {total_energy:.2f} kWh")
    return analysis_result


def main():
    """
    ä¸»å‡½æ•° - æ¼”ç¤ºå®Œæ•´çš„BIM Schemaåº”ç”¨æµç¨‹
    """
    print("=" * 80)
    print("BIM Schemaå®è·µæ¡ˆä¾‹ - ä¸­å»ºæ•°å­—ç§‘æŠ€é›†å›¢")
    print("æ™ºæ…§åŠå…¬å¤§å¦Aåº§é¡¹ç›®")
    print("=" * 80)
    
    # æ­¥éª¤1ï¼šåˆ›å»ºé¡¹ç›®
    print("\nã€æ­¥éª¤1ã€‘åˆ›å»ºBIMé¡¹ç›®...")
    project = create_office_building_project()
    
    # æ­¥éª¤2ï¼šæ˜¾ç¤ºé¡¹ç›®ç»Ÿè®¡
    print("\nã€æ­¥éª¤2ã€‘é¡¹ç›®ç»Ÿè®¡ä¿¡æ¯ï¼š")
    stats = project.get_statistics()
    for key, value in stats.items():
        print(f"  {key}: {value}")
    
    # æ­¥éª¤3ï¼šå¯¼å‡ºé¡¹ç›®æ•°æ®
    print("\nã€æ­¥éª¤3ã€‘å¯¼å‡ºé¡¹ç›®æ•°æ®...")
    project.export_to_json("office_building_project.json")
    
    # æ­¥éª¤4ï¼šç”ŸæˆCOBieæ•°æ®
    print("\nã€æ­¥éª¤4ã€‘ç”ŸæˆCOBieäº¤ä»˜æ•°æ®...")
    cobie_data = generate_cobie_data(project)
    with open("cobie_export.json", 'w', encoding='utf-8') as f:
        json.dump(cobie_data, f, ensure_ascii=False, indent=2)
    print(f"  COBieè¡¨æ•°é‡: {len(cobie_data['sheets'])}")
    for sheet_name in cobie_data['sheets']:
        print(f"    - {sheet_name}: {len(cobie_data['sheets'][sheet_name])} æ¡è®°å½•")
    
    # æ­¥éª¤5ï¼šèƒ½è€—åˆ†æ
    print("\nã€æ­¥éª¤5ã€‘å»ºç­‘èƒ½è€—åˆ†æ...")
    energy_analysis = analyze_energy_performance(project)
    print(f"  æ€»èƒ½è€—: {energy_analysis['energy_consumption']['total']:,.2f} kWh/å¹´")
    print(f"  å•ä½é¢ç§¯èƒ½è€—: {energy_analysis['energy_metrics']['consumption_per_area']:.2f} kWh/mÂ²/å¹´")
    print(f"  å¤–å¢™å¹³å‡Uå€¼: {energy_analysis['envelope_performance']['average_wall_u_value']:.3f} W/(mÂ²Â·K)")
    print("\n  ä¼˜åŒ–å»ºè®®ï¼š")
    for suggestion in energy_analysis['optimization_suggestions']:
        print(f"    - {suggestion}")
    
    # æ­¥éª¤6ï¼šè®¡ç®—é¡¹ç›®æˆæœ¬
    print("\nã€æ­¥éª¤6ã€‘é¡¹ç›®æˆæœ¬ä¼°ç®—...")
    total_cost = project.get_total_cost()
    print(f"  ä¼°ç®—æ€»æˆæœ¬: Â¥{total_cost:,.2f}")
    
    print("\n" + "=" * 80)
    print("BIM Schemaå®è·µæ¡ˆä¾‹æ‰§è¡Œå®Œæˆ")
    print("=" * 80)
    
    return project


if __name__ == "__main__":
    main()
```

---

## 7. æ•ˆæœè¯„ä¼°ä¸ROIåˆ†æ

### 7.1 å…³é”®ç»©æ•ˆæŒ‡æ ‡(KPI)

| æŒ‡æ ‡ç±»åˆ« | æŒ‡æ ‡åç§° | å®æ–½å‰ | å®æ–½å | æ”¹å–„å¹…åº¦ |
|----------|----------|--------|--------|----------|
| **æ•ˆç‡æŒ‡æ ‡** | è®¾è®¡å˜æ›´å“åº”æ—¶é—´ | 5å¤© | 4å°æ—¶ | -95% |
| | COBieæ•°æ®ç”Ÿæˆæ—¶é—´ | 2å‘¨ | 2å°æ—¶ | -98% |
| | å¤šä¸“ä¸šååŒæ•ˆç‡ | 60% | 95% | +58% |
| **è´¨é‡æŒ‡æ ‡** | è®¾è®¡é”™è¯¯ç‡ | 8% | 1.5% | -81% |
| | æ•°æ®ä¸€è‡´æ€§ | 75% | 99% | +32% |
| | æ ‡å‡†åˆè§„ç‡ | 70% | 100% | +43% |
| **æˆæœ¬æŒ‡æ ‡** | è¿”å·¥æˆæœ¬å æ¯” | 12% | 3% | -75% |
| | ææ–™ä¼°ç®—ç²¾åº¦ | Â±15% | Â±3% | +80% |
| | è¿ç»´æˆæœ¬ | åŸºå‡† | -20% | -20% |

### 7.2 ROIè®¡ç®—

**æŠ•èµ„æˆæœ¬ï¼ˆ3å¹´æœŸï¼‰**ï¼š
- è½¯ä»¶è®¸å¯ä¸å®šåˆ¶å¼€å‘ï¼šÂ¥480ä¸‡
- ç¡¬ä»¶åŸºç¡€è®¾æ–½ï¼šÂ¥220ä¸‡
- äººå‘˜åŸ¹è®­ä¸å’¨è¯¢ï¼šÂ¥150ä¸‡
- **æ€»æŠ•èµ„**ï¼šÂ¥850ä¸‡

**æ”¶ç›Šè®¡ç®—ï¼ˆå¹´åŒ–ï¼‰**ï¼š
- è®¾è®¡æ•ˆç‡æå‡èŠ‚çœï¼šÂ¥320ä¸‡/å¹´
- å‡å°‘è¿”å·¥èŠ‚çœï¼šÂ¥280ä¸‡/å¹´
- è¿ç»´æˆæœ¬é™ä½ï¼šÂ¥150ä¸‡/å¹´
- **å¹´åº¦æ€»æ”¶ç›Š**ï¼šÂ¥750ä¸‡

**ROIåˆ†æ**ï¼š
```
æŠ•èµ„å›æ”¶æœŸ = æ€»æŠ•èµ„ / å¹´åº¦æ”¶ç›Š = 850 / 750 = 1.13å¹´ï¼ˆçº¦13.6ä¸ªæœˆï¼‰

3å¹´ROI = (750 Ã— 3 - 850) / 850 Ã— 100% = 164.7%

5å¹´NPVï¼ˆæŠ˜ç°ç‡10%ï¼‰= Â¥1,987ä¸‡
```

### 7.3 å®šæ€§æ”¶ç›Š

1. **å“ç‰Œä»·å€¼æå‡**ï¼šè·å¾—LEEDé‡‘çº§è®¤è¯ï¼Œæå‡ä¼ä¸šç»¿è‰²å½¢è±¡
2. **å®¢æˆ·æ»¡æ„åº¦**ï¼šé¡¹ç›®äº¤ä»˜å‡†æ—¶ç‡ä»75%æå‡è‡³98%
3. **äººæ‰å¸å¼•åŠ›**ï¼šæ•°å­—åŒ–èƒ½åŠ›æˆä¸ºæ‹›è˜ä¼˜åŠ¿
4. **è¡Œä¸šå½±å“åŠ›**ï¼šæˆä¸ºBIMæ ‡å‡†åˆ¶å®šçš„å‚ä¸è€…

---

## 8. è¯¦ç»†æ¡ˆä¾‹å®ç°

### 8.1 æ¡ˆä¾‹1ï¼šå»ºç­‘è®¾è®¡ç®¡ç†

**åœºæ™¯æè¿°**ï¼š
å»ºç­‘è®¾è®¡å…¬å¸éœ€è¦ç®¡ç†å»ºç­‘é¡¹ç›®çš„è®¾è®¡æ•°æ®ï¼ŒåŒ…æ‹¬å»ºç­‘å…ƒç´ ã€ç©ºé—´å®šä¹‰ã€ææ–™å±æ€§ç­‰ï¼Œç¡®ä¿è®¾è®¡æ•°æ®çš„ä¸€è‡´æ€§å’Œå¯è¿½æº¯æ€§ã€‚

**å®ç°è¦ç‚¹**ï¼š
- ä½¿ç”¨BIM_Schemaå®šä¹‰å»ºç­‘è®¾è®¡æ•°æ®ç»“æ„
- å®ç°å»ºç­‘å…ƒç´ çš„åˆ›å»ºã€ç©ºé—´çš„å®šä¹‰ã€ææ–™çš„ç®¡ç†
- æ”¯æŒIFCæ ‡å‡†æ•°æ®æ ¼å¼

**ä»£ç å®ç°**ï¼š
```python
# è¯¦è§ä¸Šæ–¹å®Œæ•´ä»£ç ä¸­çš„create_office_building_projectå‡½æ•°
```

### 8.2 æ¡ˆä¾‹2ï¼šCOBieæ•°æ®ç”Ÿæˆ

**åœºæ™¯æè¿°**ï¼š
å»ºç­‘äº¤ä»˜ç»™è¿è¥æ–¹æ—¶ï¼Œéœ€è¦ç”ŸæˆCOBieæ ¼å¼çš„æ•°æ®ï¼ŒåŒ…å«è®¾å¤‡æ¸…å•ã€ç»´æŠ¤ä¿¡æ¯ã€ç©ºé—´ä¿¡æ¯ç­‰ï¼Œä»¥ä¾¿è¿è¥æ–¹è¿›è¡Œè®¾æ–½ç®¡ç†ã€‚

**å®ç°è¦ç‚¹**ï¼š
- ä»IFCæ¨¡å‹ä¸­æå–è¿è¥ç›¸å…³ä¿¡æ¯
- ç”Ÿæˆç¬¦åˆCOBieæ ‡å‡†çš„Excelæ–‡ä»¶
- åŒ…å«è®¾å¤‡ã€ç©ºé—´ã€ç³»ç»Ÿã€æ–‡æ¡£ç­‰ä¿¡æ¯

**ä»£ç å®ç°**ï¼š
```python
# è¯¦è§ä¸Šæ–¹å®Œæ•´ä»£ç ä¸­çš„generate_cobie_dataå‡½æ•°
```

### 8.3 æ¡ˆä¾‹3ï¼šèƒ½è€—åˆ†æ

**åœºæ™¯æè¿°**ï¼š
å»ºç­‘è®¾è®¡å…¬å¸éœ€è¦è¿›è¡Œå»ºç­‘èƒ½è€—åˆ†æï¼Œè¯„ä¼°å»ºç­‘çš„èƒ½æºæ€§èƒ½ï¼Œä¼˜åŒ–å»ºç­‘è®¾è®¡æ–¹æ¡ˆã€‚

**å®ç°è¦ç‚¹**ï¼š
- ä»IFCæ¨¡å‹ç”ŸæˆgbXMLæ–‡ä»¶
- å®šä¹‰å»ºç­‘çš„çƒ­å·¥å‚æ•°
- ä¸èƒ½è€—åˆ†æè½¯ä»¶é›†æˆ

**ä»£ç å®ç°**ï¼š
```python
# è¯¦è§ä¸Šæ–¹å®Œæ•´ä»£ç ä¸­çš„analyze_energy_performanceå‡½æ•°
```

---

**å‚è€ƒæ–‡æ¡£**ï¼š
- `01_Overview.md` - æ¦‚è¿°
- `02_Formal_Definition.md` - å½¢å¼åŒ–å®šä¹‰
- `03_Standards.md` - æ ‡å‡†å¯¹æ ‡
- `04_Transformation.md` - è½¬æ¢ä½“ç³»

---

**åˆ›å»ºæ—¶é—´**ï¼š2025-01-21  
**æœ€åæ›´æ–°**ï¼š2026-02-15  
**ç‰ˆæœ¬**ï¼š2.0.0
