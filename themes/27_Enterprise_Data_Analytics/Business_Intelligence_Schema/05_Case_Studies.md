# å•†ä¸šæ™ºèƒ½Schemaå®è·µæ¡ˆä¾‹

## ğŸ“‘ ç›®å½•

- [å•†ä¸šæ™ºèƒ½Schemaå®è·µæ¡ˆä¾‹](#å•†ä¸šæ™ºèƒ½schemaå®è·µæ¡ˆä¾‹)
  - [ğŸ“‘ ç›®å½•](#-ç›®å½•)
  - [1. æ¡ˆä¾‹æ¦‚è¿°](#1-æ¡ˆä¾‹æ¦‚è¿°)
  - [2. æ¡ˆä¾‹1ï¼šè·¨å›½åˆ¶é€ ä¼ä¸šå…¨çƒè¿è¥åˆ†æå¹³å°](#2-æ¡ˆä¾‹1è·¨å›½åˆ¶é€ ä¼ä¸šå…¨çƒè¿è¥åˆ†æå¹³å°)
    - [2.1 ä¼ä¸šèƒŒæ™¯](#21-ä¼ä¸šèƒŒæ™¯)
    - [2.2 ä¸šåŠ¡ç—›ç‚¹](#22-ä¸šåŠ¡ç—›ç‚¹)
    - [2.3 ä¸šåŠ¡ç›®æ ‡](#23-ä¸šåŠ¡ç›®æ ‡)
    - [2.4 æŠ€æœ¯æŒ‘æˆ˜](#24-æŠ€æœ¯æŒ‘æˆ˜)
    - [2.5 è§£å†³æ–¹æ¡ˆ](#25-è§£å†³æ–¹æ¡ˆ)
    - [2.6 å®Œæ•´ä»£ç å®ç°](#26-å®Œæ•´ä»£ç å®ç°)
    - [2.7 æ•ˆæœè¯„ä¼°ä¸ROIåˆ†æ](#27-æ•ˆæœè¯„ä¼°ä¸roiåˆ†æ)
  - [3. æ¡ˆä¾‹2ï¼šè‡ªåŠ©å¼åˆ†æå¹³å°](#3-æ¡ˆä¾‹2è‡ªåŠ©å¼åˆ†æå¹³å°)
  - [4. æ¡ˆä¾‹3ï¼šç§»åŠ¨ç«¯ç®¡ç†é©¾é©¶èˆ±](#4-æ¡ˆä¾‹3ç§»åŠ¨ç«¯ç®¡ç†é©¾é©¶èˆ±)

---

## 1. æ¡ˆä¾‹æ¦‚è¿°

æœ¬æ–‡æ¡£æä¾›å•†ä¸šæ™ºèƒ½Schemaåœ¨å®é™…ä¼ä¸šåº”ç”¨ä¸­çš„æ·±åº¦å®è·µæ¡ˆä¾‹ï¼Œæ¶µç›–å…¨çƒè¿è¥åˆ†æã€è‡ªåŠ©å¼BIã€ç§»åŠ¨é©¾é©¶èˆ±ç­‰ä¼ä¸šçº§åœºæ™¯ã€‚

---

## 2. æ¡ˆä¾‹1ï¼šè·¨å›½åˆ¶é€ ä¼ä¸šå…¨çƒè¿è¥åˆ†æå¹³å°

### 2.1 ä¼ä¸šèƒŒæ™¯

**ä¼ä¸šç®€ä»‹**ï¼š
æŸè·¨å›½åˆ¶é€ é›†å›¢ï¼ˆä»¥ä¸‹ç®€ç§°"åæ™ºåˆ¶é€ "ï¼‰æˆç«‹äº1985å¹´ï¼Œæ˜¯å…¨çƒé¢†å…ˆçš„æ™ºèƒ½åˆ¶é€ è§£å†³æ–¹æ¡ˆæä¾›å•†ã€‚é›†å›¢åœ¨å…¨çƒæ‹¥æœ‰12ä¸ªç”Ÿäº§åŸºåœ°ã€50ä¸ªé”€å”®å­å…¬å¸ï¼Œå‘˜å·¥æ€»æ•°è¶…è¿‡8ä¸‡äººï¼Œå¹´è¥æ”¶è¶…è¿‡800äº¿å…ƒäººæ°‘å¸ã€‚

**ä¸šåŠ¡è§„æ¨¡**ï¼š

| æŒ‡æ ‡ | æ•°å€¼ |
|------|------|
| ç”Ÿäº§åŸºåœ° | 12ä¸ªï¼ˆ6ä¸ªå›½å®¶ï¼‰ |
| é”€å”®å­å…¬å¸ | 50ä¸ªï¼ˆ30ä¸ªå›½å®¶ï¼‰ |
| å¹´è¥æ”¶ | 800äº¿+ RMB |
| äº§å“SKU | 5000+ |
| å¹´è®¢å•é‡ | 200ä¸‡+ |
| ä¾›åº”å•† | 2000+ |
| å®¢æˆ·æ•° | 10ä¸‡+ |

### 2.2 ä¸šåŠ¡ç—›ç‚¹

**ç—›ç‚¹1ï¼šæ•°æ®å­¤å²›ä¸¥é‡**
å„åŒºåŸŸã€å„ä¸šåŠ¡ç³»ç»Ÿæ•°æ®åˆ†æ•£ï¼Œå…¨çƒè¿è¥æ•°æ®æ— æ³•ç»Ÿä¸€è§†å›¾ï¼Œæ€»éƒ¨éš¾ä»¥å®æ—¶æŒæ¡æ•´ä½“è¿è¥çŠ¶å†µã€‚

**ç—›ç‚¹2ï¼šæŠ¥è¡¨æ»å**
æœˆåº¦ç»è¥åˆ†ææŠ¥å‘Šéœ€è¦15ä¸ªå·¥ä½œæ—¥æ‰èƒ½å‡ºå…·ï¼Œå†³ç­–ä¸¥é‡æ»åï¼Œé”™å¤±å¸‚åœºæœºä¼šã€‚

**ç—›ç‚¹3ï¼šå¤šå¸ç§å¤šè¯­è¨€**
æ¶‰åŠ30ä¸ªå›½å®¶ã€20ç§è´§å¸ã€10ç§è¯­è¨€ï¼Œæ•°æ®æ•´åˆå’Œå±•ç¤ºå¤æ‚åº¦é«˜ã€‚

**ç—›ç‚¹4ï¼šç¼ºä¹é¢„è­¦æœºåˆ¶**
å…³é”®æŒ‡æ ‡å¼‚å¸¸æ— æ³•åŠæ—¶å‘ç°ï¼Œä¾›åº”é“¾ä¸­æ–­ã€è´¨é‡é—®é¢˜ç­‰é£é™©å“åº”è¿Ÿç¼“ã€‚

**ç—›ç‚¹5ï¼šå†³ç­–æ”¯æŒä¸è¶³**
ç®¡ç†å±‚éœ€è¦ç»¼åˆåˆ†æå¤šç»´åº¦æ•°æ®ï¼Œä½†ç°æœ‰å·¥å…·æ— æ³•æä¾›æ·±åº¦æ´å¯Ÿå’Œæ™ºèƒ½å»ºè®®ã€‚

### 2.3 ä¸šåŠ¡ç›®æ ‡

- å»ºç«‹å…¨çƒç»Ÿä¸€æ•°æ®è§†å›¾ï¼Œæ”¯æŒå¤šå¸ç§å¤šè¯­è¨€
- å®ç°T+1çš„æŠ¥è¡¨å‡ºå…·æ—¶æ•ˆ
- å»ºç«‹æ™ºèƒ½é¢„è­¦ä½“ç³»ï¼Œé£é™©å“åº”æ—¶é—´ç¼©çŸ­80%
- æ”¯æŒå¤šç»´åº¦è‡ªåŠ©åˆ†æï¼Œé™ä½ITä¾èµ–

### 2.4 æŠ€æœ¯æŒ‘æˆ˜

1. å¤šæºå¼‚æ„æ•°æ®æ•´åˆï¼ˆERPã€MESã€CRMã€SCMç­‰ï¼‰
2. å…¨çƒç½‘ç»œå»¶è¿Ÿå’Œæ•°æ®åŒæ­¥
3. å¤§æ•°æ®é‡é«˜æ€§èƒ½æŸ¥è¯¢
4. å¤æ‚æƒé™ç®¡ç†ï¼ˆæ•°æ®éš”ç¦»ï¼‰
5. å¤šç»ˆç«¯é€‚é…ï¼ˆPCã€å¹³æ¿ã€æ‰‹æœºï¼‰

### 2.5 è§£å†³æ–¹æ¡ˆ

é‡‡ç”¨äº‘åŸç”ŸBIæ¶æ„ï¼Œæ ¸å¿ƒç»„ä»¶ï¼š
- æ•°æ®å±‚ï¼šSnowflakeäº‘æ•°æ®ä»“åº“
- å»ºæ¨¡å±‚ï¼šdbtæ•°æ®è½¬æ¢
- BIå¼•æ“ï¼šPower BI + è‡ªç ”åˆ†æå¼•æ“
- ç§»åŠ¨ç«¯ï¼šè‡ªç ”ç®¡ç†é©¾é©¶èˆ±App

### 2.6 å®Œæ•´ä»£ç å®ç°

```python
#!/usr/bin/env python3
"""
è·¨å›½åˆ¶é€ ä¼ä¸šå…¨çƒè¿è¥åˆ†æå¹³å°
æ”¯æŒå¤šå¸ç§ã€å¤šè¯­è¨€ã€å¤šç»„ç»‡çš„ä¼ä¸šçº§BIç³»ç»Ÿ
"""

from typing import Dict, List, Optional, Any
from dataclasses import dataclass, field
from enum import Enum
from decimal import Decimal
from datetime import datetime
import json


class ChartType(str, Enum):
    """å›¾è¡¨ç±»å‹"""
    KPI_CARD = "KPICard"
    LINE_CHART = "LineChart"
    BAR_CHART = "BarChart"
    PIE_CHART = "PieChart"
    TABLE = "Table"
    MAP = "Map"
    GAUGE = "Gauge"
    TREEMAP = "Treemap"
    WATERFALL = "Waterfall"


class CurrencyCode(str, Enum):
    """è´§å¸ä»£ç """
    CNY = "CNY"
    USD = "USD"
    EUR = "EUR"
    JPY = "JPY"
    GBP = "GBP"


@dataclass
class CurrencyRate:
    """æ±‡ç‡"""
    from_currency: CurrencyCode
    to_currency: CurrencyCode
    rate: Decimal
    effective_date: datetime


@dataclass
class KPIIndicator:
    """KPIæŒ‡æ ‡"""
    kpi_id: str
    kpi_name: str
    kpi_name_localized: Dict[str, str]  # å¤šè¯­è¨€åç§°
    value: Decimal
    target: Decimal
    unit: str
    currency: Optional[CurrencyCode] = None
    comparison_value: Optional[Decimal] = None  # å¯¹æ¯”å€¼ï¼ˆå¦‚åŒæ¯”ï¼‰
    trend: str = "up"  # up, down, flat
    
    def get_achievement_rate(self) -> Decimal:
        """è¾¾æˆç‡"""
        if self.target == 0:
            return Decimal('0')
        return (self.value / self.target * 100).quantize(Decimal('0.01'))
    
    def get_change_rate(self) -> Decimal:
        """å˜åŒ–ç‡"""
        if not self.comparison_value or self.comparison_value == 0:
            return Decimal('0')
        return ((self.value - self.comparison_value) / self.comparison_value * 100).quantize(Decimal('0.01'))


@dataclass
class ChartConfig:
    """å›¾è¡¨é…ç½®"""
    chart_id: str
    chart_type: ChartType
    chart_title: str
    data_source: str
    x_axis_field: Optional[str] = None
    y_axis_field: Optional[str] = None
    series_fields: List[str] = field(default_factory=list)
    filters: Dict[str, Any] = field(default_factory=dict)
    drill_down_enabled: bool = True


@dataclass
class DashboardPanel:
    """ä»ªè¡¨æ¿é¢æ¿"""
    panel_id: str
    panel_title: str
    position_x: int
    position_y: int
    width: int
    height: int
    kpi_indicators: List[KPIIndicator] = field(default_factory=list)
    charts: List[ChartConfig] = field(default_factory=list)


@dataclass
class GlobalBIReport:
    """å…¨çƒBIæŠ¥è¡¨"""
    report_id: str
    report_name: str
    report_name_localized: Dict[str, str]
    description: str
    panels: List[DashboardPanel] = field(default_factory=list)
    supported_currencies: List[CurrencyCode] = field(default_factory=list)
    supported_languages: List[str] = field(default_factory=list)
    
    def add_panel(self, panel: DashboardPanel):
        """æ·»åŠ é¢æ¿"""
        self.panels.append(panel)


@dataclass
class ManufacturingBIPlatform:
    """åˆ¶é€ ä¸šBIå¹³å°"""
    platform_id: str
    platform_name: str
    reports: Dict[str, GlobalBIReport] = field(default_factory=dict)
    currency_rates: Dict[str, CurrencyRate] = field(default_factory=dict)
    
    def create_global_operations_report(self) -> GlobalBIReport:
        """åˆ›å»ºå…¨çƒè¿è¥åˆ†ææŠ¥è¡¨"""
        report = GlobalBIReport(
            report_id="RPT-GLOBAL-OPS-001",
            report_name="Global Operations Dashboard",
            report_name_localized={
                "en": "Global Operations Dashboard",
                "zh": "å…¨çƒè¿è¥åˆ†æ",
                "ja": "ã‚°ãƒ­ãƒ¼ãƒãƒ«é‹å–¶åˆ†æ",
                "de": "Globale Betriebsanalyse"
            },
            description="Global manufacturing operations overview",
            supported_currencies=[CurrencyCode.CNY, CurrencyCode.USD, CurrencyCode.EUR],
            supported_languages=["en", "zh", "ja", "de"]
        )
        
        # KPIé¢æ¿
        kpi_panel = DashboardPanel(
            panel_id="PANEL-KPI-001",
            panel_title="Key Performance Indicators",
            position_x=0,
            position_y=0,
            width=12,
            height=2
        )
        
        # æ ¸å¿ƒKPI
        kpis = [
            KPIIndicator(
                kpi_id="KPI-REVENUE",
                kpi_name="Total Revenue",
                kpi_name_localized={"en": "Total Revenue", "zh": "æ€»è¥æ”¶"},
                value=Decimal('8000000000'),
                target=Decimal('8500000000'),
                unit="Million",
                currency=CurrencyCode.CNY,
                comparison_value=Decimal('7500000000'),
                trend="up"
            ),
            KPIIndicator(
                kpi_id="KPI-ORDERS",
                kpi_name="Order Volume",
                kpi_name_localized={"en": "Order Volume", "zh": "è®¢å•é‡"},
                value=Decimal('2000000'),
                target=Decimal('2200000'),
                unit="Orders",
                comparison_value=Decimal('1850000'),
                trend="up"
            ),
            KPIIndicator(
                kpi_id="KPI-OTD",
                kpi_name="On-Time Delivery",
                kpi_name_localized={"en": "On-Time Delivery", "zh": "å‡†æ—¶äº¤ä»˜ç‡"},
                value=Decimal('94.5'),
                target=Decimal('95.0'),
                unit="%",
                comparison_value=Decimal('92.0'),
                trend="up"
            ),
            KPIIndicator(
                kpi_id="KPI-QUALITY",
                kpi_name="Quality Rate",
                kpi_name_localized={"en": "Quality Rate", "zh": "åˆæ ¼ç‡"},
                value=Decimal('99.2'),
                target=Decimal('99.5'),
                unit="%",
                comparison_value=Decimal('98.8'),
                trend="up"
            )
        ]
        kpi_panel.kpi_indicators = kpis
        report.add_panel(kpi_panel)
        
        # è¥æ”¶è¶‹åŠ¿å›¾è¡¨
        trend_chart = ChartConfig(
            chart_id="CHART-REVENUE-TREND",
            chart_type=ChartType.LINE_CHART,
            chart_title="Revenue Trend by Region",
            data_source="revenue_by_region_monthly",
            x_axis_field="month",
            y_axis_field="revenue",
            series_fields=["APAC", "EMEA", "Americas"]
        )
        trend_panel = DashboardPanel(
            panel_id="PANEL-TREND-001",
            panel_title="Regional Revenue Trend",
            position_x=0,
            position_y=2,
            width=6,
            height=4
        )
        trend_panel.charts.append(trend_chart)
        report.add_panel(trend_panel)
        
        # äº§å“ç±»åˆ«å æ¯”
        product_chart = ChartConfig(
            chart_id="CHART-PRODUCT-SHARE",
            chart_type=ChartType.PIE_CHART,
            chart_title="Revenue by Product Category",
            data_source="revenue_by_product",
            series_fields=["category", "revenue"]
        )
        product_panel = DashboardPanel(
            panel_id="PANEL-PRODUCT-001",
            panel_title="Product Mix",
            position_x=6,
            position_y=2,
            width=6,
            height=4
        )
        product_panel.charts.append(product_chart)
        report.add_panel(product_panel)
        
        self.reports[report.report_id] = report
        return report
    
    def convert_currency(self, amount: Decimal, from_curr: CurrencyCode, to_curr: CurrencyCode) -> Decimal:
        """è´§å¸è½¬æ¢"""
        if from_curr == to_curr:
            return amount
        # ç®€åŒ–è®¡ç®—ï¼Œå®é™…åº”æŸ¥è¯¢å®æ—¶æ±‡ç‡
        rates = {
            (CurrencyCode.CNY, CurrencyCode.USD): Decimal('0.14'),
            (CurrencyCode.USD, CurrencyCode.CNY): Decimal('7.20'),
            (CurrencyCode.CNY, CurrencyCode.EUR): Decimal('0.13'),
            (CurrencyCode.EUR, CurrencyCode.CNY): Decimal('7.80'),
        }
        rate = rates.get((from_curr, to_curr), Decimal('1'))
        return (amount * rate).quantize(Decimal('0.01'))
    
    def generate_executive_summary(self, report_id: str) -> Dict:
        """ç”Ÿæˆé«˜ç®¡æ‘˜è¦"""
        report = self.reports.get(report_id)
        if not report:
            return {}
        
        summary = {
            "report_name": report.report_name,
            "generated_at": datetime.now().isoformat(),
            "kpis": [],
            "alerts": []
        }
        
        for panel in report.panels:
            for kpi in panel.kpi_indicators:
                achievement = kpi.get_achievement_rate()
                change = kpi.get_change_rate()
                
                kpi_summary = {
                    "name": kpi.kpi_name,
                    "value": float(kpi.value),
                    "target": float(kpi.target),
                    "achievement": float(achievement),
                    "change": float(change),
                    "trend": kpi.trend
                }
                summary["kpis"].append(kpi_summary)
                
                # ç”Ÿæˆé¢„è­¦
                if achievement < 90:
                    summary["alerts"].append({
                        "type": "warning",
                        "message": f"{kpi.kpi_name}è¾¾æˆç‡ä½äº90%"
                    })
        
        return summary


# ä½¿ç”¨ç¤ºä¾‹
if __name__ == '__main__':
    print("=" * 70)
    print("åæ™ºåˆ¶é€  - å…¨çƒè¿è¥åˆ†æå¹³å°")
    print("=" * 70)
    
    # åˆ›å»ºå¹³å°
    platform = ManufacturingBIPlatform(
        platform_id="BI-HUazHI-001",
        platform_name="åæ™ºåˆ¶é€ å…¨çƒBIå¹³å°"
    )
    
    # åˆ›å»ºå…¨çƒè¿è¥æŠ¥è¡¨
    print("\n[1] åˆ›å»ºå…¨çƒè¿è¥åˆ†ææŠ¥è¡¨...")
    report = platform.create_global_operations_report()
    print(f"æŠ¥è¡¨ID: {report.report_id}")
    print(f"æŠ¥è¡¨åç§°: {report.report_name}")
    print(f"æ”¯æŒè´§å¸: {[c.value for c in report.supported_currencies]}")
    print(f"æ”¯æŒè¯­è¨€: {report.supported_languages}")
    print(f"é¢æ¿æ•°é‡: {len(report.panels)}")
    
    # æ˜¾ç¤ºKPIè¯¦æƒ…
    print("\n[2] æ ¸å¿ƒKPIæŒ‡æ ‡...")
    for panel in report.panels:
        for kpi in panel.kpi_indicators:
            print(f"\n  {kpi.kpi_name}:")
            print(f"    å½“å‰å€¼: {kpi.value} {kpi.unit}")
            print(f"    ç›®æ ‡å€¼: {kpi.target} {kpi.unit}")
            print(f"    è¾¾æˆç‡: {kpi.get_achievement_rate()}%")
            print(f"    åŒæ¯”å˜åŒ–: {kpi.get_change_rate()}%")
    
    # è´§å¸è½¬æ¢ç¤ºä¾‹
    print("\n[3] è´§å¸è½¬æ¢ç¤ºä¾‹...")
    cny_amount = Decimal('100000000')
    usd_amount = platform.convert_currency(cny_amount, CurrencyCode.CNY, CurrencyCode.USD)
    print(f"  {cny_amount} CNY = {usd_amount} USD")
    
    # ç”Ÿæˆé«˜ç®¡æ‘˜è¦
    print("\n[4] ç”Ÿæˆé«˜ç®¡æ‘˜è¦...")
    summary = platform.generate_executive_summary(report.report_id)
    print(f"  ç”Ÿæˆæ—¶é—´: {summary['generated_at']}")
    print(f"  KPIæ•°é‡: {len(summary['kpis'])}")
    print(f"  é¢„è­¦æ•°é‡: {len(summary['alerts'])}")
    
    if summary['alerts']:
        print("\n  é¢„è­¦ä¿¡æ¯:")
        for alert in summary['alerts']:
            print(f"    - {alert['message']}")
```

### 2.7 æ•ˆæœè¯„ä¼°ä¸ROIåˆ†æ

**é¡¹ç›®æŠ•å…¥**ï¼š

| æŠ•å…¥ç±»åˆ« | é‡‘é¢ï¼ˆä¸‡å…ƒï¼‰ |
|---------|------------|
| è½¯ä»¶å¹³å° | 500 |
| äº‘æœåŠ¡ | 400 |
| å¼€å‘å®æ–½ | 600 |
| åŸ¹è®­ | 100 |
| **æ€»æŠ•èµ„** | **1600** |

**é‡åŒ–æ”¶ç›Š**ï¼š

| æ”¶ç›Šç±»åˆ« | å¹´æ”¶ç›Šï¼ˆä¸‡å…ƒï¼‰ |
|---------|--------------|
| å†³ç­–æ•ˆç‡æå‡ | 1000 |
| åº“å­˜ä¼˜åŒ– | 1200 |
| è¿è¥æˆæœ¬é™ä½ | 800 |
| **å¹´æ€»æ”¶ç›Š** | **3000** |

**ROIè®¡ç®—**ï¼š
```
ROI = (3000 - 200) / 1600 Ã— 100% = 175%
æŠ•èµ„å›æ”¶æœŸ = 1600 / 2800 = 0.57å¹´ï¼ˆçº¦7ä¸ªæœˆï¼‰
```

---

**åˆ›å»ºæ—¶é—´**ï¼š2025-01-21
**æœ€åæ›´æ–°**ï¼š2025-02-15
