# å¹³è¡¡è®¡åˆ†å¡Schemaå®è·µæ¡ˆä¾‹

## ğŸ“‘ ç›®å½•

- [å¹³è¡¡è®¡åˆ†å¡Schemaå®è·µæ¡ˆä¾‹](#å¹³è¡¡è®¡åˆ†å¡schemaå®è·µæ¡ˆä¾‹)
  - [ğŸ“‘ ç›®å½•](#-ç›®å½•)
  - [1. æ¡ˆä¾‹æ¦‚è¿°](#1-æ¡ˆä¾‹æ¦‚è¿°)
  - [2. æ¡ˆä¾‹ï¼šé›†å›¢ä¼ä¸šå¹³è¡¡è®¡åˆ†å¡æˆ˜ç•¥æ‰§è¡Œå¹³å°](#2-æ¡ˆä¾‹é›†å›¢ä¼ä¸šå¹³è¡¡è®¡åˆ†å¡æˆ˜ç•¥æ‰§è¡Œå¹³å°)
    - [2.1 ä¼ä¸šèƒŒæ™¯](#21-ä¼ä¸šèƒŒæ™¯)
    - [2.2 ä¸šåŠ¡ç—›ç‚¹](#22-ä¸šåŠ¡ç—›ç‚¹)
    - [2.3 ä¸šåŠ¡ç›®æ ‡](#23-ä¸šåŠ¡ç›®æ ‡)
    - [2.4 æŠ€æœ¯æŒ‘æˆ˜](#24-æŠ€æœ¯æŒ‘æˆ˜)
    - [2.5 è§£å†³æ–¹æ¡ˆ](#25-è§£å†³æ–¹æ¡ˆ)
    - [2.6 å®Œæ•´ä»£ç å®ç°](#26-å®Œæ•´ä»£ç å®ç°)
    - [2.7 æ•ˆæœè¯„ä¼°](#27-æ•ˆæœè¯„ä¼°)

---

## 1. æ¡ˆä¾‹æ¦‚è¿°

æœ¬æ–‡æ¡£æä¾›å¹³è¡¡è®¡åˆ†å¡ï¼ˆBalanced Scorecardï¼‰Schemaåœ¨å®é™…ä¼ä¸šæˆ˜ç•¥ç®¡ç†ä¸­çš„åº”ç”¨æ¡ˆä¾‹ï¼Œæ¶µç›–æˆ˜ç•¥åœ°å›¾ã€æŒ‡æ ‡è®¾è®¡ã€æˆ˜ç•¥æ‰§è¡Œã€ç»©æ•ˆè¯„ä¼°ç­‰çœŸå®åœºæ™¯ã€‚

**æ¡ˆä¾‹ç±»å‹**ï¼š

1. **é›†å›¢ä¼ä¸šå¹³è¡¡è®¡åˆ†å¡æˆ˜ç•¥æ‰§è¡Œå¹³å°**ï¼šæˆ˜ç•¥åœ°å›¾ã€æŒ‡æ ‡ä½“ç³»ã€æˆ˜ç•¥ååŒ
2. **äº‹ä¸šéƒ¨è®¡åˆ†å¡ç³»ç»Ÿ**ï¼šè´¢åŠ¡ã€å®¢æˆ·ã€æµç¨‹ã€å­¦ä¹ æˆé•¿ç»´åº¦
3. **èŒèƒ½éƒ¨é—¨è®¡åˆ†å¡**ï¼šæ”¯æ’‘æˆ˜ç•¥ã€æœåŠ¡å†…éƒ¨ã€èƒ½åŠ›å»ºè®¾
4. **æˆ˜ç•¥å›é¡¾ä¸è°ƒæ•´**ï¼šæˆ˜ç•¥ä¼šè®®ã€åå·®åˆ†æã€æˆ˜ç•¥è°ƒæ•´

---

## 2. æ¡ˆä¾‹ï¼šé›†å›¢ä¼ä¸šå¹³è¡¡è®¡åˆ†å¡æˆ˜ç•¥æ‰§è¡Œå¹³å°

### 2.1 ä¼ä¸šèƒŒæ™¯

**ä¼ä¸šåç§°**ï¼šåèƒ½èƒ½æºé›†å›¢æœ‰é™å…¬å¸

**ä¼ä¸šè§„æ¨¡**ï¼š
- ä¸»è¥ä¸šåŠ¡ï¼šæ¸…æ´èƒ½æºå‘ç”µã€èƒ½æºæŠ€æœ¯æœåŠ¡
- å‘˜å·¥æ€»æ•°ï¼š15,000+äºº
- ä¸šåŠ¡å•å…ƒï¼š8ä¸ªå‘ç”µäº‹ä¸šéƒ¨ã€3ä¸ªæŠ€æœ¯å…¬å¸
- å¹´è¥æ”¶ï¼š280äº¿å…ƒäººæ°‘å¸
- ä¸Šå¸‚å…¬å¸ï¼šä¸Šäº¤æ‰€ä¸»æ¿ä¸Šå¸‚

**ç»„ç»‡æ¶æ„**ï¼š
- é›†å›¢æ€»éƒ¨ï¼šæˆ˜ç•¥ã€æŠ•èµ„ã€è´¢åŠ¡ã€äººåŠ›
- å‘ç”µäº‹ä¸šéƒ¨ï¼šé£ç”µã€å…‰ä¼ã€æ°´ç”µã€å‚¨èƒ½
- æŠ€æœ¯å…¬å¸ï¼šè®¾è®¡é™¢ã€ç ”ç©¶é™¢ã€å·¥ç¨‹å…¬å¸
- åŒºåŸŸå…¬å¸ï¼šååŒ—ã€åä¸œã€åå—ã€è¥¿å—

**ç°æœ‰æˆ˜ç•¥ç®¡ç†çŠ¶å†µ**ï¼š
- æˆ˜ç•¥åˆ¶å®šåç¼ºä¹æœ‰æ•ˆåˆ†è§£å’Œè·Ÿè¸ª
- å„éƒ¨é—¨ç»©æ•ˆæŒ‡æ ‡å­¤ç«‹ï¼Œç¼ºä¹ååŒ
- è´¢åŠ¡æŒ‡æ ‡ç‹¬å¤§ï¼Œå¿½è§†éè´¢åŠ¡æŒ‡æ ‡
- æˆ˜ç•¥å›é¡¾ä¼šè®®æµäºå½¢å¼ï¼Œç¼ºä¹æ•°æ®æ”¯æ’‘

### 2.2 ä¸šåŠ¡ç—›ç‚¹

1. **æˆ˜ç•¥è½åœ°å›°éš¾**ï¼šé›†å›¢äº”å¹´æˆ˜ç•¥åˆ¶å®šåï¼Œç¼ºä¹æœ‰æ•ˆåˆ†è§£æœºåˆ¶ï¼Œæˆ˜ç•¥ç›®æ ‡åœç•™åœ¨çº¸é¢ï¼Œå„äº‹ä¸šéƒ¨å„è‡ªä¸ºæ”¿ï¼Œæˆ˜ç•¥æ‰§è¡Œåå·®å¤§ï¼Œå¹´ç›®æ ‡è¾¾æˆç‡ä»…60%ã€‚

2. **æŒ‡æ ‡ä½“ç³»å¤±è¡¡**ï¼šè¿‡åº¦å…³æ³¨è´¢åŠ¡æŒ‡æ ‡ï¼ˆå æ¯”80%ï¼‰ï¼Œå¿½è§†å®¢æˆ·æ»¡æ„åº¦ã€å†…éƒ¨æµç¨‹ã€å‘˜å·¥æˆé•¿ç­‰éè´¢åŠ¡æŒ‡æ ‡ï¼ŒçŸ­æœŸè¡Œä¸ºå¤šï¼Œé•¿æœŸç«äº‰åŠ›å—æŸã€‚

3. **æˆ˜ç•¥ååŒç¼ºå¤±**ï¼šå„ä¸šåŠ¡å•å…ƒã€èŒèƒ½éƒ¨é—¨ç›®æ ‡å­¤ç«‹ï¼Œç¼ºä¹æ¨ªå‘ååŒæœºåˆ¶ï¼Œè·¨éƒ¨é—¨é¡¹ç›®æ¨è¿›å›°éš¾ï¼Œå†…è€—ä¸¥é‡ï¼ŒååŒæ•ˆç‡ä½ã€‚

4. **æˆ˜ç•¥æ‰§è¡Œä¸å¯è§**ï¼šæˆ˜ç•¥æ‰§è¡Œè¿›åº¦æ— æ³•å®æ—¶æŒæ¡ï¼Œé—®é¢˜å’Œé£é™©å‘ç°æ»åï¼Œåªèƒ½äº‹åè¡¥æ•‘ï¼Œæ— æ³•äº‹å‰é¢„é˜²ï¼Œæˆ˜ç•¥è°ƒæ•´å“åº”æ…¢ã€‚

5. **æˆ˜ç•¥ä¸é¢„ç®—è„±èŠ‚**ï¼šæˆ˜ç•¥ç›®æ ‡ä¸å¹´åº¦é¢„ç®—ã€ç»©æ•ˆè€ƒæ ¸å‰²è£‚ï¼Œé¢„ç®—ç¼–åˆ¶ä¸ä»¥æˆ˜ç•¥ä¸ºå¯¼å‘ï¼Œèµ„æºé…ç½®ä¸åˆç†ï¼Œæˆ˜ç•¥æŠ•å…¥ä¸è¶³ã€‚

### 2.3 ä¸šåŠ¡ç›®æ ‡

1. **æ„å»ºå®Œæ•´æˆ˜ç•¥åœ°å›¾**ï¼šå»ºç«‹æ¶µç›–è´¢åŠ¡ã€å®¢æˆ·ã€æµç¨‹ã€å­¦ä¹ æˆé•¿å››ä¸ªç»´åº¦çš„æˆ˜ç•¥åœ°å›¾ï¼Œæˆ˜ç•¥ç›®æ ‡è¦†ç›–ç‡100%ï¼Œæˆ˜ç•¥è·¯å¾„æ¸…æ™°å¯è§ã€‚

2. **å»ºç«‹å¹³è¡¡æŒ‡æ ‡ä½“ç³»**ï¼šå››ä¸ªç»´åº¦æŒ‡æ ‡å‡è¡¡å‘å±•ï¼Œè´¢åŠ¡æŒ‡æ ‡å æ¯”é™è‡³50%ä»¥ä¸‹ï¼Œéè´¢åŠ¡æŒ‡æ ‡é‡åŒ–å¯è€ƒæ ¸ï¼ŒæŒ‡æ ‡ååŒåº¦æå‡60%ã€‚

3. **å®ç°æˆ˜ç•¥çºµå‘ååŒ**ï¼šæˆ˜ç•¥ç›®æ ‡å±‚å±‚åˆ†è§£è‡³äº‹ä¸šéƒ¨ã€éƒ¨é—¨ã€å²—ä½ï¼Œçºµå‘å¯¹é½ç‡95%ä»¥ä¸Šï¼Œç¡®ä¿æˆ˜ç•¥æ„å›¾æœ‰æ•ˆä¼ é€’ã€‚

4. **å»ºç«‹æˆ˜ç•¥æ‰§è¡Œç›‘æ§**ï¼šæˆ˜ç•¥æ‰§è¡Œè¿›åº¦å®æ—¶å¯è§†åŒ–ï¼Œå…³é”®æŒ‡æ ‡åç¦»ç›®æ ‡5%è‡ªåŠ¨é¢„è­¦ï¼Œæˆ˜ç•¥ä¼šè®®æœ‰æ•°æ®æ”¯æ’‘ï¼Œå†³ç­–å“åº”é€Ÿåº¦æå‡3å€ã€‚

5. **æ‰“é€šæˆ˜ç•¥-é¢„ç®—-ç»©æ•ˆé—­ç¯**ï¼šæˆ˜ç•¥ç›®æ ‡ä¸å¹´åº¦é¢„ç®—ã€ç»©æ•ˆè€ƒæ ¸ç´§å¯†è¡”æ¥ï¼Œæˆ˜ç•¥æŠ•å…¥å æ¯”æå‡è‡³30%ï¼Œèµ„æºé…ç½®ä¸æˆ˜ç•¥ä¸€è‡´ã€‚

### 2.4 æŠ€æœ¯æŒ‘æˆ˜

1. **å¤æ‚æˆ˜ç•¥å…³ç³»å»ºæ¨¡**ï¼šæˆ˜ç•¥åœ°å›¾æ¶‰åŠå› æœå…³ç³»é“¾ã€æŒ‡æ ‡å…³è”å…³ç³»ï¼Œéœ€è¦çµæ´»çš„æ•°æ®æ¨¡å‹æ”¯æŒå¤æ‚ç½‘ç»œå…³ç³»ã€‚

2. **å¤šç»´åº¦æŒ‡æ ‡è®¡ç®—**ï¼šå››ä¸ªç»´åº¦æŒ‡æ ‡è®¡ç®—é€»è¾‘ä¸åŒï¼Œéœ€è¦æ”¯æŒç´¯è®¡ã€å¹³å‡ã€åŒæ¯”ç¯æ¯”ã€é˜ˆå€¼ç­‰å¤šç§è®¡ç®—æ–¹å¼ã€‚

3. **å¤šå±‚çº§æ•°æ®æ±‡æ€»**ï¼šé›†å›¢-äº‹ä¸šéƒ¨-éƒ¨é—¨-å²—ä½å››çº§æ¶æ„ï¼Œæ•°æ®éœ€è¦å‘ä¸Šæ±‡æ€»ã€å‘ä¸‹åˆ†è§£ï¼Œéœ€è¦å¼ºå¤§çš„èšåˆè®¡ç®—èƒ½åŠ›ã€‚

4. **å®æ—¶æˆ˜ç•¥ä»ªè¡¨ç›˜**ï¼šé«˜ç®¡éœ€è¦éšæ—¶æŒæ¡æˆ˜ç•¥æ‰§è¡Œæƒ…å†µï¼Œéœ€è¦é«˜æ€§èƒ½æ•°æ®åˆ·æ–°å’Œç§»åŠ¨ç«¯é€‚é…ã€‚

5. **ä¸ç°æœ‰ç³»ç»Ÿé›†æˆ**ï¼šéœ€è¦ä¸ERPã€BIã€é¢„ç®—ç³»ç»Ÿã€HRç³»ç»Ÿé›†æˆï¼Œå®ç°æ•°æ®è‡ªåŠ¨é‡‡é›†ã€‚

### 2.5 è§£å†³æ–¹æ¡ˆ

**ä½¿ç”¨Schemaå®šä¹‰å¹³è¡¡è®¡åˆ†å¡æˆ˜ç•¥æ‰§è¡Œå¹³å°**ï¼š

- **æˆ˜ç•¥åœ°å›¾Schema**ï¼šå®šä¹‰æˆ˜ç•¥ç›®æ ‡ã€å› æœå…³ç³»ã€æˆ˜ç•¥ä¸»é¢˜
- **è®¡åˆ†å¡Schema**ï¼šå®šä¹‰å››ä¸ªç»´åº¦ã€æŒ‡æ ‡ã€ç›®æ ‡å€¼
- **æˆ˜ç•¥è¡ŒåŠ¨Schema**ï¼šå®šä¹‰æˆ˜ç•¥ä¸¾æªã€è´£ä»»äººã€é‡Œç¨‹ç¢‘
- **æˆ˜ç•¥ä¼šè®®Schema**ï¼šå®šä¹‰ä¼šè®®æ¨¡æ¿ã€è®®ç¨‹ã€å†³è®®
- **æˆ˜ç•¥åˆ†æSchema**ï¼šå®šä¹‰åå·®åˆ†æã€æ ¹å› åˆ†æã€é¢„æµ‹

### 2.6 å®Œæ•´ä»£ç å®ç°

**å¹³è¡¡è®¡åˆ†å¡æˆ˜ç•¥æ‰§è¡Œå¹³å°Schemaå®ç°**ï¼š

```python
#!/usr/bin/env python3
"""
å¹³è¡¡è®¡åˆ†å¡æˆ˜ç•¥æ‰§è¡Œå¹³å°Schemaå®ç°
Balanced Scorecard Strategy Execution Platform Schema Implementation
"""

from typing import Dict, List, Optional, Set
from datetime import date, datetime, timedelta
from decimal import Decimal
from dataclasses import dataclass, field
from enum import Enum
import uuid
from collections import defaultdict


class Perspective(str, Enum):
    """è®¡åˆ†å¡ç»´åº¦"""
    FINANCIAL = "è´¢åŠ¡"
    CUSTOMER = "å®¢æˆ·"
    INTERNAL_PROCESS = "å†…éƒ¨æµç¨‹"
    LEARNING_GROWTH = "å­¦ä¹ æˆé•¿"


class StrategyTheme(str, Enum):
    """æˆ˜ç•¥ä¸»é¢˜"""
    PROFITABILITY = "ç›ˆåˆ©å¢é•¿"
    CUSTOMER_EXCELLENCE = "å®¢æˆ·å“è¶Š"
    OPERATIONAL_EXCELLENCE = "è¿è¥å“è¶Š"
    INNOVATION = "åˆ›æ–°é©±åŠ¨"
    PEOPLE_DEVELOPMENT = "äººæ‰å‘å±•"


class ObjectiveType(str, Enum):
    """ç›®æ ‡ç±»å‹"""
    OUTCOME = "ç»“æœå‹"
    DRIVER = "é©±åŠ¨å‹"
    SUPPORT = "æ”¯æ’‘å‹"


class MeasureType(str, Enum):
    """æŒ‡æ ‡ç±»å‹"""
    LEADING = "é¢†å…ˆæŒ‡æ ‡"
    LAGGING = "æ»åæŒ‡æ ‡"


class Status(str, Enum):
    """çŠ¶æ€"""
    NOT_STARTED = "æœªå¼€å§‹"
    IN_PROGRESS = "è¿›è¡Œä¸­"
    AT_RISK = "æœ‰é£é™©"
    DELAYED = "å»¶æœŸ"
    COMPLETED = "å·²å®Œæˆ"
    CANCELLED = "å·²å–æ¶ˆ"


@dataclass
class StrategicObjective:
    """æˆ˜ç•¥ç›®æ ‡"""
    objective_id: str
    objective_code: str
    name: str
    description: str
    perspective: Perspective
    theme: StrategyTheme
    objective_type: ObjectiveType = ObjectiveType.OUTCOME
    owner_id: str = ""
    parent_id: Optional[str] = None
    level: int = 1
    sequence: int = 1
    is_key: bool = False
    created_at: datetime = field(default_factory=datetime.now)
    
    def get_full_code(self, obj_map: Dict[str, 'StrategicObjective']) -> str:
        """è·å–å®Œæ•´ç¼–ç """
        codes = [self.objective_code]
        current = self
        while current.parent_id and current.parent_id in obj_map:
            current = obj_map[current.parent_id]
            codes.insert(0, current.objective_code)
        return '.'.join(codes)


@dataclass
class CausalLink:
    """å› æœå…³ç³»"""
    link_id: str
    from_objective_id: str
    to_objective_id: str
    link_type: str = "å› æœ"
    description: Optional[str] = None
    strength: int = 5


@dataclass
class PerformanceMeasure:
    """ç»©æ•ˆæŒ‡æ ‡"""
    measure_id: str
    measure_code: str
    name: str
    description: str
    objective_id: str
    measure_type: MeasureType
    unit: str
    calculation_formula: Optional[str] = None
    data_source: Optional[str] = None
    frequency: str = "æœˆåº¦"
    is_key: bool = False
    benchmark_internal: Optional[Decimal] = None
    benchmark_external: Optional[Decimal] = None
    created_at: datetime = field(default_factory=datetime.now)


@dataclass
class Target:
    """ç›®æ ‡å€¼"""
    target_id: str
    measure_id: str
    period_year: int
    period_type: str
    period_month: Optional[int] = None
    target_value: Decimal
    warning_threshold: Optional[Decimal] = None
    stretch_target: Optional[Decimal] = None
    baseline: Optional[Decimal] = None


@dataclass
class Actual:
    """å®é™…å€¼"""
    actual_id: str
    measure_id: str
    period_year: int
    period_type: str
    period_month: Optional[int] = None
    actual_value: Decimal
    input_date: datetime = field(default_factory=datetime.now)
    input_by: Optional[str] = None


@dataclass
class Score:
    """å¾—åˆ†"""
    score_id: str
    measure_id: str
    target_id: str
    period_year: int
    period_type: str
    period_month: Optional[int] = None
    target_value: Decimal
    actual_value: Decimal
    achievement_rate: Decimal = Decimal('0')
    score: Decimal = Decimal('0')
    status: str = "æ­£å¸¸"


@dataclass
class StrategicInitiative:
    """æˆ˜ç•¥ä¸¾æª"""
    initiative_id: str
    initiative_code: str
    name: str
    description: str
    objective_id: str
    owner_id: str
    start_date: date
    end_date: date
    budget: Decimal = Decimal('0')
    status: Status = Status.NOT_STARTED
    progress: int = 0
    created_at: datetime = field(default_factory=datetime.now)
    
    def get_remaining_days(self) -> int:
        """è·å–å‰©ä½™å¤©æ•°"""
        if self.end_date < date.today():
            return 0
        return (self.end_date - date.today()).days
    
    def is_overdue(self) -> bool:
        """æ˜¯å¦é€¾æœŸ"""
        return self.end_date < date.today() and self.status != Status.COMPLETED


@dataclass
class Milestone:
    """é‡Œç¨‹ç¢‘"""
    milestone_id: str
    initiative_id: str
    name: str
    due_date: date
    status: Status = Status.NOT_STARTED
    completion_date: Optional[date] = None


@dataclass
class Scorecard:
    """è®¡åˆ†å¡"""
    scorecard_id: str
    scorecard_name: str
    owner_id: str
    owner_type: str
    period_year: int
    objectives: List[str] = field(default_factory=list)
    measures: List[str] = field(default_factory=list)
    created_at: datetime = field(default_factory=datetime.now)


@dataclass
class StrategyMap:
    """æˆ˜ç•¥åœ°å›¾"""
    map_id: str
    map_name: str
    period_year: int
    objectives: List[StrategicObjective] = field(default_factory=list)
    links: List[CausalLink] = field(default_factory=list)
    created_at: datetime = field(default_factory=datetime.now)
    
    def get_perspective_objectives(self, perspective: Perspective) -> List[StrategicObjective]:
        """è·å–æŸç»´åº¦çš„ç›®æ ‡"""
        return [obj for obj in self.objectives if obj.perspective == perspective]
    
    def get_objective_drivers(self, objective_id: str) -> List[StrategicObjective]:
        """è·å–ç›®æ ‡çš„é©±åŠ¨å› ç´ """
        drivers = []
        for link in self.links:
            if link.to_objective_id == objective_id:
                obj = next((o for o in self.objectives if o.objective_id == link.from_objective_id), None)
                if obj:
                    drivers.append(obj)
        return drivers


@dataclass
class BSCSystem:
    """å¹³è¡¡è®¡åˆ†å¡ç³»ç»Ÿ"""
    strategy_maps: Dict[str, StrategyMap] = field(default_factory=dict)
    objectives: Dict[str, StrategicObjective] = field(default_factory=dict)
    causal_links: Dict[str, CausalLink] = field(default_factory=dict)
    measures: Dict[str, PerformanceMeasure] = field(default_factory=dict)
    targets: Dict[str, Target] = field(default_factory=dict)
    actuals: Dict[str, Actual] = field(default_factory=dict)
    scores: Dict[str, Score] = field(default_factory=dict)
    initiatives: Dict[str, StrategicInitiative] = field(default_factory=dict)
    milestones: Dict[str, Milestone] = field(default_factory=dict)
    scorecards: Dict[str, Scorecard] = field(default_factory=dict)
    
    def create_strategy_map(self, strategy_map: StrategyMap) -> str:
        """åˆ›å»ºæˆ˜ç•¥åœ°å›¾"""
        if not strategy_map.map_id:
            strategy_map.map_id = str(uuid.uuid4())
        self.strategy_maps[strategy_map.map_id] = strategy_map
        return strategy_map.map_id
    
    def add_objective(self, objective: StrategicObjective) -> str:
        """æ·»åŠ æˆ˜ç•¥ç›®æ ‡"""
        if not objective.objective_id:
            objective.objective_id = str(uuid.uuid4())
        self.objectives[objective.objective_id] = objective
        return objective.objective_id
    
    def add_causal_link(self, link: CausalLink) -> str:
        """æ·»åŠ å› æœå…³ç³»"""
        if not link.link_id:
            link.link_id = str(uuid.uuid4())
        self.causal_links[link.link_id] = link
        return link.link_id
    
    def add_measure(self, measure: PerformanceMeasure) -> str:
        """æ·»åŠ ç»©æ•ˆæŒ‡æ ‡"""
        if not measure.measure_id:
            measure.measure_id = str(uuid.uuid4())
        self.measures[measure.measure_id] = measure
        return measure.measure_id
    
    def add_initiative(self, initiative: StrategicInitiative) -> str:
        """æ·»åŠ æˆ˜ç•¥ä¸¾æª"""
        if not initiative.initiative_id:
            initiative.initiative_id = str(uuid.uuid4())
        self.initiatives[initiative.initiative_id] = initiative
        return initiative.initiative_id
    
    def calculate_score(self, measure_id: str, year: int, month: int) -> Optional[Score]:
        """è®¡ç®—å¾—åˆ†"""
        # æŸ¥æ‰¾ç›®æ ‡
        target = None
        for t in self.targets.values():
            if t.measure_id == measure_id and t.period_year == year and t.period_month == month:
                target = t
                break
        
        if not target:
            return None
        
        # æŸ¥æ‰¾å®é™…å€¼
        actual = None
        for a in self.actuals.values():
            if a.measure_id == measure_id and a.period_year == year and a.period_month == month:
                actual = a
                break
        
        if not actual:
            return None
        
        # è®¡ç®—è¾¾æˆç‡
        if target.target_value != 0:
            achievement = actual.actual_value / target.target_value * 100
        else:
            achievement = Decimal('0')
        
        # è®¡ç®—å¾—åˆ†ï¼ˆå°é¡¶110åˆ†ï¼‰
        score_value = min(Decimal('110'), achievement)
        
        score = Score(
            score_id=str(uuid.uuid4()),
            measure_id=measure_id,
            target_id=target.target_id,
            period_year=year,
            period_type='æœˆåº¦',
            period_month=month,
            target_value=target.target_value,
            actual_value=actual.actual_value,
            achievement_rate=achievement,
            score=score_value
        )
        
        # åˆ¤æ–­çŠ¶æ€
        if target.warning_threshold and achievement < target.warning_threshold:
            score.status = "é¢„è­¦"
        
        self.scores[score.score_id] = score
        return score
    
    def get_scorecard_summary(self, scorecard_id: str, year: int, month: int) -> Dict:
        """è·å–è®¡åˆ†å¡æ±‡æ€»"""
        scorecard = self.scorecards.get(scorecard_id)
        if not scorecard:
            return {}
        
        perspective_scores = defaultdict(lambda: {'count': 0, 'score': Decimal('0')})
        
        for measure_id in scorecard.measures:
            # è®¡ç®—å¾—åˆ†
            score = self.calculate_score(measure_id, year, month)
            if score:
                measure = self.measures.get(measure_id)
                if measure:
                    obj = self.objectives.get(measure.objective_id)
                    if obj:
                        perspective_scores[obj.perspective.value]['count'] += 1
                        perspective_scores[obj.perspective.value]['score'] += score.score
        
        return {
            'scorecard_id': scorecard_id,
            'scorecard_name': scorecard.scorecard_name,
            'period': f"{year}-{month:02d}",
            'perspectives': {
                persp: {
                    'count': data['count'],
                    'avg_score': float(data['score'] / data['count']) if data['count'] > 0 else 0
                }
                for persp, data in perspective_scores.items()
            }
        }
    
    def get_initiative_summary(self, objective_id: Optional[str] = None) -> Dict:
        """è·å–æˆ˜ç•¥ä¸¾æªæ±‡æ€»"""
        initiatives = list(self.initiatives.values())
        if objective_id:
            initiatives = [i for i in initiatives if i.objective_id == objective_id]
        
        total = len(initiatives)
        if total == 0:
            return {}
        
        by_status = defaultdict(int)
        for i in initiatives:
            by_status[i.status.value] += 1
        
        return {
            'total': total,
            'by_status': dict(by_status),
            'completed': by_status[Status.COMPLETED.value],
            'in_progress': by_status[Status.IN_PROGRESS.value],
            'at_risk': by_status[Status.AT_RISK.value],
            'overdue': len([i for i in initiatives if i.is_overdue()]),
            'avg_progress': sum(i.progress for i in initiatives) / total if total > 0 else 0
        }


# ä½¿ç”¨ç¤ºä¾‹
if __name__ == '__main__':
    bsc = BSCSystem()
    
    # åˆ›å»ºæˆ˜ç•¥åœ°å›¾
    strategy_map = StrategyMap(
        map_id='MAP001',
        map_name='åèƒ½èƒ½æº2025æˆ˜ç•¥åœ°å›¾',
        period_year=2025
    )
    bsc.create_strategy_map(strategy_map)
    
    # æ·»åŠ æˆ˜ç•¥ç›®æ ‡ - è´¢åŠ¡ç»´åº¦
    fin_obj1 = StrategicObjective(
        objective_id='OBJ001',
        objective_code='F1',
        name='æå‡è‚¡ä¸œå›æŠ¥',
        description='é€šè¿‡ç›ˆåˆ©å¢é•¿æå‡è‚¡ä¸œä»·å€¼',
        perspective=Perspective.FINANCIAL,
        theme=StrategyTheme.PROFITABILITY,
        objective_type=ObjectiveType.OUTCOME,
        is_key=True
    )
    bsc.add_objective(fin_obj1)
    
    # æ·»åŠ æˆ˜ç•¥ç›®æ ‡ - å®¢æˆ·ç»´åº¦
    cust_obj1 = StrategicObjective(
        objective_id='OBJ002',
        objective_code='C1',
        name='æå‡å®¢æˆ·æ»¡æ„åº¦',
        description='æä¾›ä¼˜è´¨èƒ½æºæœåŠ¡ï¼Œæé«˜å®¢æˆ·æ»¡æ„åº¦',
        perspective=Perspective.CUSTOMER,
        theme=StrategyTheme.CUSTOMER_EXCELLENCE,
        objective_type=ObjectiveType.DRIVER
    )
    bsc.add_objective(cust_obj1)
    
    # æ·»åŠ å› æœå…³ç³»
    link = CausalLink(
        link_id='LINK001',
        from_objective_id='OBJ002',
        to_objective_id='OBJ001',
        description='å®¢æˆ·æ»¡æ„åº¦æå‡å¸¦åŠ¨æ”¶å…¥å¢é•¿'
    )
    bsc.add_causal_link(link)
    
    # æ·»åŠ ç»©æ•ˆæŒ‡æ ‡
    measure1 = PerformanceMeasure(
        measure_id='M001',
        measure_code='F1.1',
        name='å‡€èµ„äº§æ”¶ç›Šç‡',
        description='å‡€åˆ©æ¶¦/å¹³å‡å‡€èµ„äº§',
        objective_id='OBJ001',
        measure_type=MeasureType.LAGGING,
        unit='%',
        frequency='å­£åº¦',
        is_key=True
    )
    bsc.add_measure(measure1)
    
    measure2 = PerformanceMeasure(
        measure_id='M002',
        measure_code='C1.1',
        name='å®¢æˆ·æ»¡æ„åº¦è¯„åˆ†',
        description='å¹´åº¦å®¢æˆ·æ»¡æ„åº¦è°ƒæŸ¥è¯„åˆ†',
        objective_id='OBJ002',
        measure_type=MeasureType.LAGGING,
        unit='åˆ†',
        frequency='å¹´åº¦'
    )
    bsc.add_measure(measure2)
    
    # æ·»åŠ ç›®æ ‡å€¼
    target1 = Target(
        target_id='TGT001',
        measure_id='M001',
        period_year=2025,
        period_type='å¹´åº¦',
        target_value=Decimal('12'),
        warning_threshold=Decimal('10')
    )
    bsc.targets[target1.target_id] = target1
    
    target2 = Target(
        target_id='TGT002',
        measure_id='M002',
        period_year=2025,
        period_type='å¹´åº¦',
        target_value=Decimal('85'),
        warning_threshold=Decimal('80')
    )
    bsc.targets[target2.target_id] = target2
    
    # æ·»åŠ å®é™…å€¼
    actual1 = Actual(
        actual_id='ACT001',
        measure_id='M001',
        period_year=2025,
        period_type='æœˆåº¦',
        period_month=1,
        actual_value=Decimal('11.5')
    )
    bsc.actuals[actual1.actual_id] = actual1
    
    # æ·»åŠ æˆ˜ç•¥ä¸¾æª
    initiative = StrategicInitiative(
        initiative_id='INIT001',
        initiative_code='S1',
        name='æ–°èƒ½æºäº§èƒ½æ‰©å¼ è®¡åˆ’',
        description='æ–°å¢500MWé£ç”µå’Œ300MWå…‰ä¼äº§èƒ½',
        objective_id='OBJ001',
        owner_id='VP001',
        start_date=date(2025, 1, 1),
        end_date=date(2025, 12, 31),
        budget=Decimal('2000000000'),
        status=Status.IN_PROGRESS,
        progress=35
    )
    bsc.add_initiative(initiative)
    
    # æ‰“å°ç»Ÿè®¡
    print("=" * 70)
    print("å¹³è¡¡è®¡åˆ†å¡æˆ˜ç•¥æ‰§è¡Œå¹³å°ç»Ÿè®¡æŠ¥å‘Š")
    print("=" * 70)
    
    print(f"\næˆ˜ç•¥åœ°å›¾: {strategy_map.map_name}")
    print(f"  æˆ˜ç•¥ç›®æ ‡æ•°: {len(bsc.objectives)}")
    print(f"  å› æœå…³ç³»æ•°: {len(bsc.causal_links)}")
    
    # æŒ‰ç»´åº¦ç»Ÿè®¡ç›®æ ‡
    by_perspective = defaultdict(list)
    for obj in bsc.objectives.values():
        by_perspective[obj.perspective.value].append(obj)
    
    print(f"\næˆ˜ç•¥ç›®æ ‡åˆ†å¸ƒ:")
    for persp, objs in by_perspective.items():
        print(f"  {persp}: {len(objs)}ä¸ª")
    
    print(f"\nç»©æ•ˆæŒ‡æ ‡æ•°: {len(bsc.measures)}")
    print(f"  å…³é”®æŒ‡æ ‡: {len([m for m in bsc.measures.values() if m.is_key])}")
    
    # æˆ˜ç•¥ä¸¾æªç»Ÿè®¡
    init_summary = bsc.get_initiative_summary()
    print(f"\næˆ˜ç•¥ä¸¾æªç»Ÿè®¡:")
    print(f"  æ€»ä¸¾æªæ•°: {init_summary['total']}")
    print(f"  å·²å®Œæˆ: {init_summary['completed']}")
    print(f"  è¿›è¡Œä¸­: {init_summary['in_progress']}")
    print(f"  æœ‰é£é™©: {init_summary['at_risk']}")
    print(f"  é€¾æœŸ: {init_summary['overdue']}")
    print(f"  å¹³å‡è¿›åº¦: {init_summary['avg_progress']:.1f}%")
    
    # è®¡ç®—å¾—åˆ†
    score = bsc.calculate_score('M001', 2025, 1)
    if score:
        print(f"\næŒ‡æ ‡å¾—åˆ†:")
        print(f"  æŒ‡æ ‡: {bsc.measures['M001'].name}")
        print(f"  ç›®æ ‡å€¼: {score.target_value}%")
        print(f"  å®é™…å€¼: {score.actual_value}%")
        print(f"  è¾¾æˆç‡: {score.achievement_rate:.1f}%")
        print(f"  å¾—åˆ†: {score.score:.1f}")
        print(f"  çŠ¶æ€: {score.status}")
```

### 2.7 æ•ˆæœè¯„ä¼°

**å…³é”®ç»©æ•ˆæŒ‡æ ‡ï¼ˆKPIï¼‰å¯¹æ¯”**ï¼š

| æŒ‡æ ‡ | æ”¹è¿›å‰ | æ”¹è¿›åï¼ˆ18ä¸ªæœˆï¼‰ | æå‡å¹…åº¦ |
|------|--------|-----------------|----------|
| æˆ˜ç•¥ç›®æ ‡è¾¾æˆç‡ | 60% | 87% | +27% |
| æˆ˜ç•¥é€æ˜åº¦ | 20% | 95% | +75pp |
| æˆ˜ç•¥å¯¹é½åº¦ | 35% | 92% | +57pp |
| æˆ˜ç•¥è°ƒæ•´å“åº”æ—¶é—´ | 6ä¸ªæœˆ | 1ä¸ªæœˆ | -83% |
| è·¨éƒ¨é—¨åä½œæ•ˆç‡ | åŸºå‡† | +60% | +60% |
| éè´¢åŠ¡æŒ‡æ ‡å æ¯” | 20% | 55% | +35pp |
| æˆ˜ç•¥ä¼šè®®æ•ˆç‡ | - | +3å€ | +3å€ |
| æˆ˜ç•¥æŠ•å…¥å æ¯” | 15% | 32% | +17pp |

**æŠ•èµ„å›æŠ¥åˆ†æï¼ˆROIï¼‰**ï¼š

| æŠ•èµ„/æ”¶ç›Šé¡¹ç›® | é‡‘é¢ï¼ˆä¸‡å…ƒï¼‰ | è¯´æ˜ |
|--------------|-------------|------|
| **æ€»æŠ•èµ„** | **850** | |
| å¹³å°è½¯ä»¶è´¹ç”¨ | 350 | BSCå¹³å°+å®šåˆ¶å¼€å‘ |
| æˆ˜ç•¥å’¨è¯¢è´¹ç”¨ | 280 | æˆ˜ç•¥æ¢³ç†ã€æŒ‡æ ‡è®¾è®¡ |
| åŸ¹è®­å®æ–½è´¹ç”¨ | 150 | å…¨å‘˜åŸ¹è®­ã€ä¸Šçº¿æ”¯æŒ |
| è¿ç»´è´¹ç”¨ | 70 | æŠ€æœ¯æ”¯æŒ |
| **å¹´åº¦æ”¶ç›Š** | **3,200** | |
| æˆ˜ç•¥è¾¾æˆæå‡ | 1,500 | ç›®æ ‡è¾¾æˆç‡æå‡æ”¶ç›Š |
| èµ„æºé…ç½®ä¼˜åŒ– | 800 | æˆ˜ç•¥æŠ•å…¥æ•ˆç‡æå‡ |
| ç®¡ç†æ•ˆç‡æå‡ | 500 | ä¼šè®®ã€å†³ç­–æ•ˆç‡æå‡ |
| ååŒæ•ˆç‡æå‡ | 400 | è·¨éƒ¨é—¨åä½œèŠ‚çº¦ |
| **é¦–å¹´å‡€æ”¶ç›Š** | **2,350** | |
| **æŠ•èµ„å›æŠ¥ç‡ï¼ˆROIï¼‰** | **276.5%** | é¦–å¹´ |
| **æŠ•èµ„å›æ”¶æœŸ** | **3.2ä¸ªæœˆ** | |

**ä¸šåŠ¡ä»·å€¼**ï¼š

1. **æˆ˜ç•¥è½åœ°èƒ½åŠ›æ˜¾è‘—å¢å¼º**ï¼šæˆ˜ç•¥ç›®æ ‡ä»çº¸é¢èµ°å‘æ‰§è¡Œï¼Œç›®æ ‡è¾¾æˆç‡ä»60%æå‡è‡³87%ï¼Œäº”å¹´æˆ˜ç•¥è§„åˆ’çš„å¯å®ç°æ€§å¤§å¹…æé«˜ã€‚

2. **æˆ˜ç•¥è§†é‡æ›´åŠ å¹³è¡¡**ï¼šéè´¢åŠ¡æŒ‡æ ‡å æ¯”ä»20%æå‡è‡³55%ï¼Œä¼ä¸šåœ¨è¿½æ±‚çŸ­æœŸåˆ©æ¶¦çš„åŒæ—¶ï¼Œæ›´åŠ æ³¨é‡å®¢æˆ·ã€æµç¨‹ã€äººæ‰ç­‰é•¿æœŸç«äº‰åŠ›å»ºè®¾ã€‚

3. **æˆ˜ç•¥ååŒæ•ˆæœæ˜æ˜¾**ï¼šå„ä¸šåŠ¡å•å…ƒã€èŒèƒ½éƒ¨é—¨ç›®æ ‡æ¸…æ™°å¯è§ï¼Œæ¨ªå‘ååŒæ•ˆç‡æå‡60%ï¼Œé‡å¤§é¡¹ç›®æŒ‰æœŸäº¤ä»˜ç‡æå‡40%ã€‚

4. **æˆ˜ç•¥å†³ç­–ç§‘å­¦é«˜æ•ˆ**ï¼šæˆ˜ç•¥æ‰§è¡Œè¿›åº¦å®æ—¶å¯è§ï¼Œåå·®åŠæ—¶å‘ç°åŠæ—¶è°ƒæ•´ï¼Œæˆ˜ç•¥è°ƒæ•´å“åº”æ—¶é—´ä»6ä¸ªæœˆç¼©çŸ­è‡³1ä¸ªæœˆã€‚

5. **ç»„ç»‡èƒ½åŠ›æŒç»­æå‡**ï¼šæˆ˜ç•¥-é¢„ç®—-ç»©æ•ˆé—­ç¯æ‰“é€šï¼Œèµ„æºé…ç½®ä¸æˆ˜ç•¥ä¸€è‡´ï¼Œæˆ˜ç•¥æŠ•å…¥å æ¯”ä»15%æå‡è‡³32%ï¼Œæˆ˜ç•¥æ‰§è¡Œæˆä¸ºç»„ç»‡ä¹ æƒ¯ã€‚

**æˆåŠŸç»éªŒ**ï¼š

1. **é«˜å±‚äº²è‡ªæ¨åŠ¨**ï¼šè‘£äº‹é•¿å’Œæ€»è£äº²è‡ªå‚ä¸æˆ˜ç•¥åœ°å›¾è®¾è®¡ï¼Œå„äº‹ä¸šéƒ¨æ€»ç»ç†æ‹…ä»»ç»´åº¦Ownerï¼Œç¡®ä¿æˆ˜ç•¥é‡è§†åº¦ã€‚
2. **æˆ˜ç•¥æ¢³ç†å…ˆè¡Œ**ï¼šè˜è¯·ä¸“ä¸šå’¨è¯¢å…¬å¸æ¢³ç†æˆ˜ç•¥ï¼Œç¡®ä¿æˆ˜ç•¥åœ°å›¾è®¾è®¡çš„ç§‘å­¦æ€§å’Œå®Œæ•´æ€§ã€‚
3. **åˆ†æ­¥è¯•ç‚¹æ¨å¹¿**ï¼šå…ˆåœ¨é›†å›¢æ€»éƒ¨å’Œ2ä¸ªäº‹ä¸šéƒ¨è¯•ç‚¹ï¼Œç§¯ç´¯ç»éªŒåå…¨é¢æ¨å¹¿ã€‚
4. **æŒç»­åŸ¹è®­è¾…å¯¼**ï¼šå®šæœŸå¼€å±•BSCæ–¹æ³•åŸ¹è®­å’Œæœ€ä½³å®è·µåˆ†äº«ï¼Œè®©æˆ˜ç•¥ç®¡ç†æˆä¸ºç»„ç»‡èƒ½åŠ›ã€‚

---

**å‚è€ƒæ¡ˆä¾‹**ï¼š

- [å¹³è¡¡è®¡åˆ†å¡åä¼šæ¡ˆä¾‹](https://www.balancedscorecard.org/)
- [å¡æ™®å…°ä¸è¯ºé¡¿æˆ˜ç•¥ç®¡ç†](https://www.whatmatters.com/)
