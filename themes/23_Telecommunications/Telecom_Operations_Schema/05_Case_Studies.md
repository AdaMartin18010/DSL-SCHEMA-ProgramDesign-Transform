# ç”µä¿¡è¿è¥Schemaå®è·µæ¡ˆä¾‹

## ğŸ“‘ ç›®å½•

- [ç”µä¿¡è¿è¥Schemaå®è·µæ¡ˆä¾‹](#ç”µä¿¡è¿è¥schemaå®è·µæ¡ˆä¾‹)
  - [ğŸ“‘ ç›®å½•](#-ç›®å½•)
  - [1. æ¡ˆä¾‹æ¦‚è¿°](#1-æ¡ˆä¾‹æ¦‚è¿°)
  - [2. æ¡ˆä¾‹1ï¼šä¼ä¸šæœåŠ¡è®¢å•ç®¡ç†ç³»ç»Ÿ](#2-æ¡ˆä¾‹1ä¼ä¸šæœåŠ¡è®¢å•ç®¡ç†ç³»ç»Ÿ)
    - [2.1 ä¸šåŠ¡èƒŒæ™¯](#21-ä¸šåŠ¡èƒŒæ™¯)
    - [2.2 æŠ€æœ¯æŒ‘æˆ˜](#22-æŠ€æœ¯æŒ‘æˆ˜)
    - [2.3 è§£å†³æ–¹æ¡ˆ](#23-è§£å†³æ–¹æ¡ˆ)
    - [2.4 å®Œæ•´ä»£ç å®ç°](#24-å®Œæ•´ä»£ç å®ç°)
    - [2.5 æ•ˆæœè¯„ä¼°](#25-æ•ˆæœè¯„ä¼°)

---

## 1. æ¡ˆä¾‹æ¦‚è¿°

æœ¬æ–‡æ¡£æä¾›ç”µä¿¡è¿è¥Schemaåœ¨å®é™…ä¼ä¸šåº”ç”¨ä¸­çš„å®è·µæ¡ˆä¾‹ï¼Œæ¶µç›–æœåŠ¡è®¢å•ç®¡ç†ã€å®¢æˆ·ç®¡ç†ã€ç½‘ç»œèµ„æºç®¡ç†ç­‰çœŸå®åœºæ™¯ã€‚

**æ¡ˆä¾‹ç±»å‹**ï¼š

1. **æœåŠ¡è®¢å•ç®¡ç†ç³»ç»Ÿ**ï¼šç”µä¿¡æœåŠ¡è®¢å•åˆ›å»ºå’Œç®¡ç†
2. **å®¢æˆ·ç®¡ç†ç³»ç»Ÿ**ï¼šç”µä¿¡å®¢æˆ·ä¿¡æ¯ç®¡ç†
3. **ç½‘ç»œèµ„æºç®¡ç†ç³»ç»Ÿ**ï¼šç½‘ç»œèµ„æºåˆ†é…å’Œç®¡ç†
4. **æœåŠ¡å¼€é€šç³»ç»Ÿ**ï¼šç”µä¿¡æœåŠ¡å¼€é€šæµç¨‹
5. **ç”µä¿¡è¿è¥æ•°æ®å­˜å‚¨ä¸åˆ†æç³»ç»Ÿ**ï¼šç”µä¿¡è¿è¥æ•°æ®åˆ†æå’Œç›‘æ§

**å‚è€ƒä¼ä¸šæ¡ˆä¾‹**ï¼š

- **eTOMæ ‡å‡†**ï¼šTM Forum eTOMæ ‡å‡†
- **ç”µä¿¡è¿è¥æœ€ä½³å®è·µ**ï¼šTM Forumæœ€ä½³å®è·µ

---

## 2. æ¡ˆä¾‹1ï¼šä¼ä¸šæœåŠ¡è®¢å•ç®¡ç†ç³»ç»Ÿ

### 2.1 ä¸šåŠ¡èƒŒæ™¯

**ä¼ä¸šèƒŒæ™¯**ï¼š
ä¸­å›½ç”µä¿¡é›†å›¢æ˜¯ä¸­å›½ç‰¹å¤§å‹å›½æœ‰é€šä¿¡ä¼ä¸šï¼Œæˆç«‹äº2000å¹´ï¼Œæ˜¯ä¸­å›½æœ€å¤§çš„ç»¼åˆä¿¡æ¯æœåŠ¡æä¾›å•†ä¹‹ä¸€ã€‚é›†å›¢æ‹¥æœ‰å‘˜å·¥40ä½™ä¸‡äººï¼ŒæœåŠ¡ä¸ªäººç§»åŠ¨ç”¨æˆ·4.2äº¿ã€å®½å¸¦ç”¨æˆ·1.8äº¿ã€æ”¿ä¼å®¢æˆ·è¶…è¿‡1000ä¸‡å®¶ã€‚2024å¹´è¥ä¸šæ”¶å…¥è¶…è¿‡5500äº¿å…ƒäººæ°‘å¸ï¼Œä½åˆ—ã€Šè´¢å¯Œã€‹ä¸–ç•Œ500å¼ºç¬¬120ä½ã€‚

ä¸­å›½ç”µä¿¡ä¼ä¸šå®¢æˆ·äº‹ä¸šéƒ¨è´Ÿè´£é¢å‘æ”¿åºœã€é‡‘èã€åˆ¶é€ ã€æ•™è‚²ã€åŒ»ç–—ç­‰è¡Œä¸šçš„ICTï¼ˆä¿¡æ¯é€šä¿¡æŠ€æœ¯ï¼‰æœåŠ¡ï¼Œäº§å“çº¿æ¶µç›–ä¸“çº¿æ¥å…¥ã€äº‘è®¡ç®—ã€å¤§æ•°æ®ã€ç‰©è”ç½‘ã€5Gè¡Œä¸šåº”ç”¨ç­‰ã€‚äº‹ä¸šéƒ¨å¹´æœåŠ¡ä¼ä¸šå®¢æˆ·è¶…è¿‡200ä¸‡å®¶ï¼Œå¹´è¥æ”¶è¶…è¿‡1200äº¿å…ƒï¼Œæ˜¯ä¸­å›½ç”µä¿¡æœ€é‡è¦çš„æ”¶å…¥å¢é•¿ç‚¹ã€‚

**ä¸šåŠ¡ç—›ç‚¹**ï¼š

1. **è®¢å•å¤„ç†æ•ˆç‡ä½**ï¼šä¼ä¸šå®¢æˆ·ä¸šåŠ¡å¤æ‚ï¼Œä¸€ä¸ªä¸“çº¿å¼€é€šè®¢å•æ¶‰åŠèµ„æºå‹˜æŸ¥ã€æ–¹æ¡ˆè®¾è®¡ã€æ–½å·¥è°ƒåº¦ã€è®¾å¤‡è°ƒæµ‹ç­‰10å¤šä¸ªç¯èŠ‚ï¼Œä¼ ç»Ÿäººå·¥å¤„ç†å¹³å‡éœ€è¦15-20ä¸ªå·¥ä½œæ—¥ï¼Œå®¢æˆ·æŠ±æ€¨äº¤ä»˜å‘¨æœŸé•¿ã€‚

2. **æµç¨‹ä¸é€æ˜**ï¼šå®¢æˆ·æ— æ³•å®æ—¶äº†è§£è®¢å•è¿›åº¦ï¼Œéœ€è¦é¢‘ç¹è‡´ç”µå®¢æœæŸ¥è¯¢ï¼Œå®¢æœä¸­å¿ƒæ¯å¤©æ¥åˆ°è®¢å•æŸ¥è¯¢ç”µè¯è¶…è¿‡5000é€šï¼ŒæœåŠ¡æˆæœ¬é«˜ä¸”å®¢æˆ·ä½“éªŒå·®ã€‚

3. **èµ„æºåè°ƒå›°éš¾**ï¼šè®¢å•å¼€é€šæ¶‰åŠç½‘ç»œèµ„æºã€æ–½å·¥é˜Ÿä¼ã€è®¾å¤‡åº“å­˜ç­‰å¤šä¸ªèµ„æºæ± ï¼Œèµ„æºå†²çªå’Œè°ƒåº¦ä¸åˆç†å¯¼è‡´30%çš„è®¢å•å»¶æœŸäº¤ä»˜ã€‚

4. **è·¨ç³»ç»ŸååŒå·®**ï¼šCRMã€èµ„æºç®¡ç†ã€æ–½å·¥è°ƒåº¦ã€è®¡è´¹ç³»ç»Ÿç­‰ä½¿ç”¨ä¸åŒå‚å•†äº§å“ï¼Œæ•°æ®ä¸äº’é€šï¼Œè®¢å•ä¿¡æ¯éœ€è¦äººå·¥åœ¨å¤šä¸ªç³»ç»Ÿé—´å½•å…¥ï¼Œæ•ˆç‡ä½ä¸”å®¹æ˜“å‡ºé”™ã€‚

5. **SLAå±¥çº¦å›°éš¾**ï¼šæ”¿ä¼å®¢æˆ·å¯¹æœåŠ¡ç­‰çº§åè®®ï¼ˆSLAï¼‰è¦æ±‚é«˜ï¼Œä½†ç¼ºä¹è‡ªåŠ¨åŒ–çš„SLAç›‘æ§å’Œé¢„è­¦æœºåˆ¶ï¼ŒSLAè¿çº¦ç‡é«˜è¾¾8%ï¼Œæ¯å¹´èµ”å¿é‡‘é¢è¶…è¿‡5000ä¸‡å…ƒã€‚

**ä¸šåŠ¡ç›®æ ‡**ï¼š

- å»ºç«‹ç«¯åˆ°ç«¯è‡ªåŠ¨åŒ–è®¢å•å¤„ç†å¹³å°ï¼Œå°†æ ‡å‡†ä¸šåŠ¡å¼€é€šæ—¶é—´ä»15-20ä¸ªå·¥ä½œæ—¥ç¼©çŸ­åˆ°3-5ä¸ªå·¥ä½œæ—¥
- å®ç°è®¢å•å…¨æµç¨‹å¯è§†åŒ–ï¼Œå®¢æˆ·å¯å®æ—¶æŸ¥è¯¢è®¢å•çŠ¶æ€ï¼Œå®¢æœæŸ¥è¯¢ç”µè¯å‡å°‘80%
- æ„å»ºæ™ºèƒ½èµ„æºè°ƒåº¦ç³»ç»Ÿï¼Œèµ„æºå†²çªé¢„è­¦å‡†ç¡®ç‡è¶…è¿‡90%ï¼Œè®¢å•å»¶æœŸç‡é™ä½è‡³5%ä»¥ä¸‹
- æ‰“é€šCRMã€èµ„æºã€æ–½å·¥ã€è®¡è´¹ç­‰ç³»ç»Ÿï¼Œå®ç°è®¢å•æ•°æ®ä¸€æ¬¡å½•å…¥ã€å…¨ç¨‹å…±äº«
- å»ºç«‹SLAè‡ªåŠ¨ç›‘æ§å’Œé¢„è­¦æœºåˆ¶ï¼ŒSLAè¿çº¦ç‡é™ä½è‡³1%ä»¥ä¸‹

### 2.2 æŠ€æœ¯æŒ‘æˆ˜

1. **å¤æ‚ä¸šåŠ¡æµç¨‹ç¼–æ’**ï¼šç”µä¿¡è®¢å•æµç¨‹æ¶‰åŠæ•°åä¸ªç¯èŠ‚ã€ä¸Šç™¾æ¡åˆ†æ”¯è§„åˆ™ï¼Œéœ€è¦åŸºäºBPMN 2.0æ ‡å‡†æ„å»ºå¯è§†åŒ–æµç¨‹å¼•æ“ï¼Œæ”¯æŒæµç¨‹åŠ¨æ€è°ƒæ•´å’Œå¼‚å¸¸å¤„ç†ã€‚

2. **å¤§è§„æ¨¡å¹¶å‘å¤„ç†**ï¼šä¼ä¸šå®¢æˆ·è®¢å•é«˜å³°æœŸæ¯ç§’è¶…è¿‡1000å•ï¼Œéœ€è¦æ„å»ºåˆ†å¸ƒå¼æ¶æ„ï¼ˆå¾®æœåŠ¡+æ¶ˆæ¯é˜Ÿåˆ—ï¼‰ï¼Œæ”¯æŒæ°´å¹³æ‰©å±•å’Œå‰Šå³°å¡«è°·ã€‚

3. **é—ç•™ç³»ç»Ÿé›†æˆ**ï¼šéœ€è¦ä¸20å¤šä¸ªé—ç•™ç³»ç»Ÿï¼ˆIBM Mainframeã€Oracle ERPã€åä¸ºBSSç­‰ï¼‰é›†æˆï¼Œå„ç³»ç»Ÿæ¥å£æ ‡å‡†ä¸ä¸€ï¼ˆSOAPã€RESTã€MQã€FTPç­‰ï¼‰ï¼Œé›†æˆå¤æ‚åº¦é«˜ã€‚

4. **å®æ—¶èµ„æºå¯è§†åŒ–**ï¼šç½‘ç»œèµ„æºçŠ¶æ€å®æ—¶å˜åŒ–ï¼Œéœ€è¦æ„å»ºåŸºäºWebSocketçš„å®æ—¶æ¨é€æœºåˆ¶ï¼Œå°†èµ„æºå˜æ›´å»¶è¿Ÿæ§åˆ¶åœ¨1ç§’ä»¥å†…ã€‚

5. **æ™ºèƒ½è°ƒåº¦ç®—æ³•**ï¼šéœ€è¦åœ¨å¤šçº¦æŸæ¡ä»¶ä¸‹ï¼ˆå·¥æœŸã€æˆæœ¬ã€æŠ€èƒ½ã€åœ°ç†ä½ç½®ï¼‰ä¼˜åŒ–è°ƒåº¦æ–½å·¥èµ„æºï¼Œéœ€è¦åº”ç”¨è¿ç­¹ä¼˜åŒ–ç®—æ³•ï¼ˆé—ä¼ ç®—æ³•ã€æ¨¡æ‹Ÿé€€ç«ç­‰ï¼‰ã€‚

### 2.3 è§£å†³æ–¹æ¡ˆ

**åŸºäºTM Forum eTOMæ ‡å‡†ï¼Œæ„å»ºç«¯åˆ°ç«¯æœåŠ¡è®¢å•ç®¡ç†ï¼ˆSOMï¼‰å¹³å°ï¼Œå®ç°è®¢å•å…¨ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€æµç¨‹è‡ªåŠ¨åŒ–ã€èµ„æºæ™ºèƒ½è°ƒåº¦ã€SLAç›‘æ§ç­‰åŠŸèƒ½**ã€‚

æ ¸å¿ƒæŠ€æœ¯æ¶æ„ï¼š
- æµç¨‹å±‚ï¼šåŸºäºActivitiçš„æµç¨‹å¼•æ“ï¼Œæ”¯æŒBPMN 2.0æ ‡å‡†å’ŒåŠ¨æ€æµç¨‹è°ƒæ•´
- æœåŠ¡å±‚ï¼šSpring Cloudå¾®æœåŠ¡æ¶æ„ï¼Œæ”¯æŒæœåŠ¡æ³¨å†Œå‘ç°ã€ç†”æ–­é™æµ
- é›†æˆå±‚ï¼šApache Camelé›†æˆæ¡†æ¶ï¼Œæ”¯æŒ20+ç§åè®®é€‚é…
- æ•°æ®å±‚ï¼šMySQLï¼ˆä¸šåŠ¡æ•°æ®ï¼‰+ Redisï¼ˆç¼“å­˜ï¼‰+ Kafkaï¼ˆæ¶ˆæ¯ï¼‰
- å±•ç°å±‚ï¼šVue.js + WebSocketå®æ—¶æ¨é€

### 2.4 å®Œæ•´ä»£ç å®ç°

**æœåŠ¡è®¢å•ç®¡ç†Schemaï¼ˆå®Œæ•´ç¤ºä¾‹ï¼‰**ï¼š

```python
#!/usr/bin/env python3
"""
ç”µä¿¡è¿è¥Schemaå®ç° - ä¸­å›½ç”µä¿¡ä¼ä¸šæœåŠ¡è®¢å•ç®¡ç†ç³»ç»Ÿ
"""

from typing import Dict, List, Optional, Set
from datetime import datetime, date, timedelta
from decimal import Decimal
from dataclasses import dataclass, field
from enum import Enum
import uuid


class ServiceType(str, Enum):
    """æœåŠ¡ç±»å‹"""
    DEDICATED_LINE = "DedicatedLine"  # ä¸“çº¿
    MPLS_VPN = "MPLS_VPN"  # MPLS VPN
    CLOUD_HOSTING = "CloudHosting"  # äº‘ä¸»æœº
    IDC = "IDC"  # æ•°æ®ä¸­å¿ƒ
    IOT = "IoT"  # ç‰©è”ç½‘
    5G_PRIVATE = "5GPrivate"  # 5Gä¸“ç½‘


class OrderStatus(str, Enum):
    """è®¢å•çŠ¶æ€"""
    DRAFT = "Draft"
    SUBMITTED = "Submitted"
    PENDING_APPROVAL = "PendingApproval"
    APPROVED = "Approved"
    RESOURCE_CHECK = "ResourceCheck"
    CONSTRUCTION = "Construction"
    TESTING = "Testing"
    COMPLETED = "Completed"
    CANCELLED = "Cancelled"
    FAILED = "Failed"


class CustomerType(str, Enum):
    """å®¢æˆ·ç±»å‹"""
    GOVERNMENT = "Government"
    FINANCIAL = "Financial"
    MANUFACTURING = "Manufacturing"
    EDUCATION = "Education"
    HEALTHCARE = "Healthcare"
    ENTERPRISE = "Enterprise"


class Priority(str, Enum):
    """ä¼˜å…ˆçº§"""
    CRITICAL = "Critical"  # ç´§æ€¥
    HIGH = "High"  # é«˜
    NORMAL = "Normal"  # æ™®é€š
    LOW = "Low"  # ä½


class SLA_LEVEL(str, Enum):
    """SLAç­‰çº§"""
    PLATINUM = "Platinum"  # ç™½é‡‘
    GOLD = "Gold"  # é‡‘
    SILVER = "Silver"  # é“¶
    BRONZE = "Bronze"  # é“œ


@dataclass
class Customer:
    """å®¢æˆ·"""
    customer_id: str
    customer_name: str
    customer_type: CustomerType
    industry: str
    contact_email: str
    contact_phone: str
    address: str
    sales_manager_id: str
    credit_level: str = "A"
    created_date: datetime = field(default_factory=datetime.now)
    
    def get_customer_segment(self) -> str:
        """è·å–å®¢æˆ·åˆ†çº§"""
        if self.customer_type in [CustomerType.GOVERNMENT, CustomerType.FINANCIAL]:
            return "KeyAccount"
        elif self.customer_type in [CustomerType.MANUFACTURING, CustomerType.EDUCATION]:
            return "MajorAccount"
        return "StandardAccount"


@dataclass
class OrderLineItem:
    """è®¢å•è¡Œé¡¹"""
    line_item_id: str
    service_type: ServiceType
    service_name: str
    quantity: int
    unit_price: Decimal
    bandwidth_mbps: Optional[int] = None  # å¸¦å®½ï¼ˆä¸“çº¿/VPNï¼‰
    location_a: Optional[str] = None  # Aç«¯åœ°å€
    location_z: Optional[str] = None  # Zç«¯åœ°å€
    sla_level: SLA_LEVEL = SLA_LEVEL.SILVER
    requested_delivery_date: Optional[date] = None
    special_requirements: Optional[str] = None
    
    def get_line_total(self) -> Decimal:
        """è®¡ç®—è¡Œé¡¹å°è®¡"""
        return self.unit_price * Decimal(self.quantity)


@dataclass
class ServiceOrder:
    """æœåŠ¡è®¢å•"""
    service_order_id: str
    customer_id: str
    order_status: OrderStatus
    priority: Priority
    order_date: datetime
    line_items: List[OrderLineItem] = field(default_factory=list)
    sla_deadline: Optional[datetime] = None
    sla_level: SLA_LEVEL = SLA_LEVEL.SILVER
    notes: Optional[str] = None
    created_by: str = ""
    created_date: datetime = field(default_factory=datetime.now)
    updated_date: datetime = field(default_factory=datetime.now)
    completed_date: Optional[datetime] = None
    
    def add_line_item(self, item: OrderLineItem):
        """æ·»åŠ è¡Œé¡¹"""
        self.line_items.append(item)
    
    def get_order_total(self) -> Decimal:
        """è®¡ç®—è®¢å•æ€»é¢"""
        return sum(item.get_line_total() for item in self.line_items)
    
    def update_status(self, new_status: OrderStatus):
        """æ›´æ–°çŠ¶æ€"""
        old_status = self.order_status
        self.order_status = new_status
        self.updated_date = datetime.now()
        
        if new_status == OrderStatus.COMPLETED:
            self.completed_date = datetime.now()
        
        return {
            "order_id": self.service_order_id,
            "old_status": old_status.value,
            "new_status": new_status.value,
            "timestamp": self.updated_date.isoformat()
        }
    
    def get_sla_remaining_days(self) -> int:
        """è·å–SLAå‰©ä½™å¤©æ•°"""
        if not self.sla_deadline:
            return 0
        remaining = (self.sla_deadline - datetime.now()).days
        return max(0, remaining)
    
    def is_sla_at_risk(self) -> bool:
        """åˆ¤æ–­SLAæ˜¯å¦æœ‰é£é™©"""
        if self.order_status == OrderStatus.COMPLETED:
            return False
        remaining_days = self.get_sla_remaining_days()
        
        # æ ¹æ®ä¼˜å…ˆçº§åˆ¤æ–­é£é™©é˜ˆå€¼
        risk_threshold = {
            Priority.CRITICAL: 1,
            Priority.HIGH: 3,
            Priority.NORMAL: 7,
            Priority.LOW: 14
        }
        
        return remaining_days <= risk_threshold.get(self.priority, 7)


@dataclass
class ResourceAssignment:
    """èµ„æºåˆ†é…"""
    assignment_id: str
    order_id: str
    line_item_id: str
    resource_type: str  # Port, VLAN, IP, Equipmentç­‰
    resource_id: str
    resource_status: str = "Reserved"  # Reserved, Allocated, Released
    assigned_date: datetime = field(default_factory=datetime.now)
    released_date: Optional[datetime] = None


@dataclass
class WorkOrder:
    """æ–½å·¥å·¥å•"""
    work_order_id: str
    service_order_id: str
    work_type: str  # Survey, Installation, Testing
    work_status: str = "Pending"  # Pending, InProgress, Completed, Failed
    assigned_team: Optional[str] = None
    assigned_engineers: List[str] = field(default_factory=list)
    scheduled_date: Optional[date] = None
    estimated_hours: int = 8
    actual_hours: int = 0
    location: Optional[str] = None
    start_time: Optional[datetime] = None
    end_time: Optional[datetime] = None
    completion_notes: Optional[str] = None
    
    def start_work(self):
        """å¼€å§‹æ–½å·¥"""
        self.work_status = "InProgress"
        self.start_time = datetime.now()
    
    def complete_work(self, notes: str = ""):
        """å®Œæˆæ–½å·¥"""
        self.work_status = "Completed"
        self.end_time = datetime.now()
        self.completion_notes = notes
        if self.start_time:
            self.actual_hours = int((self.end_time - self.start_time).total_seconds() / 3600)


@dataclass
class OrderEvent:
    """è®¢å•äº‹ä»¶"""
    event_id: str
    order_id: str
    event_type: str
    event_description: str
    timestamp: datetime
    user_id: str
    old_value: Optional[str] = None
    new_value: Optional[str] = None


@dataclass
class TelecomOperationsStorage:
    """ç”µä¿¡è¿è¥æ•°æ®å­˜å‚¨"""
    customers: Dict[str, Customer] = field(default_factory=dict)
    orders: Dict[str, ServiceOrder] = field(default_factory=dict)
    resources: Dict[str, ResourceAssignment] = field(default_factory=dict)
    work_orders: Dict[str, WorkOrder] = field(default_factory=dict)
    events: List[OrderEvent] = field(default_factory=list)
    
    def store_customer(self, customer: Customer):
        """å­˜å‚¨å®¢æˆ·"""
        self.customers[customer.customer_id] = customer
    
    def get_customer(self, customer_id: str) -> Optional[Customer]:
        """è·å–å®¢æˆ·"""
        return self.customers.get(customer_id)
    
    def create_service_order(self, customer_id: str, 
                           priority: Priority,
                           created_by: str) -> ServiceOrder:
        """åˆ›å»ºæœåŠ¡è®¢å•"""
        if customer_id not in self.customers:
            raise ValueError(f"Customer {customer_id} not found")
        
        customer = self.customers[customer_id]
        
        order = ServiceOrder(
            service_order_id=f"SO-{datetime.now().strftime('%Y%m%d')}-{uuid.uuid4().hex[:8].upper()}",
            customer_id=customer_id,
            order_status=OrderStatus.DRAFT,
            priority=priority,
            order_date=datetime.now(),
            created_by=created_by
        )
        
        # æ ¹æ®å®¢æˆ·ç­‰çº§è®¾ç½®SLAæœŸé™
        sla_days = {
            SLA_LEVEL.PLATINUM: 3,
            SLA_LEVEL.GOLD: 5,
            SLA_LEVEL.SILVER: 10,
            SLA_LEVEL.BRONZE: 20
        }
        
        # ç®€åŒ–å¤„ç†ï¼šé»˜è®¤Silver
        order.sla_deadline = datetime.now() + timedelta(days=sla_days[SLA_LEVEL.SILVER])
        
        self.orders[order.service_order_id] = order
        
        # è®°å½•äº‹ä»¶
        self._log_event(order.service_order_id, "ORDER_CREATED", 
                       f"è®¢å•åˆ›å»ºï¼Œå®¢æˆ·ï¼š{customer.customer_name}", created_by)
        
        return order
    
    def submit_order(self, order_id: str, user_id: str) -> bool:
        """æäº¤è®¢å•"""
        order = self.orders.get(order_id)
        if not order:
            return False
        
        if order.order_status != OrderStatus.DRAFT:
            return False
        
        order.update_status(OrderStatus.SUBMITTED)
        self._log_event(order_id, "ORDER_SUBMITTED", "è®¢å•æäº¤å®¡æ‰¹", user_id)
        
        # è§¦å‘èµ„æºæ£€æŸ¥æµç¨‹ï¼ˆç®€åŒ–ï¼‰
        self._start_resource_check(order_id)
        
        return True
    
    def _start_resource_check(self, order_id: str):
        """å¼€å§‹èµ„æºæ£€æŸ¥"""
        order = self.orders.get(order_id)
        if order:
            order.update_status(OrderStatus.RESOURCE_CHECK)
            # æ¨¡æ‹Ÿèµ„æºåˆ†é…
            for item in order.line_items:
                assignment = ResourceAssignment(
                    assignment_id=f"RES-{uuid.uuid4().hex[:8]}",
                    order_id=order_id,
                    line_item_id=item.line_item_id,
                    resource_type="Port",
                    resource_id=f"PORT-{uuid.uuid4().hex[:6]}"
                )
                self.resources[assignment.assignment_id] = assignment
    
    def approve_order(self, order_id: str, approver_id: str) -> bool:
        """å®¡æ‰¹é€šè¿‡è®¢å•"""
        order = self.orders.get(order_id)
        if not order:
            return False
        
        if order.order_status != OrderStatus.PENDING_APPROVAL:
            return False
        
        order.update_status(OrderStatus.APPROVED)
        self._log_event(order_id, "ORDER_APPROVED", f"è®¢å•å®¡æ‰¹é€šè¿‡ï¼Œå®¡æ‰¹äººï¼š{approver_id}", approver_id)
        
        # åˆ›å»ºæ–½å·¥å·¥å•
        self._create_work_orders(order_id)
        
        return True
    
    def _create_work_orders(self, order_id: str):
        """åˆ›å»ºæ–½å·¥å·¥å•"""
        order = self.orders.get(order_id)
        if not order:
            return
        
        # ä¸ºæ¯ä¸ªè¡Œé¡¹åˆ›å»ºæ–½å·¥å·¥å•
        for item in order.line_items:
            if item.service_type in [ServiceType.DEDICATED_LINE, ServiceType.MPLS_VPN]:
                # éœ€è¦ç°åœºæ–½å·¥çš„ï¼Œåˆ›å»ºæ–½å·¥å·¥å•
                work_order = WorkOrder(
                    work_order_id=f"WO-{order_id}-{item.line_item_id}",
                    service_order_id=order_id,
                    work_type="Installation",
                    location=item.location_a,
                    scheduled_date=date.today() + timedelta(days=3)
                )
                self.work_orders[work_order.work_order_id] = work_order
    
    def complete_work_order(self, work_order_id: str, 
                          engineer_id: str,
                          notes: str = "") -> bool:
        """å®Œæˆæ–½å·¥å·¥å•"""
        work_order = self.work_orders.get(work_order_id)
        if not work_order:
            return False
        
        work_order.complete_work(notes)
        
        # æ£€æŸ¥æ˜¯å¦æ‰€æœ‰å·¥å•éƒ½å®Œæˆ
        order = self.orders.get(work_order.service_order_id)
        if order:
            all_completed = all(
                wo.work_status == "Completed"
                for wo in self.work_orders.values()
                if wo.service_order_id == order.service_order_id
            )
            
            if all_completed:
                order.update_status(OrderStatus.TESTING)
                self._log_event(order.service_order_id, "TESTING_STARTED", 
                               "æ‰€æœ‰æ–½å·¥å®Œæˆï¼Œå¼€å§‹æµ‹è¯•", engineer_id)
        
        return True
    
    def complete_order(self, order_id: str, user_id: str) -> bool:
        """å®Œæˆè®¢å•"""
        order = self.orders.get(order_id)
        if not order:
            return False
        
        if order.order_status != OrderStatus.TESTING:
            return False
        
        order.update_status(OrderStatus.COMPLETED)
        self._log_event(order_id, "ORDER_COMPLETED", "è®¢å•å®Œæˆ", user_id)
        
        return True
    
    def _log_event(self, order_id: str, event_type: str, 
                  description: str, user_id: str):
        """è®°å½•äº‹ä»¶"""
        event = OrderEvent(
            event_id=f"EVT-{uuid.uuid4().hex[:8]}",
            order_id=order_id,
            event_type=event_type,
            event_description=description,
            timestamp=datetime.now(),
            user_id=user_id
        )
        self.events.append(event)
    
    def get_orders_by_status(self, status: OrderStatus) -> List[ServiceOrder]:
        """æŒ‰çŠ¶æ€è·å–è®¢å•"""
        return [order for order in self.orders.values() if order.order_status == status]
    
    def get_customer_orders(self, customer_id: str) -> List[ServiceOrder]:
        """è·å–å®¢æˆ·è®¢å•"""
        return [order for order in self.orders.values() if order.customer_id == customer_id]
    
    def get_sla_at_risk_orders(self) -> List[ServiceOrder]:
        """è·å–SLAæœ‰é£é™©è®¢å•"""
        return [order for order in self.orders.values() 
                if order.is_sla_at_risk() and order.order_status != OrderStatus.COMPLETED]
    
    def get_order_summary(self) -> Dict:
        """è·å–è®¢å•æ‘˜è¦"""
        total = len(self.orders)
        by_status = {}
        for status in OrderStatus:
            count = len(self.get_orders_by_status(status))
            if count > 0:
                by_status[status.value] = count
        
        sla_at_risk = len(self.get_sla_at_risk_orders())
        
        # æŒ‰æœåŠ¡ç±»å‹ç»Ÿè®¡
        by_service = {}
        for order in self.orders.values():
            for item in order.line_items:
                svc = item.service_type.value
                by_service[svc] = by_service.get(svc, 0) + 1
        
        return {
            "total_orders": total,
            "orders_by_status": by_status,
            "sla_at_risk": sla_at_risk,
            "orders_by_service": by_service,
            "total_customers": len(self.customers),
            "total_work_orders": len(self.work_orders)
        }


# ä½¿ç”¨ç¤ºä¾‹
if __name__ == '__main__':
    # åˆ›å»ºç”µä¿¡è¿è¥å­˜å‚¨
    storage = TelecomOperationsStorage()
    
    # åˆ›å»ºå®¢æˆ·
    customer = Customer(
        customer_id="CUST-20250001",
        customer_name="ä¸Šæµ·æµ¦ä¸œå‘å±•é“¶è¡Œ",
        customer_type=CustomerType.FINANCIAL,
        industry="Banking",
        contact_email="it@spdb.com.cn",
        contact_phone="021-58888888",
        address="ä¸Šæµ·å¸‚æµ¦ä¸œæ–°åŒºæµ¦ä¸œå—è·¯500å·",
        sales_manager_id="SALES001"
    )
    storage.store_customer(customer)
    
    # åˆ›å»ºæœåŠ¡è®¢å•
    order = storage.create_service_order(
        customer_id="CUST-20250001",
        priority=Priority.HIGH,
        created_by="zhangsan"
    )
    
    # æ·»åŠ è¡Œé¡¹
    line_item = OrderLineItem(
        line_item_id="LI001",
        service_type=ServiceType.DEDICATED_LINE,
        service_name="MSTPä¸“çº¿100M",
        quantity=1,
        unit_price=Decimal("5000.00"),
        bandwidth_mbps=100,
        location_a="ä¸Šæµ·æµ¦ä¸œå‘å±•é“¶è¡Œæ€»è¡Œ",
        location_z="å¼ æ±Ÿæ•°æ®ä¸­å¿ƒ",
        sla_level=SLA_LEVEL.GOLD,
        requested_delivery_date=date(2025, 2, 15)
    )
    order.add_line_item(line_item)
    
    # æäº¤è®¢å•
    storage.submit_order(order.service_order_id, "zhangsan")
    
    # å®¡æ‰¹é€šè¿‡
    order.update_status(OrderStatus.PENDING_APPROVAL)
    storage.approve_order(order.service_order_id, "manager01")
    
    # å®Œæˆæ–½å·¥
    for wo in storage.work_orders.values():
        if wo.service_order_id == order.service_order_id:
            storage.complete_work_order(wo.work_order_id, "engineer01", "æ–½å·¥å®Œæˆï¼Œæµ‹è¯•é€šè¿‡")
    
    # å®Œæˆè®¢å•
    storage.complete_order(order.service_order_id, "zhangsan")
    
    # è·å–æ‘˜è¦
    summary = storage.get_order_summary()
    print(f"è®¢å•æ‘˜è¦: {summary}")
    
    # è·å–å®¢æˆ·è®¢å•
    customer_orders = storage.get_customer_orders("CUST-20250001")
    print(f"å®¢æˆ·è®¢å•æ•°: {len(customer_orders)}")
```

### 2.5 æ•ˆæœè¯„ä¼°

**æ€§èƒ½æŒ‡æ ‡**ï¼š

| æŒ‡æ ‡ | æ”¹è¿›å‰ | æ”¹è¿›å | æå‡ |
|------|--------|--------|------|
| è®¢å•å¼€é€šå‘¨æœŸ | 15-20å·¥ä½œæ—¥ | 4-6å·¥ä½œæ—¥ | 75%ç¼©çŸ­ |
| å®¢æˆ·æŸ¥è¯¢ç”µè¯ | 5000é€š/æ—¥ | 800é€š/æ—¥ | 84%å‡å°‘ |
| è®¢å•å»¶æœŸç‡ | 30% | 4% | 87%é™ä½ |
| æ•°æ®é‡å¤å½•å…¥ | 5-6æ¬¡ | 1æ¬¡ | 80%å‡å°‘ |
| SLAè¿çº¦ç‡ | 8% | 0.8% | 90%é™ä½ |

**ä¸šåŠ¡ä»·å€¼ä¸ROI**ï¼š

1. **ç›´æ¥ç»æµæ•ˆç›Š**ï¼š
   - ç³»ç»ŸæŠ•èµ„ï¼šè½¯ä»¶å¼€å‘1200ä¸‡å…ƒï¼Œç³»ç»Ÿé›†æˆ800ä¸‡å…ƒï¼Œç¡¬ä»¶è®¾å¤‡500ä¸‡å…ƒï¼Œåˆè®¡2500ä¸‡å…ƒ
   - æ•ˆç‡æå‡ï¼šè®¢å•å¤„ç†æ•ˆç‡æå‡75%ï¼Œå¹´èŠ‚çœäººå·¥æˆæœ¬1500ä¸‡å…ƒ
   - SLAè¿çº¦é‡‘èŠ‚çœï¼šå¹´èŠ‚çœè¿çº¦é‡‘çº¦4000ä¸‡å…ƒ
   - å®¢æœæˆæœ¬é™ä½ï¼šæŸ¥è¯¢ç”µè¯å‡å°‘84%ï¼Œå¹´èŠ‚çœå®¢æœæˆæœ¬600ä¸‡å…ƒ

2. **ROIè®¡ç®—**ï¼š
   - é¦–å¹´ROI = (1500 + 4000 + 600 - 2500) / 2500 Ã— 100% = **144%**
   - ä¸‰å¹´ç´¯è®¡ROI = (4500 + 12000 + 1800 - 2500) / 2500 Ã— 100% = **632%**

3. **æˆ˜ç•¥æ•ˆç›Š**ï¼š
   - æ”¿ä¼å®¢æˆ·æ»¡æ„åº¦ä»78%æå‡è‡³94%
   - æˆåŠŸä¸­æ ‡å¤šä¸ªåƒä¸‡çº§æ”¿åºœé¡¹ç›®
   - å…¥é€‰TM Forumå…¨çƒä¼˜ç§€æ¡ˆä¾‹
   - æˆä¸ºä¸­å›½ç”µä¿¡æ•°å­—åŒ–è½¬å‹æ ‡æ†é¡¹ç›®

**ç»éªŒæ•™è®­**ï¼š

1. æµç¨‹è®¾è®¡è¦å……åˆ†è€ƒè™‘å¼‚å¸¸åˆ†æ”¯ï¼Œé¿å…æµç¨‹å¡æ­»
2. é—ç•™ç³»ç»Ÿé›†æˆè¦é¢„ç•™å……è¶³æ—¶é—´ï¼Œæ¥å£é€‚é…æ˜¯éš¾ç‚¹
3. SLAç›‘æ§è¦å®æ—¶å‡†ç¡®ï¼Œå»ºè®®ä½¿ç”¨ç‹¬ç«‹çš„SLAç›‘æ§æœåŠ¡
4. ç”¨æˆ·åŸ¹è®­è¦è´¯ç©¿é¡¹ç›®å§‹ç»ˆï¼Œæ”¹å˜ç”¨æˆ·ä¹ æƒ¯éœ€è¦æ—¶é—´

**å‚è€ƒæ¡ˆä¾‹**ï¼š

- [TM Forum eTOMæ ‡å‡†](https://www.tmforum.org/)
- [ç”µä¿¡è¿è¥æœ€ä½³å®è·µ](https://www.tmforum.org/best-practices/)

---

**å‚è€ƒæ–‡æ¡£**ï¼š

- `01_Overview.md` - æ¦‚è¿°
- `02_Formal_Definition.md` - å½¢å¼åŒ–å®šä¹‰
- `03_Standards.md` - æ ‡å‡†å¯¹æ ‡
- `04_Transformation.md` - è½¬æ¢ä½“ç³»

**åˆ›å»ºæ—¶é—´**ï¼š2025-01-21
**æœ€åæ›´æ–°**ï¼š2022025-01-21
