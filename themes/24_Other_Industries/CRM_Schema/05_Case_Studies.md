# å®¢æˆ·å…³ç³»ç®¡ç†Schemaå®è·µæ¡ˆä¾‹

## ğŸ“‘ ç›®å½•

- [å®¢æˆ·å…³ç³»ç®¡ç†Schemaå®è·µæ¡ˆä¾‹](#å®¢æˆ·å…³ç³»ç®¡ç†schemaå®è·µæ¡ˆä¾‹)
  - [ğŸ“‘ ç›®å½•](#-ç›®å½•)
  - [1. æ¡ˆä¾‹æ¦‚è¿°](#1-æ¡ˆä¾‹æ¦‚è¿°)
  - [2. æ¡ˆä¾‹1ï¼šä¼ä¸šå®¢æˆ·ç®¡ç†ç³»ç»Ÿ](#2-æ¡ˆä¾‹1ä¼ä¸šå®¢æˆ·ç®¡ç†ç³»ç»Ÿ)
    - [2.1 ä¸šåŠ¡èƒŒæ™¯](#21-ä¸šåŠ¡èƒŒæ™¯)
    - [2.2 æŠ€æœ¯æŒ‘æˆ˜](#22-æŠ€æœ¯æŒ‘æˆ˜)
    - [2.3 è§£å†³æ–¹æ¡ˆ](#23-è§£å†³æ–¹æ¡ˆ)
    - [2.4 å®Œæ•´ä»£ç å®ç°](#24-å®Œæ•´ä»£ç å®ç°)
    - [2.5 æ•ˆæœè¯„ä¼°](#25-æ•ˆæœè¯„ä¼°)

---

## 1. æ¡ˆä¾‹æ¦‚è¿°

æœ¬æ–‡æ¡£æä¾›CRM Schemaåœ¨å®é™…ä¼ä¸šåº”ç”¨ä¸­çš„å®è·µæ¡ˆä¾‹ï¼Œæ¶µç›–å®¢æˆ·ç®¡ç†ã€é”€å”®æœºä¼šç®¡ç†ã€å®¢æˆ·æœåŠ¡ç®¡ç†ç­‰çœŸå®åœºæ™¯ã€‚

**æ¡ˆä¾‹ç±»å‹**ï¼š

1. **ä¼ä¸šå®¢æˆ·ç®¡ç†ç³»ç»Ÿ**ï¼šå®¢æˆ·è´¦æˆ·ã€è”ç³»äººå’Œå•†æœºç®¡ç†
2. **é”€å”®æœºä¼šç®¡ç†ç³»ç»Ÿ**ï¼šé”€å”®æœºä¼šè·Ÿè¸ªå’Œé¢„æµ‹
3. **å®¢æˆ·æœåŠ¡ç®¡ç†ç³»ç»Ÿ**ï¼šå®¢æˆ·æœåŠ¡å·¥å•å’ŒçŸ¥è¯†åº“ç®¡ç†
4. **CRMæ•°æ®å­˜å‚¨ä¸åˆ†æç³»ç»Ÿ**ï¼šCRMæ•°æ®åˆ†æå’Œç›‘æ§
5. **CRMåˆ°ERPé›†æˆç³»ç»Ÿ**ï¼šCRMä¸ERPç³»ç»Ÿé›†æˆ

**å‚è€ƒä¼ä¸šæ¡ˆä¾‹**ï¼š

- **Salesforce CRM**ï¼šSalesforce CRMæœ€ä½³å®è·µ
- **Microsoft Dynamics CRM**ï¼šDynamics CRMå®æ–½æŒ‡å—

---

## 2. æ¡ˆä¾‹1ï¼šä¼ä¸šå®¢æˆ·ç®¡ç†ç³»ç»Ÿ

### 2.1 ä¸šåŠ¡èƒŒæ™¯

**ä¼ä¸šèƒŒæ™¯**ï¼š
æŸB2Bä¼ä¸šéœ€è¦æ„å»ºå®¢æˆ·ç®¡ç†ç³»ç»Ÿï¼Œç®¡ç†å®¢æˆ·è´¦æˆ·ã€è”ç³»äººã€å•†æœºä¿¡æ¯ï¼Œæé«˜é”€å”®æ•ˆç‡å’Œå®¢æˆ·æ»¡æ„åº¦ã€‚

**ä¸šåŠ¡ç—›ç‚¹**ï¼š

1. **å®¢æˆ·ä¿¡æ¯åˆ†æ•£**ï¼šå®¢æˆ·ä¿¡æ¯åˆ†æ•£åœ¨å„ä¸ªç³»ç»Ÿä¸­
2. **æ•°æ®ä¸ç»Ÿä¸€**ï¼šå®¢æˆ·æ•°æ®æ ¼å¼ä¸ç»Ÿä¸€
3. **è·Ÿè¸ªå›°éš¾**ï¼šé”€å”®æœºä¼šè·Ÿè¸ªå›°éš¾
4. **åˆ†æä¸è¶³**ï¼šå®¢æˆ·æ•°æ®åˆ†æä¸è¶³

**ä¸šåŠ¡ç›®æ ‡**ï¼š

- ç»Ÿä¸€å®¢æˆ·ä¿¡æ¯ç®¡ç†
- è§„èŒƒå®¢æˆ·æ•°æ®æ ¼å¼
- æé«˜é”€å”®æœºä¼šè·Ÿè¸ªæ•ˆç‡
- å¢å¼ºå®¢æˆ·æ•°æ®åˆ†æèƒ½åŠ›

### 2.2 æŠ€æœ¯æŒ‘æˆ˜

1. **å®¢æˆ·æ•°æ®æ¨¡å‹**ï¼šè®¾è®¡å®¢æˆ·æ•°æ®æ¨¡å‹
2. **æ•°æ®å­˜å‚¨**ï¼šé«˜æ•ˆå­˜å‚¨å®¢æˆ·æ•°æ®
3. **æ•°æ®æŸ¥è¯¢**ï¼šå¿«é€ŸæŸ¥è¯¢å®¢æˆ·ä¿¡æ¯
4. **æ•°æ®åŒæ­¥**ï¼šä¸å…¶ä»–ç³»ç»Ÿæ•°æ®åŒæ­¥

### 2.3 è§£å†³æ–¹æ¡ˆ

**ä½¿ç”¨CRM Schemaå®šä¹‰å®¢æˆ·ç®¡ç†ç³»ç»Ÿ**ï¼š

### 2.4 å®Œæ•´ä»£ç å®ç°

**å®¢æˆ·ç®¡ç†Schemaï¼ˆå®Œæ•´ç¤ºä¾‹ï¼‰**ï¼š

```python
#!/usr/bin/env python3
"""
CRM Schemaå®ç°
"""

from typing import Dict, List, Optional
from datetime import date, datetime
from decimal import Decimal
from dataclasses import dataclass, field
from enum import Enum

class AccountType(str, Enum):
    """è´¦æˆ·ç±»å‹"""
    CUSTOMER = "Customer"
    PROSPECT = "Prospect"
    PARTNER = "Partner"
    COMPETITOR = "Competitor"

class OpportunityStage(str, Enum):
    """å•†æœºé˜¶æ®µ"""
    PROSPECTING = "Prospecting"
    QUALIFICATION = "Qualification"
    NEEDS_ANALYSIS = "Needs Analysis"
    VALUE_PROPOSITION = "Value Proposition"
    ID_DECISION_MAKERS = "Id Decision Makers"
    PERCEPTION_ANALYSIS = "Perception Analysis"
    PROPOSAL_PRICE_QUOTE = "Proposal/Price Quote"
    NEGOTIATION_REVIEW = "Negotiation/Review"
    CLOSED_WON = "Closed Won"
    CLOSED_LOST = "Closed Lost"

@dataclass
class Contact:
    """è”ç³»äºº"""
    contact_id: str
    first_name: str
    last_name: str
    email: str
    phone: Optional[str] = None
    title: Optional[str] = None
    account_id: Optional[str] = None
    created_date: Optional[datetime] = None

@dataclass
class Account:
    """å®¢æˆ·è´¦æˆ·"""
    account_id: str
    account_name: str
    account_type: AccountType
    industry: Optional[str] = None
    annual_revenue: Optional[Decimal] = None
    number_of_employees: Optional[int] = None
    billing_address: Optional[str] = None
    shipping_address: Optional[str] = None
    website: Optional[str] = None
    created_date: Optional[datetime] = None
    contacts: List[Contact] = field(default_factory=list)

    def add_contact(self, contact: Contact):
        """æ·»åŠ è”ç³»äºº"""
        contact.account_id = self.account_id
        self.contacts.append(contact)

@dataclass
class Opportunity:
    """é”€å”®æœºä¼š"""
    opportunity_id: str
    opportunity_name: str
    account_id: str
    stage: OpportunityStage
    amount: Decimal
    probability: Decimal = Decimal('0')
    close_date: Optional[date] = None
    description: Optional[str] = None
    owner_id: Optional[str] = None
    created_date: Optional[datetime] = None

    def calculate_expected_value(self) -> Decimal:
        """è®¡ç®—æœŸæœ›å€¼"""
        return self.amount * (self.probability / Decimal('100'))

@dataclass
class CRMStorage:
    """CRMæ•°æ®å­˜å‚¨"""
    accounts: Dict[str, Account] = field(default_factory=dict)
    opportunities: Dict[str, Opportunity] = field(default_factory=dict)
    contacts: Dict[str, Contact] = field(default_factory=dict)

    def store_account(self, account: Account):
        """å­˜å‚¨è´¦æˆ·"""
        if account.created_date is None:
            account.created_date = datetime.now()
        self.accounts[account.account_id] = account

    def store_opportunity(self, opportunity: Opportunity):
        """å­˜å‚¨æœºä¼š"""
        if opportunity.created_date is None:
            opportunity.created_date = datetime.now()
        if opportunity.account_id not in self.accounts:
            raise ValueError(f"Account {opportunity.account_id} not found")
        self.opportunities[opportunity.opportunity_id] = opportunity

    def store_contact(self, contact: Contact):
        """å­˜å‚¨è”ç³»äºº"""
        if contact.created_date is None:
            contact.created_date = datetime.now()
        if contact.account_id and contact.account_id not in self.accounts:
            raise ValueError(f"Account {contact.account_id} not found")
        self.contacts[contact.contact_id] = contact
        if contact.account_id:
            self.accounts[contact.account_id].add_contact(contact)

    def get_account_opportunities(self, account_id: str) -> List[Opportunity]:
        """è·å–è´¦æˆ·çš„æœºä¼š"""
        return [opp for opp in self.opportunities.values() if opp.account_id == account_id]

    def get_account_contacts(self, account_id: str) -> List[Contact]:
        """è·å–è´¦æˆ·çš„è”ç³»äºº"""
        return [contact for contact in self.contacts.values() if contact.account_id == account_id]

    def get_pipeline_summary(self) -> Dict:
        """è·å–é”€å”®ç®¡é“æ‘˜è¦"""
        summary = {}
        total_amount = Decimal('0')
        total_expected_value = Decimal('0')

        for stage in OpportunityStage:
            stage_opps = [opp for opp in self.opportunities.values() if opp.stage == stage]
            stage_amount = sum(opp.amount for opp in stage_opps)
            stage_expected = sum(opp.calculate_expected_value() for opp in stage_opps)

            summary[stage.value] = {
                'count': len(stage_opps),
                'amount': float(stage_amount),
                'expected_value': float(stage_expected)
            }

            total_amount += stage_amount
            total_expected_value += stage_expected

        summary['total'] = {
            'count': len(self.opportunities),
            'amount': float(total_amount),
            'expected_value': float(total_expected_value)
        }

        return summary

# ä½¿ç”¨ç¤ºä¾‹
if __name__ == '__main__':
    # åˆ›å»ºCRMå­˜å‚¨
    crm = CRMStorage()

    # åˆ›å»ºè´¦æˆ·
    account = Account(
        account_id="ACC001",
        account_name="ABCå…¬å¸",
        account_type=AccountType.CUSTOMER,
        industry="Technology",
        annual_revenue=Decimal('1000000.00'),
        number_of_employees=100
    )
    crm.store_account(account)

    # åˆ›å»ºè”ç³»äºº
    contact = Contact(
        contact_id="CONT001",
        first_name="å¼ ",
        last_name="ä¸‰",
        email="zhangsan@abc.com",
        phone="13800138000",
        title="CTO",
        account_id="ACC001"
    )
    crm.store_contact(contact)

    # åˆ›å»ºé”€å”®æœºä¼š
    opportunity = Opportunity(
        opportunity_id="OPP001",
        opportunity_name="ABCå…¬å¸äº‘æœåŠ¡é¡¹ç›®",
        account_id="ACC001",
        stage=OpportunityStage.NEGOTIATION_REVIEW,
        amount=Decimal('500000.00'),
        probability=Decimal('75'),
        close_date=date(2025, 3, 31)
    )
    crm.store_opportunity(opportunity)

    # è·å–é”€å”®ç®¡é“æ‘˜è¦
    summary = crm.get_pipeline_summary()
    print(f"é”€å”®ç®¡é“æ‘˜è¦: {summary}")
```

### 2.5 æ•ˆæœè¯„ä¼°

**æ€§èƒ½æŒ‡æ ‡**ï¼š

| æŒ‡æ ‡ | æ”¹è¿›å‰ | æ”¹è¿›å | æå‡ |
|------|--------|--------|------|
| å®¢æˆ·ä¿¡æ¯å®Œæ•´æ€§ | 60% | 95% | 35%æå‡ |
| æ•°æ®æŸ¥è¯¢æ•ˆç‡ | ä½ | é«˜ | æ˜¾è‘—æå‡ |
| é”€å”®æœºä¼šè·Ÿè¸ªå‡†ç¡®æ€§ | 70% | 95% | 25%æå‡ |
| å®¢æˆ·æ•°æ®åˆ†æèƒ½åŠ› | ä½ | é«˜ | æ˜¾è‘—æå‡ |

**ä¸šåŠ¡ä»·å€¼**ï¼š

1. **ä¿¡æ¯ç»Ÿä¸€ç®¡ç†**ï¼šç»Ÿä¸€å®¢æˆ·ä¿¡æ¯ç®¡ç†
2. **æ•°æ®è§„èŒƒåŒ–**ï¼šè§„èŒƒå®¢æˆ·æ•°æ®æ ¼å¼
3. **è·Ÿè¸ªæ•ˆç‡æé«˜**ï¼šæé«˜é”€å”®æœºä¼šè·Ÿè¸ªæ•ˆç‡
4. **åˆ†æèƒ½åŠ›å¢å¼º**ï¼šå¢å¼ºå®¢æˆ·æ•°æ®åˆ†æèƒ½åŠ›

**ç»éªŒæ•™è®­**ï¼š

1. å®¢æˆ·æ•°æ®æ¨¡å‹è®¾è®¡å¾ˆé‡è¦
2. æ•°æ®å­˜å‚¨éœ€è¦é«˜æ•ˆ
3. æ•°æ®æŸ¥è¯¢éœ€è¦ä¼˜åŒ–
4. æ•°æ®åŒæ­¥éœ€è¦å®æ—¶

**å‚è€ƒæ¡ˆä¾‹**ï¼š

- [Salesforce CRMæœ€ä½³å®è·µ](https://www.salesforce.com/)
- [Microsoft Dynamics CRMå®æ–½æŒ‡å—](https://dynamics.microsoft.com/)
