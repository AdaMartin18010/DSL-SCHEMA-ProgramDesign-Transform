# æˆ¿åœ°äº§è¡Œä¸šSchemaå®è·µæ¡ˆä¾‹

## ğŸ“‘ ç›®å½•

- [æˆ¿åœ°äº§è¡Œä¸šSchemaå®è·µæ¡ˆä¾‹](#æˆ¿åœ°äº§è¡Œä¸šschemaå®è·µæ¡ˆä¾‹)
  - [ğŸ“‘ ç›®å½•](#-ç›®å½•)
  - [1. æ¡ˆä¾‹æ¦‚è¿°](#1-æ¡ˆä¾‹æ¦‚è¿°)
  - [2. æ¡ˆä¾‹ï¼šæ™ºæ…§ç‰©ä¸šç®¡ç†å¹³å°](#2-æ¡ˆä¾‹æ™ºæ…§ç‰©ä¸šç®¡ç†å¹³å°)
    - [2.1 ä¼ä¸šèƒŒæ™¯](#21-ä¼ä¸šèƒŒæ™¯)
    - [2.2 ä¸šåŠ¡ç—›ç‚¹](#22-ä¸šåŠ¡ç—›ç‚¹)
    - [2.3 ä¸šåŠ¡ç›®æ ‡](#23-ä¸šåŠ¡ç›®æ ‡)
    - [2.4 æŠ€æœ¯æŒ‘æˆ˜](#24-æŠ€æœ¯æŒ‘æˆ˜)
    - [2.5 è§£å†³æ–¹æ¡ˆ](#25-è§£å†³æ–¹æ¡ˆ)
    - [2.6 å®Œæ•´ä»£ç å®ç°](#26-å®Œæ•´ä»£ç å®ç°)
    - [2.7 æ•ˆæœè¯„ä¼°](#27-æ•ˆæœè¯„ä¼°)

---

## 1. æ¡ˆä¾‹æ¦‚è¿°

æœ¬æ–‡æ¡£æä¾›æˆ¿åœ°äº§è¡Œä¸šåœ¨å®é™…ä¼ä¸šåº”ç”¨ä¸­çš„Schemaå®è·µæ¡ˆä¾‹ï¼Œæ¶µç›–ç‰©ä¸šç®¡ç†ã€æˆ¿äº§äº¤æ˜“ã€ç§Ÿèµç®¡ç†ã€è®¾æ–½ç»´æŠ¤ç­‰çœŸå®åœºæ™¯ã€‚

**æ¡ˆä¾‹ç±»å‹**ï¼š

1. **æ™ºæ…§ç‰©ä¸šç®¡ç†å¹³å°**ï¼šç‰©ä¸šæ”¶è´¹ã€ä¸šä¸»æœåŠ¡ã€è®¾æ–½ç®¡ç†
2. **æˆ¿äº§äº¤æ˜“ç®¡ç†ç³»ç»Ÿ**ï¼šæˆ¿æºç®¡ç†ã€äº¤æ˜“æµç¨‹ã€åˆåŒç®¡ç†
3. **ç§Ÿèµç®¡ç†ç³»ç»Ÿ**ï¼šç§Ÿæˆ·ç®¡ç†ã€ç§Ÿé‡‘æ”¶å–ã€ç§Ÿçº¦ç®¡ç†
4. **è®¾æ–½ç»´æŠ¤ç³»ç»Ÿ**ï¼šè®¾å¤‡å·¡æ£€ã€ç»´ä¿®å·¥å•ã€é¢„é˜²æ€§ç»´æŠ¤

---

## 2. æ¡ˆä¾‹ï¼šæ™ºæ…§ç‰©ä¸šç®¡ç†å¹³å°

### 2.1 ä¼ä¸šèƒŒæ™¯

**ä¼ä¸šåç§°**ï¼šç››ä¸–ç‰©ä¸šç®¡ç†é›†å›¢

**ä¼ä¸šè§„æ¨¡**ï¼š
- ç®¡ç†é¡¹ç›®ï¼š150+ä¸ªä½å®…å°åŒºå’Œå•†ä¸šç»¼åˆä½“
- æœåŠ¡ä¸šä¸»ï¼š30ä¸‡+æˆ·å®¶åº­
- å‘˜å·¥æ•°é‡ï¼š8,000+äºº
- å¹´è¥æ”¶ï¼š15äº¿å…ƒäººæ°‘å¸
- è¦†ç›–åŸå¸‚ï¼š25ä¸ªä¸€äºŒçº¿åŸå¸‚

**ä¸šåŠ¡èŒƒç•´**ï¼š
- ä½å®…ç‰©ä¸šç®¡ç†
- å•†ä¸šç»¼åˆä½“è¿è¥
- åœè½¦åœºç®¡ç†
- ç¤¾åŒºå¢å€¼æœåŠ¡

**ç°æœ‰ITç³»ç»ŸçŠ¶å†µ**ï¼š
- ä½¿ç”¨åˆ†æ•£çš„Excelè¡¨æ ¼ç®¡ç†ä¸šä¸»ä¿¡æ¯
- æ”¶è´¹ç³»ç»Ÿä¸è´¢åŠ¡ç³»ç»Ÿåˆ†ç¦»
- æŠ¥ä¿®å·¥å•ä¾èµ–çº¸è´¨æµç¨‹
- æ•°æ®å­¤å²›ä¸¥é‡ï¼Œæ— æ³•ç»Ÿä¸€åˆ†æ

### 2.2 ä¸šåŠ¡ç—›ç‚¹

1. **ä¸šä¸»ä¿¡æ¯åˆ†æ•£ç®¡ç†**ï¼šä¸šä¸»ä¿¡æ¯åˆ†æ•£åœ¨ä¸åŒé¡¹ç›®ã€ä¸åŒéƒ¨é—¨ï¼Œç¼ºä¹ç»Ÿä¸€è§†å›¾ï¼Œä¿¡æ¯æ›´æ–°ä¸åŠæ—¶ï¼Œå¯¼è‡´æœåŠ¡å“åº”æ…¢ï¼Œä¸šä¸»æ»¡æ„åº¦ä½ã€‚

2. **æ”¶è´¹æµç¨‹ç¹çä½æ•ˆ**ï¼šç‰©ä¸šè´¹ã€åœè½¦è´¹ã€æ°´ç”µè´¹ç­‰æ”¶è´¹é¡¹ç›®å¤šï¼Œæ”¶è´¹æ¸ é“åˆ†æ•£ï¼Œå¯¹è´¦å›°éš¾ï¼Œè´¢åŠ¡å·®é”™ç‡é«˜è¾¾5%ï¼Œæœˆå‡èµ„é‡‘å›ç¬¼å»¶è¿Ÿ7å¤©ã€‚

3. **æŠ¥ä¿®å“åº”ä¸åŠæ—¶**ï¼šä¸šä¸»æŠ¥ä¿®ä¾èµ–ç”µè¯æˆ–çº¸è´¨å•ï¼Œæ´¾å·¥é äººå·¥åˆ†é…ï¼Œå“åº”æ—¶é—´å¹³å‡48å°æ—¶ï¼Œç»´ä¿®å®Œæˆç‡ä»…70%ï¼Œä¸šä¸»æŠ•è¯‰ç‡å±…é«˜ä¸ä¸‹ã€‚

4. **è®¾æ–½è®¾å¤‡ç®¡ç†æ··ä¹±**ï¼šç”µæ¢¯ã€æ¶ˆé˜²ã€ä¾›æ°´ç­‰è®¾å¤‡æ¡£æ¡ˆä¸å…¨ï¼Œå·¡æ£€è®°å½•ç¼ºå¤±ï¼Œé¢„é˜²æ€§ç»´æŠ¤ä¸åˆ°ä½ï¼Œè®¾å¤‡æ•…éšœç‡æ¯”è¡Œä¸šå¹³å‡æ°´å¹³é«˜30%ã€‚

5. **æ•°æ®å†³ç­–æ”¯æŒè–„å¼±**ï¼šç¼ºä¹ç»Ÿä¸€æ•°æ®å¹³å°ï¼Œæ— æ³•å®æ—¶æŒæ¡å„é¡¹ç›®è¿è¥çŠ¶å†µï¼Œå†³ç­–ä¾èµ–ç»éªŒåˆ¤æ–­ï¼Œèµ„æºé…ç½®æ•ˆç‡ä½ä¸‹ï¼Œç©ºç½®ç‡åˆ†æä¸å‡†ç¡®ã€‚

### 2.3 ä¸šåŠ¡ç›®æ ‡

1. **å»ºç«‹ç»Ÿä¸€ä¸šä¸»ä¿¡æ¯ä¸»æ•°æ®å¹³å°**ï¼šæ•´åˆæ‰€æœ‰é¡¹ç›®ä¸šä¸»ä¿¡æ¯ï¼Œå»ºç«‹360åº¦ä¸šä¸»è§†å›¾ï¼Œä¿¡æ¯å‡†ç¡®ç‡æå‡è‡³98%ä»¥ä¸Šï¼Œæ”¯æŒç²¾ç»†åŒ–æœåŠ¡ã€‚

2. **å®ç°æ”¶è´¹å…¨æµç¨‹æ•°å­—åŒ–**ï¼šæ‰“é€šæ”¶è´¹-è´¢åŠ¡-é“¶è¡Œç³»ç»Ÿï¼Œæ”¯æŒå¤šæ¸ é“åœ¨çº¿ç¼´è´¹ï¼Œè´¢åŠ¡å·®é”™ç‡é™è‡³0.5%ä»¥ä¸‹ï¼Œèµ„é‡‘å›ç¬¼å‘¨æœŸç¼©çŸ­è‡³3å¤©ã€‚

3. **æ„å»ºæ™ºèƒ½å·¥å•ç®¡ç†ä½“ç³»**ï¼šå®ç°æŠ¥ä¿®-æ´¾å·¥-è·Ÿè¸ª-è¯„ä»·å…¨æµç¨‹åœ¨çº¿ï¼Œå“åº”æ—¶é—´ç¼©çŸ­è‡³2å°æ—¶ï¼Œç»´ä¿®å®Œæˆç‡æå‡è‡³95%ï¼Œä¸šä¸»æ»¡æ„åº¦è¾¾90%ã€‚

4. **å»ºç«‹è®¾æ–½è®¾å¤‡å…¨ç”Ÿå‘½å‘¨æœŸç®¡ç†**ï¼šå»ºç«‹è®¾å¤‡å°è´¦ï¼Œå®ç°å·¡æ£€ã€ä¿å…»ã€ç»´ä¿®å…¨è¿‡ç¨‹æ•°å­—åŒ–ï¼Œè®¾å¤‡æ•…éšœç‡é™ä½40%ï¼Œå»¶é•¿è®¾å¤‡ä½¿ç”¨å¯¿å‘½ã€‚

5. **æ‰“é€ æ•°æ®é©±åŠ¨å†³ç­–å¹³å°**ï¼šæ„å»ºè¿è¥æ•°æ®çœ‹æ¿ï¼Œå®æ—¶å±•ç¤ºæ”¶è´¹ç‡ã€æ»¡æ„åº¦ã€è®¾å¤‡çŠ¶æ€ç­‰å…³é”®æŒ‡æ ‡ï¼Œæ”¯æŒç§‘å­¦å†³ç­–ï¼Œæå‡èµ„æºåˆ©ç”¨ç‡20%ã€‚

### 2.4 æŠ€æœ¯æŒ‘æˆ˜

1. **å¤šæºæ•°æ®æ•´åˆ**ï¼šéœ€è¦æ•´åˆæ¥è‡ª20+ä¸ªå¼‚æ„ç³»ç»Ÿçš„æ•°æ®ï¼Œæ•°æ®æ ¼å¼ä¸ç»Ÿä¸€ï¼Œå†å²æ•°æ®è´¨é‡å·®ï¼Œæ•°æ®æ¸…æ´—å’Œæ ‡å‡†åŒ–å·¥ä½œé‡å¤§ã€‚

2. **é«˜å¹¶å‘æ€§èƒ½ä¿éšœ**ï¼š30ä¸‡ä¸šä¸»åŒæ—¶åœ¨çº¿ç¼´è´¹ã€æŠ¥ä¿®ï¼Œé«˜å³°æœŸQPSè¾¾5000+ï¼Œéœ€è¦ä¿è¯ç³»ç»Ÿç¨³å®šæ€§å’Œå“åº”é€Ÿåº¦ï¼ŒSLAè¦æ±‚99.9%å¯ç”¨æ€§ã€‚

3. **å¤æ‚ä¸šåŠ¡è§„åˆ™å¼•æ“**ï¼šç‰©ä¸šè´¹è®¡ç®—æ¶‰åŠé¢ç§¯ã€å•ä»·ã€æŠ˜æ‰£ã€æ»çº³é‡‘ç­‰å¤æ‚è§„åˆ™ï¼Œä¸åŒé¡¹ç›®è®¡è´¹è§„åˆ™å·®å¼‚å¤§ï¼Œéœ€è¦çµæ´»å¯é…ç½®çš„è§„åˆ™å¼•æ“ã€‚

4. **ç§»åŠ¨ç«¯ä½“éªŒä¼˜åŒ–**ï¼šä¸šä¸»ä¸»è¦é€šè¿‡æ‰‹æœºAPP/å°ç¨‹åºä½¿ç”¨æœåŠ¡ï¼Œéœ€è¦ä¼˜åŒ–ç§»åŠ¨ç«¯æ€§èƒ½ï¼Œæ”¯æŒç¦»çº¿æ“ä½œï¼Œä¿è¯å¼±ç½‘ç¯å¢ƒä¸‹å¯ç”¨æ€§ã€‚

5. **æ•°æ®å®‰å…¨ä¸éšç§ä¿æŠ¤**ï¼šä¸šä¸»ä¸ªäººä¿¡æ¯å’Œè´¢åŠ¡æ•°æ®æ•æ„Ÿï¼Œéœ€è¦æ»¡è¶³ç­‰ä¿ä¸‰çº§è¦æ±‚ï¼Œå®ç°æ•°æ®åŠ å¯†ã€è®¿é—®æ§åˆ¶ã€æ“ä½œå®¡è®¡ç­‰å®‰å…¨æªæ–½ã€‚

### 2.5 è§£å†³æ–¹æ¡ˆ

**ä½¿ç”¨Schemaå®šä¹‰æ™ºæ…§ç‰©ä¸šç®¡ç†å¹³å°**ï¼š

- **ä¸šä¸»ä¿¡æ¯Schema**ï¼šå®šä¹‰ä¸šä¸»ã€æˆ¿å±‹ã€è½¦è¾†çš„å…³è”å…³ç³»
- **æ”¶è´¹ç®¡ç†Schema**ï¼šå®šä¹‰è´¹ç”¨é¡¹ç›®ã€è®¡è´¹è§„åˆ™ã€æ”¶æ¬¾è®°å½•
- **å·¥å•ç®¡ç†Schema**ï¼šå®šä¹‰æŠ¥ä¿®ç±»å‹ã€å·¥å•çŠ¶æ€ã€å¤„ç†æµç¨‹
- **è®¾å¤‡ç®¡ç†Schema**ï¼šå®šä¹‰è®¾å¤‡å°è´¦ã€å·¡æ£€è®¡åˆ’ã€ç»´ä¿®è®°å½•

### 2.6 å®Œæ•´ä»£ç å®ç°

**æ™ºæ…§ç‰©ä¸šç®¡ç†å¹³å°Schemaå®ç°**ï¼š

```python
#!/usr/bin/env python3
"""
æ™ºæ…§ç‰©ä¸šç®¡ç†å¹³å°Schemaå®ç°
Real Estate Property Management Platform Schema Implementation
"""

from typing import Dict, List, Optional, Set
from datetime import date, datetime, timedelta
from decimal import Decimal
from dataclasses import dataclass, field
from enum import Enum, auto
import json
import uuid


class PropertyType(str, Enum):
    """æˆ¿äº§ç±»å‹"""
    RESIDENTIAL = "ä½å®…"
    COMMERCIAL = "å•†ä¸š"
    OFFICE = "å†™å­—æ¥¼"
    PARKING = "è½¦ä½"
    WAREHOUSE = "ä»“å‚¨"


class OwnerType(str, Enum):
    """ä¸šä¸»ç±»å‹"""
    INDIVIDUAL = "ä¸ªäºº"
    COMPANY = "ä¼ä¸š"
    GOVERNMENT = "æ”¿åºœ"


class FeeType(str, Enum):
    """è´¹ç”¨ç±»å‹"""
    PROPERTY_FEE = "ç‰©ä¸šè´¹"
    PARKING_FEE = "åœè½¦è´¹"
    WATER_FEE = "æ°´è´¹"
    ELECTRICITY_FEE = "ç”µè´¹"
    HEATING_FEE = "ä¾›æš–è´¹"
    REPAIR_FUND = "ç»´ä¿®åŸºé‡‘"


class FeeStatus(str, Enum):
    """è´¹ç”¨çŠ¶æ€"""
    PENDING = "å¾…ç¼´"
    PAID = "å·²ç¼´"
    OVERDUE = "é€¾æœŸ"
    WAIVED = "å‡å…"


class WorkOrderType(str, Enum):
    """å·¥å•ç±»å‹"""
    REPAIR = "ç»´ä¿®"
    COMPLAINT = "æŠ•è¯‰"
    CONSULTATION = "å’¨è¯¢"
    CLEANING = "æ¸…æ´"
    SECURITY = "å®‰ä¿"


class WorkOrderStatus(str, Enum):
    """å·¥å•çŠ¶æ€"""
    SUBMITTED = "å·²æäº¤"
    ASSIGNED = "å·²æ´¾å•"
    PROCESSING = "å¤„ç†ä¸­"
    COMPLETED = "å·²å®Œæˆ"
    CLOSED = "å·²å…³é—­"
    CANCELLED = "å·²å–æ¶ˆ"


class Priority(str, Enum):
    """ä¼˜å…ˆçº§"""
    LOW = "ä½"
    MEDIUM = "ä¸­"
    HIGH = "é«˜"
    URGENT = "ç´§æ€¥"


class DeviceType(str, Enum):
    """è®¾å¤‡ç±»å‹"""
    ELEVATOR = "ç”µæ¢¯"
    FIRE_SYSTEM = "æ¶ˆé˜²ç³»ç»Ÿ"
    WATER_SUPPLY = "ä¾›æ°´ç³»ç»Ÿ"
    POWER_SUPPLY = "ä¾›ç”µç³»ç»Ÿ"
    HVAC = "æš–é€šç©ºè°ƒ"
    SECURITY_MONITOR = "å®‰é˜²ç›‘æ§"


class DeviceStatus(str, Enum):
    """è®¾å¤‡çŠ¶æ€"""
    NORMAL = "æ­£å¸¸"
    WARNING = "è­¦å‘Š"
    FAULT = "æ•…éšœ"
    MAINTENANCE = "ç»´æŠ¤ä¸­"
    RETIRED = "æŠ¥åºŸ"


@dataclass
class Address:
    """åœ°å€ä¿¡æ¯"""
    province: str
    city: str
    district: str
    street: str
    building: str
    unit: Optional[str] = None
    floor: Optional[str] = None
    room: Optional[str] = None
    
    def __str__(self) -> str:
        parts = [self.province, self.city, self.district, self.street, 
                 self.building, self.unit, self.floor, self.room]
        return ''.join(filter(None, parts))


@dataclass
class Owner:
    """ä¸šä¸»ä¿¡æ¯"""
    owner_id: str
    name: str
    owner_type: OwnerType
    phone: str
    email: Optional[str] = None
    id_number: Optional[str] = None
    emergency_contact: Optional[str] = None
    emergency_phone: Optional[str] = None
    created_at: datetime = field(default_factory=datetime.now)
    updated_at: datetime = field(default_factory=datetime.now)
    
    def to_dict(self) -> Dict:
        return {
            'owner_id': self.owner_id,
            'name': self.name,
            'owner_type': self.owner_type.value,
            'phone': self.phone,
            'email': self.email,
            'created_at': self.created_at.isoformat()
        }


@dataclass
class Property:
    """æˆ¿äº§ä¿¡æ¯"""
    property_id: str
    property_code: str
    property_type: PropertyType
    address: Address
    area_sqm: Decimal
    owner_id: str
    project_id: str
    purchase_date: Optional[date] = None
    delivery_date: Optional[date] = None
    status: str = "æ­£å¸¸"
    created_at: datetime = field(default_factory=datetime.now)
    
    def calculate_property_fee(self, unit_price: Decimal) -> Decimal:
        """è®¡ç®—ç‰©ä¸šè´¹"""
        return self.area_sqm * unit_price


@dataclass
class Vehicle:
    """è½¦è¾†ä¿¡æ¯"""
    vehicle_id: str
    plate_number: str
    vehicle_type: str
    owner_id: str
    property_id: str
    parking_space: Optional[str] = None
    start_date: Optional[date] = None
    end_date: Optional[date] = None
    status: str = "æ­£å¸¸"


@dataclass
class FeeItem:
    """è´¹ç”¨é¡¹ç›®"""
    fee_id: str
    fee_type: FeeType
    property_id: str
    owner_id: str
    period_start: date
    period_end: date
    amount: Decimal
    discount: Decimal = Decimal('0')
    late_fee: Decimal = Decimal('0')
    status: FeeStatus = FeeStatus.PENDING
    due_date: date = field(default_factory=lambda: date.today() + timedelta(days=30))
    paid_date: Optional[date] = None
    paid_amount: Optional[Decimal] = None
    payment_method: Optional[str] = None
    created_at: datetime = field(default_factory=datetime.now)
    
    def calculate_total(self) -> Decimal:
        """è®¡ç®—åº”ç¼´æ€»é¢"""
        return self.amount - self.discount + self.late_fee
    
    def calculate_late_fee(self, daily_rate: Decimal = Decimal('0.0005')) -> Decimal:
        """è®¡ç®—æ»çº³é‡‘"""
        if self.status == FeeStatus.OVERDUE and self.due_date < date.today():
            overdue_days = (date.today() - self.due_date).days
            return self.amount * daily_rate * overdue_days
        return Decimal('0')


@dataclass
class WorkOrder:
    """å·¥å•ä¿¡æ¯"""
    order_id: str
    order_type: WorkOrderType
    property_id: str
    owner_id: str
    title: str
    description: str
    priority: Priority = Priority.MEDIUM
    status: WorkOrderStatus = WorkOrderStatus.SUBMITTED
    assigned_to: Optional[str] = None
    submitted_at: datetime = field(default_factory=datetime.now)
    assigned_at: Optional[datetime] = None
    started_at: Optional[datetime] = None
    completed_at: Optional[datetime] = None
    closed_at: Optional[datetime] = None
    rating: Optional[int] = None
    feedback: Optional[str] = None
    images: List[str] = field(default_factory=list)
    
    def get_duration_hours(self) -> Optional[float]:
        """è·å–å¤„ç†æ—¶é•¿ï¼ˆå°æ—¶ï¼‰"""
        if self.completed_at and self.submitted_at:
            return (self.completed_at - self.submitted_at).total_seconds() / 3600
        return None
    
    def transition_to(self, new_status: WorkOrderStatus, **kwargs):
        """çŠ¶æ€è½¬æ¢"""
        self.status = new_status
        if new_status == WorkOrderStatus.ASSIGNED:
            self.assigned_at = datetime.now()
            self.assigned_to = kwargs.get('assigned_to')
        elif new_status == WorkOrderStatus.PROCESSING:
            self.started_at = datetime.now()
        elif new_status == WorkOrderStatus.COMPLETED:
            self.completed_at = datetime.now()
        elif new_status == WorkOrderStatus.CLOSED:
            self.closed_at = datetime.now()
            self.rating = kwargs.get('rating')
            self.feedback = kwargs.get('feedback')


@dataclass
class Device:
    """è®¾å¤‡ä¿¡æ¯"""
    device_id: str
    device_code: str
    device_name: str
    device_type: DeviceType
    manufacturer: str
    model: str
    serial_number: str
    install_date: date
    warranty_expiry: date
    location: str
    project_id: str
    status: DeviceStatus = DeviceStatus.NORMAL
    last_inspection: Optional[date] = None
    next_inspection: Optional[date] = None
    maintenance_count: int = 0
    repair_count: int = 0
    
    def needs_inspection(self) -> bool:
        """æ˜¯å¦éœ€è¦å·¡æ£€"""
        if self.next_inspection:
            return date.today() >= self.next_inspection
        return False
    
    def is_under_warranty(self) -> bool:
        """æ˜¯å¦åœ¨ä¿ä¿®æœŸå†…"""
        return date.today() <= self.warranty_expiry


@dataclass
class InspectionRecord:
    """å·¡æ£€è®°å½•"""
    record_id: str
    device_id: str
    inspector_id: str
    inspection_date: date
    result: str
    issues: Optional[str] = None
    photos: List[str] = field(default_factory=list)
    next_inspection_date: Optional[date] = None


@dataclass
class PropertyManagementSystem:
    """ç‰©ä¸šç®¡ç†ç³»ç»Ÿ"""
    owners: Dict[str, Owner] = field(default_factory=dict)
    properties: Dict[str, Property] = field(default_factory=dict)
    vehicles: Dict[str, Vehicle] = field(default_factory=dict)
    fee_items: Dict[str, FeeItem] = field(default_factory=dict)
    work_orders: Dict[str, WorkOrder] = field(default_factory=dict)
    devices: Dict[str, Device] = field(default_factory=dict)
    inspection_records: Dict[str, InspectionRecord] = field(default_factory=dict)
    
    # æ–°å¢ä¸šä¸»
    def add_owner(self, owner: Owner) -> str:
        if not owner.owner_id:
            owner.owner_id = str(uuid.uuid4())
        self.owners[owner.owner_id] = owner
        return owner.owner_id
    
    # æ–°å¢æˆ¿äº§
    def add_property(self, prop: Property) -> str:
        if not prop.property_id:
            prop.property_id = str(uuid.uuid4())
        self.properties[prop.property_id] = prop
        return prop.property_id
    
    # æ–°å¢è´¹ç”¨
    def add_fee(self, fee: FeeItem) -> str:
        if not fee.fee_id:
            fee.fee_id = str(uuid.uuid4())
        self.fee_items[fee.fee_id] = fee
        return fee.fee_id
    
    # æ–°å¢å·¥å•
    def create_work_order(self, order: WorkOrder) -> str:
        if not order.order_id:
            order.order_id = str(uuid.uuid4())
        self.work_orders[order.order_id] = order
        return order.order_id
    
    # æ–°å¢è®¾å¤‡
    def add_device(self, device: Device) -> str:
        if not device.device_id:
            device.device_id = str(uuid.uuid4())
        self.devices[device.device_id] = device
        return device.device_id
    
    # è·å–ä¸šä¸»çš„æ‰€æœ‰æˆ¿äº§
    def get_owner_properties(self, owner_id: str) -> List[Property]:
        return [p for p in self.properties.values() if p.owner_id == owner_id]
    
    # è·å–ä¸šä¸»çš„æ‰€æœ‰è´¹ç”¨
    def get_owner_fees(self, owner_id: str, status: Optional[FeeStatus] = None) -> List[FeeItem]:
        fees = [f for f in self.fee_items.values() if f.owner_id == owner_id]
        if status:
            fees = [f for f in fees if f.status == status]
        return fees
    
    # è·å–é¡¹ç›®æ”¶è´¹ç»Ÿè®¡
    def get_project_fee_summary(self, project_id: str) -> Dict:
        project_fees = [
            f for f in self.fee_items.values() 
            if self.properties.get(f.property_id, Property('', '', PropertyType.RESIDENTIAL, Address('', '', '', '', ''), Decimal('0'), '', '')).project_id == project_id
        ]
        
        total_amount = sum(f.calculate_total() for f in project_fees)
        paid_amount = sum(f.paid_amount or Decimal('0') for f in project_fees if f.status == FeeStatus.PAID)
        
        return {
            'project_id': project_id,
            'total_fees': len(project_fees),
            'total_amount': float(total_amount),
            'paid_amount': float(paid_amount),
            'unpaid_amount': float(total_amount - paid_amount),
            'collection_rate': float(paid_amount / total_amount * 100) if total_amount > 0 else 0
        }
    
    # è·å–å·¥å•ç»Ÿè®¡
    def get_work_order_stats(self, start_date: date, end_date: date) -> Dict:
        orders = [
            o for o in self.work_orders.values()
            if start_date <= o.submitted_at.date() <= end_date
        ]
        
        completed = [o for o in orders if o.status == WorkOrderStatus.CLOSED]
        durations = [o.get_duration_hours() for o in completed if o.get_duration_hours()]
        avg_duration = sum(durations) / len(durations) if durations else 0
        
        return {
            'total_orders': len(orders),
            'by_type': {
                t.value: len([o for o in orders if o.order_type == t])
                for t in WorkOrderType
            },
            'by_status': {
                s.value: len([o for o in orders if o.status == s])
                for s in WorkOrderStatus
            },
            'completed_orders': len(completed),
            'avg_response_hours': avg_duration
        }
    
    # è·å–è®¾å¤‡å¥åº·åº¦
    def get_device_health_summary(self, project_id: str) -> Dict:
        project_devices = [d for d in self.devices.values() if d.project_id == project_id]
        total = len(project_devices)
        
        if total == 0:
            return {'total': 0, 'health_rate': 100}
        
        normal = len([d for d in project_devices if d.status == DeviceStatus.NORMAL])
        warning = len([d for d in project_devices if d.status == DeviceStatus.WARNING])
        fault = len([d for d in project_devices if d.status == DeviceStatus.FAULT])
        
        return {
            'project_id': project_id,
            'total': total,
            'normal': normal,
            'warning': warning,
            'fault': fault,
            'health_rate': float(normal / total * 100),
            'needs_inspection': len([d for d in project_devices if d.needs_inspection()])
        }


# ä½¿ç”¨ç¤ºä¾‹
if __name__ == '__main__':
    pms = PropertyManagementSystem()
    
    # åˆ›å»ºä¸šä¸»
    owner = Owner(
        owner_id='OWN001',
        name='å¼ ä¸‰',
        owner_type=OwnerType.INDIVIDUAL,
        phone='13800138000',
        email='zhangsan@example.com'
    )
    pms.add_owner(owner)
    
    # åˆ›å»ºæˆ¿äº§
    address = Address(
        province='å¹¿ä¸œçœ',
        city='æ·±åœ³å¸‚',
        district='å—å±±åŒº',
        street='ç§‘æŠ€å›­è·¯',
        building='1æ ‹',
        unit='Aå•å…ƒ',
        floor='15å±‚',
        room='1501å®¤'
    )
    prop = Property(
        property_id='PROP001',
        property_code='SZ-001-01-1501',
        property_type=PropertyType.RESIDENTIAL,
        address=address,
        area_sqm=Decimal('128.5'),
        owner_id='OWN001',
        project_id='PROJ001',
        purchase_date=date(2020, 6, 1)
    )
    pms.add_property(prop)
    
    # åˆ›å»ºè´¹ç”¨
    fee = FeeItem(
        fee_id='FEE001',
        fee_type=FeeType.PROPERTY_FEE,
        property_id='PROP001',
        owner_id='OWN001',
        period_start=date(2025, 1, 1),
        period_end=date(2025, 1, 31),
        amount=Decimal('642.50'),
        status=FeeStatus.PENDING
    )
    pms.add_fee(fee)
    
    # åˆ›å»ºå·¥å•
    order = WorkOrder(
        order_id='WO001',
        order_type=WorkOrderType.REPAIR,
        property_id='PROP001',
        owner_id='OWN001',
        title='å¨æˆ¿æ°´ç®¡æ¼æ°´',
        description='å¨æˆ¿æ°´æ§½ä¸‹æ–¹ç®¡é“æœ‰æ˜æ˜¾æ»´æ°´ï¼Œéœ€è¦å°½å¿«ç»´ä¿®',
        priority=Priority.HIGH
    )
    pms.create_work_order(order)
    
    # åˆ›å»ºè®¾å¤‡
    device = Device(
        device_id='DEV001',
        device_code='ELEV-001',
        device_name='1å·æ¥¼å®¢æ¢¯A',
        device_type=DeviceType.ELEVATOR,
        manufacturer='ä¸‰è±ç”µæ¢¯',
        model='NexWay-S',
        serial_number='EL20240001',
        install_date=date(2020, 1, 15),
        warranty_expiry=date(2025, 1, 15),
        location='1å·æ¥¼ç”µæ¢¯äº•',
        project_id='PROJ001',
        next_inspection=date(2025, 2, 1)
    )
    pms.add_device(device)
    
    # æ‰“å°ç»Ÿè®¡
    print("=" * 60)
    print("æ™ºæ…§ç‰©ä¸šç®¡ç†å¹³å°æ•°æ®ç»Ÿè®¡")
    print("=" * 60)
    
    # ä¸šä¸»ä¿¡æ¯
    print(f"\nä¸šä¸»æ€»æ•°: {len(pms.owners)}")
    print(f"æˆ¿äº§æ€»æ•°: {len(pms.properties)}")
    
    # è´¹ç”¨ç»Ÿè®¡
    fee_summary = pms.get_project_fee_summary('PROJ001')
    print(f"\né¡¹ç›®æ”¶è´¹ç»Ÿè®¡:")
    print(f"  æ€»è´¹ç”¨: {fee_summary['total_fees']}ç¬”")
    print(f"  æ€»é‡‘é¢: Â¥{fee_summary['total_amount']:.2f}")
    print(f"  å·²æ”¶æ¬¾: Â¥{fee_summary['paid_amount']:.2f}")
    print(f"  æœªæ”¶æ¬¾: Â¥{fee_summary['unpaid_amount']:.2f}")
    print(f"  æ”¶ç¼´ç‡: {fee_summary['collection_rate']:.1f}%")
    
    # å·¥å•ç»Ÿè®¡
    wo_stats = pms.get_work_order_stats(date(2025, 1, 1), date(2025, 12, 31))
    print(f"\nå·¥å•ç»Ÿè®¡:")
    print(f"  æ€»å·¥å•: {wo_stats['total_orders']}ç¬”")
    print(f"  å·²å®Œæˆ: {wo_stats['completed_orders']}ç¬”")
    print(f"  å¹³å‡å¤„ç†æ—¶é•¿: {wo_stats['avg_response_hours']:.1f}å°æ—¶")
    
    # è®¾å¤‡å¥åº·åº¦
    device_health = pms.get_device_health_summary('PROJ001')
    print(f"\nè®¾å¤‡å¥åº·åº¦:")
    print(f"  è®¾å¤‡æ€»æ•°: {device_health['total']}å°")
    print(f"  æ­£å¸¸: {device_health['normal']}å°")
    print(f"  è­¦å‘Š: {device_health['warning']}å°")
    print(f"  æ•…éšœ: {device_health['fault']}å°")
    print(f"  å¥åº·ç‡: {device_health['health_rate']:.1f}%")
    print(f"  å¾…å·¡æ£€: {device_health['needs_inspection']}å°")
```

### 2.7 æ•ˆæœè¯„ä¼°

**å…³é”®ç»©æ•ˆæŒ‡æ ‡ï¼ˆKPIï¼‰å¯¹æ¯”**ï¼š

| æŒ‡æ ‡ | æ”¹è¿›å‰ | æ”¹è¿›åï¼ˆ6ä¸ªæœˆï¼‰ | æå‡å¹…åº¦ |
|------|--------|----------------|----------|
| ä¸šä¸»ä¿¡æ¯å‡†ç¡®ç‡ | 65% | 98% | +33% |
| è´¢åŠ¡å·®é”™ç‡ | 5.2% | 0.3% | -94% |
| èµ„é‡‘å›ç¬¼å‘¨æœŸ | 7å¤© | 2.8å¤© | -60% |
| å·¥å•å¹³å‡å“åº”æ—¶é—´ | 48å°æ—¶ | 3.2å°æ—¶ | -93% |
| ç»´ä¿®å®Œæˆç‡ | 70% | 96% | +26% |
| ä¸šä¸»æ»¡æ„åº¦ | 72% | 91% | +19% |
| è®¾å¤‡æ•…éšœç‡ | 15% | 8% | -47% |
| è®¾å¤‡å·¡æ£€è¦†ç›–ç‡ | 45% | 98% | +53% |
| æ”¶ç¼´ç‡ | 82% | 95% | +13% |

**æŠ•èµ„å›æŠ¥åˆ†æï¼ˆROIï¼‰**ï¼š

| æŠ•èµ„/æ”¶ç›Šé¡¹ç›® | é‡‘é¢ï¼ˆä¸‡å…ƒï¼‰ | è¯´æ˜ |
|--------------|-------------|------|
| **æ€»æŠ•èµ„** | **680** | |
| ç³»ç»Ÿå¼€å‘è´¹ç”¨ | 350 | åŒ…å«è®¾è®¡ã€å¼€å‘ã€æµ‹è¯• |
| ç¡¬ä»¶è®¾å¤‡è´¹ç”¨ | 180 | æœåŠ¡å™¨ã€ç½‘ç»œè®¾å¤‡ã€ç»ˆç«¯ |
| å®æ–½ä¸åŸ¹è®­è´¹ç”¨ | 100 | ä¸Šçº¿å®æ–½ã€ç”¨æˆ·åŸ¹è®­ |
| è¿ç»´è´¹ç”¨ï¼ˆé¦–å¹´ï¼‰ | 50 | ç³»ç»Ÿç»´æŠ¤ã€æŠ€æœ¯æ”¯æŒ |
| **å¹´åº¦æ”¶ç›Š** | **1,280** | |
| äººå·¥æˆæœ¬èŠ‚çº¦ | 420 | è‡ªåŠ¨åŒ–å‡å°‘äººå·¥æ“ä½œ |
| è´¢åŠ¡å·®é”™å‡å°‘ | 180 | é™ä½èµ„é‡‘æŸå¤± |
| èµ„é‡‘å›ç¬¼åŠ é€Ÿ | 280 | æå‰å›æ”¶èµ„é‡‘æ”¶ç›Š |
| è®¾å¤‡ç»´æŠ¤æˆæœ¬é™ä½ | 150 | é¢„é˜²æ€§ç»´æŠ¤å‡å°‘æ•…éšœ |
| ä¸šä¸»ç»­è´¹ç‡æå‡ | 250 | æ»¡æ„åº¦æå‡å¸¦æ¥æ”¶ç›Š |
| **é¦–å¹´å‡€æ”¶ç›Š** | **600** | |
| **æŠ•èµ„å›æŠ¥ç‡ï¼ˆROIï¼‰** | **88.2%** | é¦–å¹´ |
| **æŠ•èµ„å›æ”¶æœŸ** | **6.4ä¸ªæœˆ** | |

**ä¸šåŠ¡ä»·å€¼**ï¼š

1. **è¿è¥æ•ˆç‡å¤§å¹…æå‡**ï¼šè‡ªåŠ¨åŒ–æµç¨‹å‡å°‘äººå·¥æ“ä½œ60%ï¼Œå‘˜å·¥å¯ä»¥ä¸“æ³¨äºé«˜ä»·å€¼æœåŠ¡ï¼Œäººå‡ç®¡ç†é¢ç§¯ä»8000å¹³ç±³æå‡è‡³12000å¹³ç±³ã€‚

2. **è´¢åŠ¡ç®¡æ§ç²¾å‡†é«˜æ•ˆ**ï¼šæ”¶è´¹æµç¨‹æ•°å­—åŒ–åï¼Œè´¢åŠ¡å¯¹è´¦æ—¶é—´ä»3å¤©ç¼©çŸ­è‡³1å°æ—¶ï¼Œèµ„é‡‘å›ç¬¼å‘¨æœŸç¼©çŸ­60%ï¼Œå¹´èµ„é‡‘æˆæœ¬èŠ‚çº¦280ä¸‡å…ƒã€‚

3. **æœåŠ¡è´¨é‡æ˜¾è‘—æ”¹å–„**ï¼šå·¥å•å¤„ç†æ—¶æ•ˆæå‡93%ï¼Œä¸šä¸»æ»¡æ„åº¦ä»72%æå‡è‡³91%ï¼ŒæŠ•è¯‰ç‡ä¸‹é™65%ï¼Œå“ç‰Œå£ç¢‘æ˜æ˜¾æå‡ã€‚

4. **è®¾å¤‡ç®¡ç†ç§‘å­¦è§„èŒƒ**ï¼šè®¾å¤‡å…¨ç”Ÿå‘½å‘¨æœŸç®¡ç†å®ç°åï¼Œæ•…éšœç‡ä¸‹é™47%ï¼Œè®¾å¤‡ä½¿ç”¨å¯¿å‘½å»¶é•¿20%ï¼Œå¹´åº¦ç»´ä¿®æˆæœ¬èŠ‚çº¦150ä¸‡å…ƒã€‚

5. **æ•°æ®é©±åŠ¨å†³ç­–æ”¯æ’‘**ï¼šç®¡ç†å±‚å¯ä»¥å®æ—¶æŸ¥çœ‹å„é¡¹ç›®è¿è¥æ•°æ®ï¼Œå†³ç­–æ•ˆç‡æå‡3å€ï¼Œèµ„æºé…ç½®æ›´åŠ ç§‘å­¦åˆç†ã€‚

**æˆåŠŸç»éªŒ**ï¼š

1. **é«˜å±‚æ”¯æŒæ˜¯å…³é”®**ï¼šé›†å›¢é«˜å±‚é«˜åº¦é‡è§†ï¼Œæˆç«‹äº†ä¸“é¡¹å·¥ä½œç»„ï¼Œç¡®ä¿é¡¹ç›®èµ„æºå……è¶³ã€‚
2. **åˆ†é˜¶æ®µç¨³å¦¥æ¨è¿›**ï¼šé‡‡ç”¨è¯•ç‚¹å…ˆè¡Œç­–ç•¥ï¼Œå…ˆåœ¨3ä¸ªé¡¹ç›®è¯•ç‚¹ï¼Œæˆç†Ÿåå…¨é¢æ¨å¹¿ã€‚
3. **é‡è§†æ•°æ®æ²»ç†**ï¼šæŠ•å…¥è¶³å¤Ÿèµ„æºè¿›è¡Œå†å²æ•°æ®æ¸…æ´—å’Œæ ‡å‡†åŒ–ï¼Œä¸ºç³»ç»Ÿä¸Šçº¿å¥ å®šåŸºç¡€ã€‚
4. **æŒç»­ä¼˜åŒ–è¿­ä»£**ï¼šå»ºç«‹ç”¨æˆ·åé¦ˆæœºåˆ¶ï¼Œæ¯æœˆæ”¶é›†æ”¹è¿›å»ºè®®ï¼ŒæŒç»­ä¼˜åŒ–ç³»ç»Ÿä½“éªŒã€‚

---

**å‚è€ƒæ¡ˆä¾‹**ï¼š

- [ä¸‡ç§‘ç‰©ä¸šæ™ºæ…§ç¤¾åŒº](https://www.vankeweekly.com/)
- [ç¢§æ¡‚å›­æœåŠ¡æ•°å­—åŒ–](https://www.bgyfw.com/)
