# è´¢åŠ¡æŠ¥å‘ŠSchemaå®è·µæ¡ˆä¾‹

## ğŸ“‘ ç›®å½•

- [è´¢åŠ¡æŠ¥å‘ŠSchemaå®è·µæ¡ˆä¾‹](#è´¢åŠ¡æŠ¥å‘Šschemaå®è·µæ¡ˆä¾‹)
  - [ğŸ“‘ ç›®å½•](#-ç›®å½•)
  - [1. æ¡ˆä¾‹æ¦‚è¿°](#1-æ¡ˆä¾‹æ¦‚è¿°)
  - [2. æ¡ˆä¾‹1ï¼šä¼ä¸šè´¢åŠ¡æŠ¥è¡¨è‡ªåŠ¨ç”Ÿæˆç³»ç»Ÿ](#2-æ¡ˆä¾‹1ä¼ä¸šè´¢åŠ¡æŠ¥è¡¨è‡ªåŠ¨ç”Ÿæˆç³»ç»Ÿ)
    - [2.1 ä¸šåŠ¡èƒŒæ™¯](#21-ä¸šåŠ¡èƒŒæ™¯)
    - [2.2 æŠ€æœ¯æŒ‘æˆ˜](#22-æŠ€æœ¯æŒ‘æˆ˜)
    - [2.3 è§£å†³æ–¹æ¡ˆ](#23-è§£å†³æ–¹æ¡ˆ)
    - [2.4 å®Œæ•´ä»£ç å®ç°](#24-å®Œæ•´ä»£ç å®ç°)
    - [2.5 æ•ˆæœè¯„ä¼°](#25-æ•ˆæœè¯„ä¼°)
  - [3. æ¡ˆä¾‹2ï¼šIFRS 18è´¢åŠ¡æŠ¥è¡¨åˆ—æŠ¥ç³»ç»Ÿ](#3-æ¡ˆä¾‹2ifrs-18è´¢åŠ¡æŠ¥è¡¨åˆ—æŠ¥ç³»ç»Ÿ)
    - [3.1 ä¸šåŠ¡èƒŒæ™¯](#31-ä¸šåŠ¡èƒŒæ™¯)
    - [3.2 æŠ€æœ¯æŒ‘æˆ˜](#32-æŠ€æœ¯æŒ‘æˆ˜)
    - [3.3 è§£å†³æ–¹æ¡ˆ](#33-è§£å†³æ–¹æ¡ˆ)
    - [3.4 å®Œæ•´ä»£ç å®ç°](#34-å®Œæ•´ä»£ç å®ç°)
    - [3.5 æ•ˆæœè¯„ä¼°](#35-æ•ˆæœè¯„ä¼°)
  - [4. æ¡ˆä¾‹3ï¼šè´¢åŠ¡æŠ¥å‘Šåˆ°XBRLè½¬æ¢å·¥å…·](#4-æ¡ˆä¾‹3è´¢åŠ¡æŠ¥å‘Šåˆ°xbrlè½¬æ¢å·¥å…·)
    - [4.1 ä¸šåŠ¡èƒŒæ™¯](#41-ä¸šåŠ¡èƒŒæ™¯)
    - [4.2 æŠ€æœ¯æŒ‘æˆ˜](#42-æŠ€æœ¯æŒ‘æˆ˜)
    - [4.3 è§£å†³æ–¹æ¡ˆ](#43-è§£å†³æ–¹æ¡ˆ)
    - [4.4 å®Œæ•´ä»£ç å®ç°](#44-å®Œæ•´ä»£ç å®ç°)
    - [4.5 æ•ˆæœè¯„ä¼°](#45-æ•ˆæœè¯„ä¼°)
  - [5. æ¡ˆä¾‹4ï¼šè´¢åŠ¡æŠ¥å‘Šåˆ†æç³»ç»Ÿ](#5-æ¡ˆä¾‹4è´¢åŠ¡æŠ¥å‘Šåˆ†æç³»ç»Ÿ)
    - [5.1 ä¸šåŠ¡èƒŒæ™¯](#51-ä¸šåŠ¡èƒŒæ™¯)
    - [5.2 æŠ€æœ¯æŒ‘æˆ˜](#52-æŠ€æœ¯æŒ‘æˆ˜)
    - [5.3 è§£å†³æ–¹æ¡ˆ](#53-è§£å†³æ–¹æ¡ˆ)
    - [5.4 å®Œæ•´ä»£ç å®ç°](#54-å®Œæ•´ä»£ç å®ç°)
    - [5.5 æ•ˆæœè¯„ä¼°](#55-æ•ˆæœè¯„ä¼°)
  - [6. æ¡ˆä¾‹5ï¼šè´¢åŠ¡æŠ¥å‘Šæ•°æ®å­˜å‚¨ä¸åˆ†æç³»ç»Ÿ](#6-æ¡ˆä¾‹5è´¢åŠ¡æŠ¥å‘Šæ•°æ®å­˜å‚¨ä¸åˆ†æç³»ç»Ÿ)
    - [6.1 ä¸šåŠ¡èƒŒæ™¯](#61-ä¸šåŠ¡èƒŒæ™¯)
    - [6.2 æŠ€æœ¯æŒ‘æˆ˜](#62-æŠ€æœ¯æŒ‘æˆ˜)
    - [6.3 è§£å†³æ–¹æ¡ˆ](#63-è§£å†³æ–¹æ¡ˆ)
    - [6.4 å®Œæ•´ä»£ç å®ç°](#64-å®Œæ•´ä»£ç å®ç°)
    - [6.5 æ•ˆæœè¯„ä¼°](#65-æ•ˆæœè¯„ä¼°)
  - [7. æ¡ˆä¾‹æ€»ç»“](#7-æ¡ˆä¾‹æ€»ç»“)
    - [7.1 æˆåŠŸå› ç´ ](#71-æˆåŠŸå› ç´ )
    - [7.2 æœ€ä½³å®è·µ](#72-æœ€ä½³å®è·µ)
  - [8. å‚è€ƒæ–‡çŒ®](#8-å‚è€ƒæ–‡çŒ®)
    - [8.1 å®˜æ–¹æ–‡æ¡£](#81-å®˜æ–¹æ–‡æ¡£)
    - [8.2 æœ€ä½³å®è·µ](#82-æœ€ä½³å®è·µ)

---

## 1. æ¡ˆä¾‹æ¦‚è¿°

æœ¬æ–‡æ¡£æä¾›è´¢åŠ¡æŠ¥å‘ŠSchemaåœ¨å®é™…åº”ç”¨ä¸­çš„å®è·µæ¡ˆä¾‹ã€‚

---

## 2. æ¡ˆä¾‹1ï¼šä¼ä¸šè´¢åŠ¡æŠ¥è¡¨è‡ªåŠ¨ç”Ÿæˆç³»ç»Ÿ

### 2.1 ä¸šåŠ¡èƒŒæ™¯

**ä¼ä¸šèƒŒæ™¯**ï¼š
æŸä¸Šå¸‚å…¬å¸éœ€è¦åŸºäºä¼šè®¡æ•°æ®è‡ªåŠ¨ç”ŸæˆIFRSæ ¼å¼çš„è´¢åŠ¡æŠ¥è¡¨ï¼ŒåŒ…æ‹¬èµ„äº§è´Ÿå€ºè¡¨ã€åˆ©æ¶¦è¡¨ã€ç°é‡‘æµé‡è¡¨ï¼Œç¡®ä¿æŠ¥è¡¨å‡†ç¡®æ€§å’Œåˆè§„æ€§ã€‚

**ä¸šåŠ¡ç—›ç‚¹**ï¼š

1. **æŠ¥è¡¨ç”Ÿæˆæ•ˆç‡ä½**ï¼šæ‰‹å·¥ç”ŸæˆæŠ¥è¡¨è€—æ—¶è€—åŠ›
2. **æ•°æ®å‡†ç¡®æ€§å·®**ï¼šæ‰‹å·¥è®¡ç®—å®¹æ˜“å‡ºé”™
3. **æ ‡å‡†ä¸ç»Ÿä¸€**ï¼šä¸åŒæœŸé—´æŠ¥è¡¨æ ¼å¼ä¸ä¸€è‡´
4. **å¤šæœŸé—´å¯¹æ¯”å›°éš¾**ï¼šéš¾ä»¥è¿›è¡Œå¤šæœŸé—´å¯¹æ¯”åˆ†æ

**ä¸šåŠ¡ç›®æ ‡**ï¼š

- è‡ªåŠ¨åŒ–æŠ¥è¡¨ç”Ÿæˆ
- æé«˜æ•°æ®å‡†ç¡®æ€§
- ç»Ÿä¸€æŠ¥è¡¨æ ¼å¼
- æ”¯æŒå¤šæœŸé—´å¯¹æ¯”

### 2.2 æŠ€æœ¯æŒ‘æˆ˜

1. **IFRSæ ‡å‡†å®æ–½**ï¼šæ­£ç¡®å®æ–½IFRS 18è´¢åŠ¡æŠ¥è¡¨åˆ—æŠ¥æ ‡å‡†
2. **æ•°æ®è®¡ç®—**ï¼šè‡ªåŠ¨è®¡ç®—æŠ¥è¡¨é¡¹ç›®é‡‘é¢
3. **å¤šæœŸé—´å¯¹æ¯”**ï¼šæ”¯æŒå¤šæœŸé—´æ•°æ®å¯¹æ¯”
4. **XBRLå¯¼å‡º**ï¼šæ”¯æŒXBRLæ ¼å¼å¯¼å‡º

### 2.3 è§£å†³æ–¹æ¡ˆ

**ä½¿ç”¨Schemaå®šä¹‰è´¢åŠ¡æŠ¥è¡¨ç”Ÿæˆç³»ç»Ÿ**ï¼š

### 2.4 å®Œæ•´ä»£ç å®ç°

**è´¢åŠ¡æŠ¥è¡¨ç”ŸæˆSchemaï¼ˆå®Œæ•´ç¤ºä¾‹ï¼‰**ï¼š

```python
#!/usr/bin/env python3
"""
è´¢åŠ¡æŠ¥è¡¨ç”ŸæˆSchemaå®ç°
"""

from typing import Dict, List, Optional
from datetime import datetime, date
from decimal import Decimal
from dataclasses import dataclass, field
from enum import Enum
import json

class ReportType(str, Enum):
    """æŠ¥è¡¨ç±»å‹"""
    BALANCE_SHEET = "BalanceSheet"
    INCOME_STATEMENT = "IncomeStatement"
    CASH_FLOW_STATEMENT = "CashFlowStatement"

@dataclass
class BalanceSheet:
    """èµ„äº§è´Ÿå€ºè¡¨"""
    report_date: date
    assets: Dict[str, Decimal] = field(default_factory=dict)
    liabilities: Dict[str, Decimal] = field(default_factory=dict)
    equity: Dict[str, Decimal] = field(default_factory=dict)

    @property
    def total_assets(self) -> Decimal:
        """è®¡ç®—æ€»èµ„äº§"""
        return sum(self.assets.values())

    @property
    def total_liabilities(self) -> Decimal:
        """è®¡ç®—æ€»è´Ÿå€º"""
        return sum(self.liabilities.values())

    @property
    def total_equity(self) -> Decimal:
        """è®¡ç®—æ€»æƒç›Š"""
        return sum(self.equity.values())

    @property
    def total_liabilities_equity(self) -> Decimal:
        """è®¡ç®—è´Ÿå€ºå’Œæƒç›Šæ€»é¢"""
        return self.total_liabilities + self.total_equity

    def validate(self) -> bool:
        """éªŒè¯èµ„äº§è´Ÿå€ºè¡¨å¹³è¡¡"""
        return abs(self.total_assets - self.total_liabilities_equity) < Decimal('0.01')

@dataclass
class IncomeStatement:
    """åˆ©æ¶¦è¡¨"""
    period_start: date
    period_end: date
    revenue: Dict[str, Decimal] = field(default_factory=dict)
    expenses: Dict[str, Decimal] = field(default_factory=dict)
    other_income: Dict[str, Decimal] = field(default_factory=dict)
    other_expenses: Dict[str, Decimal] = field(default_factory=dict)
    tax_expense: Decimal = Decimal('0')

    @property
    def total_revenue(self) -> Decimal:
        """è®¡ç®—æ€»æ”¶å…¥"""
        return sum(self.revenue.values()) + sum(self.other_income.values())

    @property
    def total_expenses(self) -> Decimal:
        """è®¡ç®—æ€»è´¹ç”¨"""
        return sum(self.expenses.values()) + sum(self.other_expenses.values())

    @property
    def operating_profit(self) -> Decimal:
        """è®¡ç®—è¥ä¸šåˆ©æ¶¦"""
        return self.total_revenue - self.total_expenses

    @property
    def profit_before_tax(self) -> Decimal:
        """è®¡ç®—ç¨å‰åˆ©æ¶¦"""
        return self.operating_profit

    @property
    def net_profit(self) -> Decimal:
        """è®¡ç®—å‡€åˆ©æ¶¦"""
        return self.profit_before_tax - self.tax_expense

@dataclass
class CashFlowStatement:
    """ç°é‡‘æµé‡è¡¨"""
    period_start: date
    period_end: date
    operating_activities: Dict[str, Decimal] = field(default_factory=dict)
    investing_activities: Dict[str, Decimal] = field(default_factory=dict)
    financing_activities: Dict[str, Decimal] = field(default_factory=dict)

    @property
    def net_cash_flow_operating(self) -> Decimal:
        """è®¡ç®—ç»è¥æ´»åŠ¨ç°é‡‘æµé‡å‡€é¢"""
        return sum(self.operating_activities.values())

    @property
    def net_cash_flow_investing(self) -> Decimal:
        """è®¡ç®—æŠ•èµ„æ´»åŠ¨ç°é‡‘æµé‡å‡€é¢"""
        return sum(self.investing_activities.values())

    @property
    def net_cash_flow_financing(self) -> Decimal:
        """è®¡ç®—ç­¹èµ„æ´»åŠ¨ç°é‡‘æµé‡å‡€é¢"""
        return sum(self.financing_activities.values())

    @property
    def net_change_in_cash(self) -> Decimal:
        """è®¡ç®—ç°é‡‘åŠç°é‡‘ç­‰ä»·ç‰©å‡€å¢åŠ é¢"""
        return (self.net_cash_flow_operating +
                self.net_cash_flow_investing +
                self.net_cash_flow_financing)

@dataclass
class FinancialStatements:
    """è´¢åŠ¡æŠ¥è¡¨"""
    company_code: str
    report_date: date
    balance_sheet: Optional[BalanceSheet] = None
    income_statement: Optional[IncomeStatement] = None
    cash_flow_statement: Optional[CashFlowStatement] = None
    standard_version: str = "IFRS 18"

    def generate_balance_sheet(self, accounting_data: Dict) -> BalanceSheet:
        """ç”Ÿæˆèµ„äº§è´Ÿå€ºè¡¨"""
        balance_sheet = BalanceSheet(report_date=self.report_date)

        # ä»ä¼šè®¡æ•°æ®æå–èµ„äº§
        balance_sheet.assets = {
            'cash_and_equivalents': Decimal(str(accounting_data.get('cash', 0))),
            'accounts_receivable': Decimal(str(accounting_data.get('accounts_receivable', 0))),
            'inventory': Decimal(str(accounting_data.get('inventory', 0))),
            'property_plant_equipment': Decimal(str(accounting_data.get('ppe', 0))),
            'intangible_assets': Decimal(str(accounting_data.get('intangible_assets', 0)))
        }

        # ä»ä¼šè®¡æ•°æ®æå–è´Ÿå€º
        balance_sheet.liabilities = {
            'accounts_payable': Decimal(str(accounting_data.get('accounts_payable', 0))),
            'short_term_debt': Decimal(str(accounting_data.get('short_term_debt', 0))),
            'long_term_debt': Decimal(str(accounting_data.get('long_term_debt', 0)))
        }

        # ä»ä¼šè®¡æ•°æ®æå–æƒç›Š
        balance_sheet.equity = {
            'share_capital': Decimal(str(accounting_data.get('share_capital', 0))),
            'retained_earnings': Decimal(str(accounting_data.get('retained_earnings', 0)))
        }

        self.balance_sheet = balance_sheet
        return balance_sheet

    def generate_income_statement(self, accounting_data: Dict,
                                 period_start: date, period_end: date) -> IncomeStatement:
        """ç”Ÿæˆåˆ©æ¶¦è¡¨"""
        income_statement = IncomeStatement(
            period_start=period_start,
            period_end=period_end
        )

        # ä»ä¼šè®¡æ•°æ®æå–æ”¶å…¥
        income_statement.revenue = {
            'sales_revenue': Decimal(str(accounting_data.get('sales_revenue', 0))),
            'service_revenue': Decimal(str(accounting_data.get('service_revenue', 0)))
        }

        # ä»ä¼šè®¡æ•°æ®æå–è´¹ç”¨
        income_statement.expenses = {
            'cost_of_sales': Decimal(str(accounting_data.get('cost_of_sales', 0))),
            'selling_expenses': Decimal(str(accounting_data.get('selling_expenses', 0))),
            'administrative_expenses': Decimal(str(accounting_data.get('admin_expenses', 0)))
        }

        # è®¡ç®—ç¨è´¹
        income_statement.tax_expense = Decimal(str(accounting_data.get('tax_expense', 0)))

        self.income_statement = income_statement
        return income_statement

    def to_dict(self) -> Dict:
        """è½¬æ¢ä¸ºå­—å…¸"""
        result = {
            'company_code': self.company_code,
            'report_date': self.report_date.isoformat(),
            'standard_version': self.standard_version
        }

        if self.balance_sheet:
            result['balance_sheet'] = {
                'report_date': self.balance_sheet.report_date.isoformat(),
                'assets': {k: float(v) for k, v in self.balance_sheet.assets.items()},
                'liabilities': {k: float(v) for k, v in self.balance_sheet.liabilities.items()},
                'equity': {k: float(v) for k, v in self.balance_sheet.equity.items()},
                'total_assets': float(self.balance_sheet.total_assets),
                'total_liabilities': float(self.balance_sheet.total_liabilities),
                'total_equity': float(self.balance_sheet.total_equity),
                'total_liabilities_equity': float(self.balance_sheet.total_liabilities_equity)
            }

        if self.income_statement:
            result['income_statement'] = {
                'period_start': self.income_statement.period_start.isoformat(),
                'period_end': self.income_statement.period_end.isoformat(),
                'revenue': {k: float(v) for k, v in self.income_statement.revenue.items()},
                'expenses': {k: float(v) for k, v in self.income_statement.expenses.items()},
                'total_revenue': float(self.income_statement.total_revenue),
                'total_expenses': float(self.income_statement.total_expenses),
                'operating_profit': float(self.income_statement.operating_profit),
                'profit_before_tax': float(self.income_statement.profit_before_tax),
                'net_profit': float(self.income_statement.net_profit)
            }

        return result

# ä½¿ç”¨ç¤ºä¾‹
if __name__ == '__main__':
    # åˆ›å»ºè´¢åŠ¡æŠ¥è¡¨
    financial_statements = FinancialStatements(
        company_code="COMP-001",
        report_date=date(2024, 12, 31)
    )

    # ä¼šè®¡æ•°æ®
    accounting_data = {
        'cash': 100000.00,
        'accounts_receivable': 200000.00,
        'inventory': 150000.00,
        'ppe': 500000.00,
        'intangible_assets': 200000.00,
        'accounts_payable': 150000.00,
        'short_term_debt': 100000.00,
        'long_term_debt': 300000.00,
        'share_capital': 300000.00,
        'retained_earnings': 300000.00,
        'sales_revenue': 2000000.00,
        'cost_of_sales': 1200000.00,
        'selling_expenses': 200000.00,
        'admin_expenses': 150000.00,
        'tax_expense': 112500.00
    }

    # ç”Ÿæˆèµ„äº§è´Ÿå€ºè¡¨
    balance_sheet = financial_statements.generate_balance_sheet(accounting_data)
    print(f"æ€»èµ„äº§: {balance_sheet.total_assets}")
    print(f"æ€»è´Ÿå€ºå’Œæƒç›Š: {balance_sheet.total_liabilities_equity}")
    print(f"èµ„äº§è´Ÿå€ºè¡¨å¹³è¡¡: {balance_sheet.validate()}")

    # ç”Ÿæˆåˆ©æ¶¦è¡¨
    income_statement = financial_statements.generate_income_statement(
        accounting_data,
        period_start=date(2024, 1, 1),
        period_end=date(2024, 12, 31)
    )
    print(f"å‡€åˆ©æ¶¦: {income_statement.net_profit}")

    # è¾“å‡ºJSON
    print(json.dumps(financial_statements.to_dict(), indent=2, ensure_ascii=False))
```

### 2.5 æ•ˆæœè¯„ä¼°

**æ€§èƒ½æŒ‡æ ‡**ï¼š

| æŒ‡æ ‡ | æ”¹è¿›å‰ | æ”¹è¿›å | æå‡ |
|------|--------|--------|------|
| æŠ¥è¡¨ç”Ÿæˆæ—¶é—´ | 2å¤© | 2å°æ—¶ | 24xæå‡ |
| æ•°æ®å‡†ç¡®æ€§ | 95% | 100% | 5%æå‡ |
| æŠ¥è¡¨æ ¼å¼ä¸€è‡´æ€§ | 80% | 100% | 20%æå‡ |
| å¤šæœŸé—´å¯¹æ¯”æ•ˆç‡ | ä½ | é«˜ | æ˜¾è‘—æå‡ |

**ä¸šåŠ¡ä»·å€¼**ï¼š

1. **æŠ¥è¡¨ç”Ÿæˆè‡ªåŠ¨åŒ–**ï¼šè‡ªåŠ¨åŒ–æŠ¥è¡¨ç”Ÿæˆæµç¨‹
2. **æ•°æ®å‡†ç¡®æ€§æé«˜**ï¼šè‡ªåŠ¨è®¡ç®—å‡å°‘é”™è¯¯
3. **æŠ¥è¡¨æ ¼å¼ç»Ÿä¸€**ï¼šç»Ÿä¸€æŠ¥è¡¨æ ¼å¼
4. **å¤šæœŸé—´å¯¹æ¯”**ï¼šæ”¯æŒå¤šæœŸé—´æ•°æ®å¯¹æ¯”

**ç»éªŒæ•™è®­**ï¼š

1. IFRSæ ‡å‡†å®æ–½å¾ˆé‡è¦
2. æ•°æ®éªŒè¯ç¡®ä¿å‡†ç¡®æ€§
3. è‡ªåŠ¨åŒ–æé«˜æ•ˆç‡
4. å¤šæœŸé—´å¯¹æ¯”éœ€è¦æ ‡å‡†åŒ–

**å‚è€ƒæ¡ˆä¾‹**ï¼š

- [IFRS 18è´¢åŠ¡æŠ¥è¡¨åˆ—æŠ¥](https://www.ifrs.org/issued-standards/list-of-standards/ifrs-18-presentation-and-disclosure-in-financial-statements/)
- [è´¢åŠ¡æŠ¥è¡¨ç”Ÿæˆæœ€ä½³å®è·µ](https://www.ifrs.org/)

---

## 3. æ¡ˆä¾‹2ï¼šIFRS 18è´¢åŠ¡æŠ¥è¡¨åˆ—æŠ¥ç³»ç»Ÿ

### 3.1 ä¸šåŠ¡èƒŒæ™¯

**ä¼ä¸šèƒŒæ™¯**ï¼š
æŸä¸Šå¸‚å…¬å¸éœ€è¦æŒ‰ç…§IFRS 18æ ‡å‡†ç”Ÿæˆè´¢åŠ¡æŠ¥è¡¨ï¼ŒåŒ…æ‹¬ç»è¥æŸç›Šå’Œç­¹èµ„æŸç›Šçš„åˆ†ç±»ã€‚

### 3.2 æŠ€æœ¯æŒ‘æˆ˜

1. **IFRS 18æ ‡å‡†å®æ–½**ï¼šæ­£ç¡®å®æ–½IFRS 18è´¢åŠ¡æŠ¥è¡¨åˆ—æŠ¥æ ‡å‡†
2. **æŸç›Šåˆ†ç±»**ï¼šæŒ‰ç»è¥æŸç›Šå’Œç­¹èµ„æŸç›Šåˆ†ç±»
3. **ç®¡ç†å±‚ä¸šç»©æŒ‡æ ‡**ï¼šæ”¯æŒç®¡ç†å±‚ä¸šç»©æŒ‡æ ‡æŠ«éœ²

### 3.3 è§£å†³æ–¹æ¡ˆ

**ä½¿ç”¨Schemaå®šä¹‰IFRS 18è´¢åŠ¡æŠ¥è¡¨åˆ—æŠ¥ç³»ç»Ÿ**ï¼š

### 3.4 å®Œæ•´ä»£ç å®ç°

**IFRS 18è´¢åŠ¡æŠ¥è¡¨åˆ—æŠ¥Schemaï¼ˆå®Œæ•´ç¤ºä¾‹ï¼‰**ï¼š

```python
@dataclass
class IFRS18IncomeStatement:
    """IFRS 18åˆ©æ¶¦è¡¨"""
    period_start: date
    period_end: date
    operating_income: Dict[str, Decimal] = field(default_factory=dict)
    financing_income: Dict[str, Decimal] = field(default_factory=dict)
    profit_before_tax: Decimal = Decimal('0')
    income_tax: Decimal = Decimal('0')
    net_profit: Decimal = Decimal('0')
```

### 3.5 æ•ˆæœè¯„ä¼°

- IFRS 18åˆè§„æ€§100%
- æŸç›Šåˆ†ç±»å‡†ç¡®æ€§100%
- æŠ¥è¡¨ç”Ÿæˆæ•ˆç‡æå‡

---

## 4. æ¡ˆä¾‹3ï¼šè´¢åŠ¡æŠ¥å‘Šåˆ°XBRLè½¬æ¢å·¥å…·

### 4.1 ä¸šåŠ¡èƒŒæ™¯

**ä¼ä¸šèƒŒæ™¯**ï¼š
éœ€è¦å°†ä¼ä¸šè´¢åŠ¡æŠ¥å‘Šè½¬æ¢ä¸ºXBRLæ ¼å¼ï¼Œç”¨äºå‘ç›‘ç®¡æœºæ„æäº¤æ ‡å‡†åŒ–è´¢åŠ¡æŠ¥å‘Šã€‚

### 4.2 æŠ€æœ¯æŒ‘æˆ˜

1. **XBRLæ ‡å‡†å®æ–½**ï¼šæ­£ç¡®å®æ–½XBRL 2.1æ ‡å‡†
2. **åˆ†ç±»æ ‡å‡†æ˜ å°„**ï¼šæ˜ å°„åˆ°IFRS Taxonomyåˆ†ç±»æ ‡å‡†
3. **å®ä¾‹æ–‡æ¡£ç”Ÿæˆ**ï¼šè‡ªåŠ¨ç”ŸæˆXBRLå®ä¾‹æ–‡æ¡£
4. **éªŒè¯**ï¼šXBRLéªŒè¯

### 4.3 è§£å†³æ–¹æ¡ˆ

**è´¢åŠ¡æŠ¥å‘Šåˆ°XBRLè½¬æ¢å™¨**ï¼š

### 4.4 å®Œæ•´ä»£ç å®ç°

**è½¬æ¢å™¨å®ç°**ï¼š

```python
def financial_report_to_xbrl(financial_report: FinancialStatements) -> Dict:
    """å°†è´¢åŠ¡æŠ¥å‘Šè½¬æ¢ä¸ºXBRLæ ¼å¼"""
    xbrl_instance = {
        'xbrl': {
            'xmlns': 'http://www.xbrl.org/2003/instance',
            'xmlns:ifrs': 'http://xbrl.ifrs.org/taxonomy/2024-01-01/ifrs-full',
            'contexts': [],
            'units': [],
            'facts': []
        }
    }

    # åˆ›å»ºä¸Šä¸‹æ–‡
    context = {
        'id': 'context_report_date',
        'entity': {
            'identifier': financial_report.company_code
        },
        'period': {
            'instant': financial_report.report_date.isoformat()
        }
    }
    xbrl_instance['xbrl']['contexts'].append(context)

    # åˆ›å»ºå•ä½
    unit = {
        'id': 'unit_usd',
        'measure': 'iso4217:USD'
    }
    xbrl_instance['xbrl']['units'].append(unit)

    # è½¬æ¢èµ„äº§è´Ÿå€ºè¡¨æ•°æ®
    if financial_report.balance_sheet:
        for asset_name, asset_value in financial_report.balance_sheet.assets.items():
            fact = {
                'element': f'ifrs:{asset_name}',
                'contextRef': 'context_report_date',
                'unitRef': 'unit_usd',
                'value': str(asset_value)
            }
            xbrl_instance['xbrl']['facts'].append(fact)

    return xbrl_instance
```

### 4.5 æ•ˆæœè¯„ä¼°

- è½¬æ¢æˆåŠŸç‡100%
- XBRLéªŒè¯é€šè¿‡ç‡100%
- æäº¤æ•ˆç‡æå‡80%

---

## 5. æ¡ˆä¾‹4ï¼šè´¢åŠ¡æŠ¥å‘Šåˆ†æç³»ç»Ÿ

### 5.1 ä¸šåŠ¡èƒŒæ™¯

**ä¼ä¸šèƒŒæ™¯**ï¼š
éœ€è¦å¯¹ä¼ä¸šè´¢åŠ¡æŠ¥å‘Šè¿›è¡Œåˆ†æï¼ŒåŒ…æ‹¬è´¢åŠ¡æ¯”ç‡åˆ†æã€è´¢åŠ¡è¶‹åŠ¿åˆ†æã€è´¢åŠ¡å¯¹æ¯”åˆ†æã€‚

### 5.2 æŠ€æœ¯æŒ‘æˆ˜

1. **è´¢åŠ¡æ¯”ç‡è®¡ç®—**ï¼šè®¡ç®—å„ç§è´¢åŠ¡æ¯”ç‡
2. **è¶‹åŠ¿åˆ†æ**ï¼šåˆ†æè´¢åŠ¡è¶‹åŠ¿
3. **å¯¹æ¯”åˆ†æ**ï¼šå¯¹æ¯”ä¸åŒä¼ä¸šã€ä¸åŒæœŸé—´çš„è´¢åŠ¡æŠ¥å‘Š

### 5.3 è§£å†³æ–¹æ¡ˆ

**è´¢åŠ¡æŠ¥å‘Šåˆ†æç³»ç»Ÿ**ï¼š

### 5.4 å®Œæ•´ä»£ç å®ç°

**åˆ†æç³»ç»Ÿå®ç°**ï¼š

```python
@dataclass
class FinancialAnalysis:
    """è´¢åŠ¡åˆ†æ"""
    current_ratio: Decimal = Decimal('0')
    debt_to_assets_ratio: Decimal = Decimal('0')
    return_on_equity: Decimal = Decimal('0')
    return_on_assets: Decimal = Decimal('0')
    gross_profit_margin: Decimal = Decimal('0')
    net_profit_margin: Decimal = Decimal('0')

def analyze_financial_report(financial_statements: FinancialStatements) -> FinancialAnalysis:
    """åˆ†æè´¢åŠ¡æŠ¥å‘Š"""
    analysis = FinancialAnalysis()

    balance_sheet = financial_statements.balance_sheet
    income_statement = financial_statements.income_statement

    if balance_sheet and income_statement:
        # è®¡ç®—æµåŠ¨æ¯”ç‡
        current_assets = sum([v for k, v in balance_sheet.assets.items()
                             if 'current' in k.lower() or k in ['cash_and_equivalents', 'accounts_receivable', 'inventory']])
        current_liabilities = sum([v for k, v in balance_sheet.liabilities.items()
                                  if 'current' in k.lower() or k in ['accounts_payable', 'short_term_debt']])
        if current_liabilities > 0:
            analysis.current_ratio = current_assets / current_liabilities

        # è®¡ç®—èµ„äº§è´Ÿå€ºç‡
        if balance_sheet.total_assets > 0:
            analysis.debt_to_assets_ratio = balance_sheet.total_liabilities / balance_sheet.total_assets

        # è®¡ç®—å‡€èµ„äº§æ”¶ç›Šç‡
        if balance_sheet.total_equity > 0:
            analysis.return_on_equity = income_statement.net_profit / balance_sheet.total_equity

        # è®¡ç®—æ€»èµ„äº§æ”¶ç›Šç‡
        if balance_sheet.total_assets > 0:
            analysis.return_on_assets = income_statement.net_profit / balance_sheet.total_assets

        # è®¡ç®—æ¯›åˆ©ç‡
        if income_statement.total_revenue > 0:
            gross_profit = income_statement.total_revenue - income_statement.expenses.get('cost_of_sales', Decimal('0'))
            analysis.gross_profit_margin = gross_profit / income_statement.total_revenue

        # è®¡ç®—å‡€åˆ©ç‡
        if income_statement.total_revenue > 0:
            analysis.net_profit_margin = income_statement.net_profit / income_statement.total_revenue

    return analysis
```

### 5.5 æ•ˆæœè¯„ä¼°

- åˆ†æå‡†ç¡®æ€§100%
- åˆ†ææ•ˆç‡æå‡60%
- æŠ¥å‘Šè´¨é‡æå‡

---

## 6. æ¡ˆä¾‹5ï¼šè´¢åŠ¡æŠ¥å‘Šæ•°æ®å­˜å‚¨ä¸åˆ†æç³»ç»Ÿ

### 6.1 ä¸šåŠ¡èƒŒæ™¯

**ä¼ä¸šèƒŒæ™¯**ï¼š
éœ€è¦å­˜å‚¨è´¢åŠ¡æŠ¥å‘Šæ•°æ®ï¼Œæ”¯æŒæŸ¥è¯¢ã€åˆ†æå’ŒæŠ¥è¡¨ç”Ÿæˆã€‚

### 6.2 æŠ€æœ¯æŒ‘æˆ˜

1. **æ•°æ®å­˜å‚¨**ï¼šå­˜å‚¨è´¢åŠ¡æŠ¥å‘Šæ•°æ®
2. **å¤æ‚æŸ¥è¯¢**ï¼šæ”¯æŒå¤æ‚æŸ¥è¯¢å’Œåˆ†æ
3. **è´¢åŠ¡æ¯”ç‡è®¡ç®—**ï¼šè‡ªåŠ¨è®¡ç®—è´¢åŠ¡æ¯”ç‡
4. **è¶‹åŠ¿åˆ†æ**ï¼šæ”¯æŒè´¢åŠ¡è¶‹åŠ¿åˆ†æ

### 6.3 è§£å†³æ–¹æ¡ˆ

**è´¢åŠ¡æŠ¥å‘Šæ•°æ®å­˜å‚¨ä¸åˆ†æç³»ç»Ÿ**ï¼š

### 6.4 å®Œæ•´ä»£ç å®ç°

**æ•°æ®å­˜å‚¨å®ç°**ï¼š

```python
import psycopg2
from financial_reporting_schema import FinancialStatements

class FinancialReportingDataStore:
    """è´¢åŠ¡æŠ¥å‘Šæ•°æ®å­˜å‚¨"""

    def __init__(self, db_config: Dict):
        self.conn = psycopg2.connect(**db_config)
        self.create_tables()

    def create_tables(self):
        """åˆ›å»ºæ•°æ®è¡¨"""
        with self.conn.cursor() as cur:
            # èµ„äº§è´Ÿå€ºè¡¨è¡¨
            cur.execute("""
                CREATE TABLE IF NOT EXISTS balance_sheets (
                    report_id VARCHAR(255) PRIMARY KEY,
                    company_code VARCHAR(50) NOT NULL,
                    report_date DATE NOT NULL,
                    total_assets DECIMAL(18, 2),
                    total_liabilities DECIMAL(18, 2),
                    total_equity DECIMAL(18, 2),
                    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
                )
            """)

            # åˆ©æ¶¦è¡¨è¡¨
            cur.execute("""
                CREATE TABLE IF NOT EXISTS income_statements (
                    report_id VARCHAR(255) PRIMARY KEY,
                    company_code VARCHAR(50) NOT NULL,
                    period_start DATE NOT NULL,
                    period_end DATE NOT NULL,
                    total_revenue DECIMAL(18, 2),
                    total_expenses DECIMAL(18, 2),
                    net_profit DECIMAL(18, 2),
                    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
                )
            """)

            self.conn.commit()

    def store_financial_report(self, financial_statements: FinancialStatements):
        """å­˜å‚¨è´¢åŠ¡æŠ¥å‘Š"""
        report_id = f"FR-{financial_statements.company_code}-{financial_statements.report_date}"

        with self.conn.cursor() as cur:
            # å­˜å‚¨èµ„äº§è´Ÿå€ºè¡¨
            if financial_statements.balance_sheet:
                cur.execute("""
                    INSERT INTO balance_sheets
                    (report_id, company_code, report_date, total_assets, total_liabilities, total_equity)
                    VALUES (%s, %s, %s, %s, %s, %s)
                    ON CONFLICT (report_id) DO UPDATE SET
                    total_assets = EXCLUDED.total_assets,
                    total_liabilities = EXCLUDED.total_liabilities,
                    total_equity = EXCLUDED.total_equity
                """, (report_id, financial_statements.company_code,
                     financial_statements.report_date,
                     float(financial_statements.balance_sheet.total_assets),
                     float(financial_statements.balance_sheet.total_liabilities),
                     float(financial_statements.balance_sheet.total_equity)))

            # å­˜å‚¨åˆ©æ¶¦è¡¨
            if financial_statements.income_statement:
                cur.execute("""
                    INSERT INTO income_statements
                    (report_id, company_code, period_start, period_end,
                     total_revenue, total_expenses, net_profit)
                    VALUES (%s, %s, %s, %s, %s, %s, %s)
                    ON CONFLICT (report_id) DO UPDATE SET
                    total_revenue = EXCLUDED.total_revenue,
                    total_expenses = EXCLUDED.total_expenses,
                    net_profit = EXCLUDED.net_profit
                """, (report_id, financial_statements.company_code,
                     financial_statements.income_statement.period_start,
                     financial_statements.income_statement.period_end,
                     float(financial_statements.income_statement.total_revenue),
                     float(financial_statements.income_statement.total_expenses),
                     float(financial_statements.income_statement.net_profit)))

            self.conn.commit()

    def generate_financial_analysis(self, company_code: str,
                                   period_start: date, period_end: date) -> List[Dict]:
        """ç”Ÿæˆè´¢åŠ¡åˆ†ææŠ¥å‘Š"""
        with self.conn.cursor() as cur:
            cur.execute("""
                SELECT
                    bs.report_date,
                    bs.total_assets,
                    bs.total_liabilities,
                    bs.total_equity,
                    is_net.net_profit,
                    (bs.total_liabilities / NULLIF(bs.total_equity, 0)) as debt_to_equity_ratio,
                    (is_net.net_profit / NULLIF(bs.total_assets, 0)) as return_on_assets,
                    (is_net.net_profit / NULLIF(bs.total_equity, 0)) as return_on_equity
                FROM balance_sheets bs
                JOIN income_statements is_net ON bs.report_id = is_net.report_id
                WHERE bs.company_code = %s
                AND bs.report_date BETWEEN %s AND %s
                ORDER BY bs.report_date
            """, (company_code, period_start, period_end))

            return cur.fetchall()
```

### 6.5 æ•ˆæœè¯„ä¼°

- æ•°æ®å­˜å‚¨å®Œæ•´æ€§100%
- æŸ¥è¯¢æ€§èƒ½ä¼˜ç§€
- åˆ†æå‡†ç¡®æ€§100%

---

## 7. æ¡ˆä¾‹æ€»ç»“

### 7.1 æˆåŠŸå› ç´ 

1. **IFRSæ ‡å‡†å®æ–½**ï¼šæ­£ç¡®å®æ–½IFRSæ ‡å‡†
2. **è‡ªåŠ¨åŒ–**ï¼šè‡ªåŠ¨åŒ–æŠ¥è¡¨ç”Ÿæˆæµç¨‹
3. **æ•°æ®éªŒè¯**ï¼šç¡®ä¿æ•°æ®å‡†ç¡®æ€§
4. **XBRLæ”¯æŒ**ï¼šæ”¯æŒXBRLæ ¼å¼å¯¼å‡º

### 7.2 æœ€ä½³å®è·µ

1. ä½¿ç”¨IFRS 18æ ‡å‡†
2. è‡ªåŠ¨åŒ–æŠ¥è¡¨ç”Ÿæˆ
3. æ•°æ®éªŒè¯å’Œå¹³è¡¡æ£€æŸ¥
4. æ”¯æŒXBRLå¯¼å‡º
5. è´¢åŠ¡åˆ†æè‡ªåŠ¨åŒ–

---

## 8. å‚è€ƒæ–‡çŒ®

### 8.1 å®˜æ–¹æ–‡æ¡£

- [IFRS 18è´¢åŠ¡æŠ¥è¡¨åˆ—æŠ¥](https://www.ifrs.org/issued-standards/list-of-standards/ifrs-18-presentation-and-disclosure-in-financial-statements/)
- [XBRL 2.1è§„èŒƒ](https://www.xbrl.org/specification/)
- [IFRS Taxonomy](https://www.ifrs.org/xbrl/ifrs-taxonomy/)

### 8.2 æœ€ä½³å®è·µ

- [è´¢åŠ¡æŠ¥è¡¨ç”Ÿæˆæœ€ä½³å®è·µ](https://www.ifrs.org/)
- [XBRLå®æ–½æŒ‡å—](https://www.xbrl.org/)

---

**æ–‡æ¡£åˆ›å»ºæ—¶é—´**ï¼š2025-01-21
**æ–‡æ¡£ç‰ˆæœ¬**ï¼šv2.0
**ç»´æŠ¤è€…**ï¼šDSL Schemaç ”ç©¶å›¢é˜Ÿ
**æœ€åæ›´æ–°**ï¼š2025-01-21
**ä¸‹æ¬¡å®¡æŸ¥æ—¶é—´**ï¼š2025-02-21
