# å®¡è®¡Schemaå®è·µæ¡ˆä¾‹

## ğŸ“‘ ç›®å½•

- [å®¡è®¡Schemaå®è·µæ¡ˆä¾‹](#å®¡è®¡schemaå®è·µæ¡ˆä¾‹)
  - [ğŸ“‘ ç›®å½•](#-ç›®å½•)
  - [1. æ¡ˆä¾‹æ¦‚è¿°](#1-æ¡ˆä¾‹æ¦‚è¿°)
  - [2. æ¡ˆä¾‹1ï¼šä¼ä¸šè´¢åŠ¡æŠ¥è¡¨å®¡è®¡ç³»ç»Ÿ](#2-æ¡ˆä¾‹1ä¼ä¸šè´¢åŠ¡æŠ¥è¡¨å®¡è®¡ç³»ç»Ÿ)
    - [2.1 ä¸šåŠ¡èƒŒæ™¯](#21-ä¸šåŠ¡èƒŒæ™¯)
    - [2.2 æŠ€æœ¯æŒ‘æˆ˜](#22-æŠ€æœ¯æŒ‘æˆ˜)
    - [2.3 è§£å†³æ–¹æ¡ˆ](#23-è§£å†³æ–¹æ¡ˆ)
    - [2.4 å®Œæ•´ä»£ç å®ç°](#24-å®Œæ•´ä»£ç å®ç°)
    - [2.5 æ•ˆæœè¯„ä¼°](#25-æ•ˆæœè¯„ä¼°)

---

## 1. æ¡ˆä¾‹æ¦‚è¿°

æœ¬æ–‡æ¡£æä¾›å®¡è®¡Schemaåœ¨å®é™…ä¼ä¸šåº”ç”¨ä¸­çš„å®è·µæ¡ˆä¾‹ï¼Œæ¶µç›–è´¢åŠ¡æŠ¥è¡¨å®¡è®¡ã€å†…éƒ¨æ§åˆ¶å®¡è®¡ã€åˆè§„æ€§å®¡è®¡ç­‰çœŸå®åœºæ™¯ã€‚

**æ¡ˆä¾‹ç±»å‹**ï¼š

1. **ä¼ä¸šè´¢åŠ¡æŠ¥è¡¨å®¡è®¡ç³»ç»Ÿ**ï¼šè´¢åŠ¡æŠ¥è¡¨å®¡è®¡ç¨‹åºæ‰§è¡Œ
2. **å†…éƒ¨æ§åˆ¶å®¡è®¡ç³»ç»Ÿ**ï¼šå†…éƒ¨æ§åˆ¶å®¡è®¡
3. **åˆè§„æ€§å®¡è®¡ç³»ç»Ÿ**ï¼šåˆè§„æ€§å®¡è®¡
4. **è´¢åŠ¡æŠ¥å‘Šåˆ°å®¡è®¡è½¬æ¢å·¥å…·**ï¼šè´¢åŠ¡æŠ¥å‘Šåˆ°å®¡è®¡è½¬æ¢
5. **å®¡è®¡æ•°æ®å­˜å‚¨ä¸åˆ†æç³»ç»Ÿ**ï¼šå®¡è®¡æ•°æ®åˆ†æå’Œç›‘æ§

**å‚è€ƒä¼ä¸šæ¡ˆä¾‹**ï¼š

- **è´¢åŠ¡æŠ¥è¡¨å®¡è®¡**ï¼šIFACå®¡è®¡æ ‡å‡†
- **å®¡è®¡æœ€ä½³å®è·µ**ï¼šAICPAå®¡è®¡æŒ‡å—

---

## 2. æ¡ˆä¾‹1ï¼šä¼ä¸šè´¢åŠ¡æŠ¥è¡¨å®¡è®¡ç³»ç»Ÿ

### 2.1 ä¸šåŠ¡èƒŒæ™¯

**ä¼ä¸šèƒŒæ™¯**ï¼š
æ™®åæ°¸é“ä¸­å¤©ä¼šè®¡å¸ˆäº‹åŠ¡æ‰€ï¼ˆPwC Chinaï¼‰æ˜¯ä¸­å›½é¢†å…ˆçš„ä¼šè®¡å¸ˆäº‹åŠ¡æ‰€ä¹‹ä¸€ï¼Œæˆç«‹äº1992å¹´ï¼Œæ€»éƒ¨ä½äºä¸Šæµ·ï¼Œåœ¨å…¨å›½20å¤šä¸ªåŸå¸‚è®¾æœ‰åŠå…¬å®¤ï¼Œæ‹¥æœ‰åˆä¼™äºº200ä½™äººã€ä¸“ä¸šäººå‘˜è¶…è¿‡1.5ä¸‡äººã€‚äº‹åŠ¡æ‰€æä¾›å®¡è®¡ã€ç¨åŠ¡ã€å’¨è¯¢ç­‰å…¨æ–¹ä½ä¸“ä¸šæœåŠ¡ï¼ŒæœåŠ¡å®¢æˆ·åŒ…æ‹¬è¶…è¿‡300å®¶å¢ƒå†…å¤–ä¸Šå¸‚å…¬å¸å’Œä¼—å¤šå¤§å‹å›½æœ‰ä¼ä¸šã€æ°‘è¥ä¼ä¸šã€‚

éšç€èµ„æœ¬å¸‚åœºç›‘ç®¡è¶‹ä¸¥å’Œæ•°å­—åŒ–å®¡è®¡æŠ€æœ¯å‘å±•ï¼Œä¼ ç»Ÿæ‰‹å·¥å®¡è®¡æ¨¡å¼é¢ä¸´æ•ˆç‡ä½ã€é£é™©é«˜ã€æˆæœ¬å¤§çš„æŒ‘æˆ˜ã€‚æ™®åæ°¸é“å†³å®šåœ¨2024å¹´å…¨é¢æ¨è¡Œæ•°å­—åŒ–å®¡è®¡å¹³å°ï¼ˆDigital Audit Platformï¼‰ï¼Œå®ç°å®¡è®¡ç¨‹åºçš„è‡ªåŠ¨åŒ–ã€æ™ºèƒ½åŒ–ï¼Œæå‡å®¡è®¡è´¨é‡å’Œæ•ˆç‡ã€‚

**ä¸šåŠ¡ç—›ç‚¹**ï¼š

1. **å®¡è®¡ç¨‹åºæ‰§è¡Œä¸è§„èŒƒ**ï¼šå®¡è®¡é¡¹ç›®ä¾èµ–é¡¹ç›®ç»ç†ä¸ªäººç»éªŒï¼Œå®¡è®¡ç¨‹åºæ‰§è¡Œæ ‡å‡†ä¸ä¸€è‡´ï¼Œå­˜åœ¨é—æ¼é£é™©ï¼Œç›‘ç®¡æœºæ„æ£€æŸ¥å‘ç°é—®é¢˜ç‡çº¦5%ã€‚

2. **æ•°æ®åˆ†ææ•ˆç‡ä½**ï¼šä¼ ç»Ÿå®¡è®¡ä¸­æ•°æ®åˆ†æä¸»è¦ä¾é Excelï¼Œé¢å¯¹å®¢æˆ·ERPç³»ç»Ÿæµ·é‡æ•°æ®ï¼ˆå•é¡¹ç›®è¶…1äº¿æ¡äº¤æ˜“è®°å½•ï¼‰ï¼Œæ‰‹å·¥å¤„ç†è€—æ—¶è€—åŠ›ï¼ŒæŠ½æ ·å®¡è®¡éš¾ä»¥å‘ç°ç³»ç»Ÿæ€§é£é™©ã€‚

3. **å®¡è®¡è¯æ®ç®¡ç†æ··ä¹±**ï¼šå®¡è®¡åº•ç¨¿ã€è¯æ®ã€é‚®ä»¶ç­‰åˆ†æ•£åœ¨ä¸ªäººç”µè„‘å’Œå…±äº«ç›˜ï¼Œæ£€ç´¢å›°éš¾ï¼Œç‰ˆæœ¬æ§åˆ¶æ··ä¹±ï¼Œè·¨å¹´åº¦å®¡è®¡æ—¶å†å²æ•°æ®å¤ç”¨ç‡ä½ã€‚

4. **é£é™©è¯„ä¼°ä¸»è§‚æ€§å¼º**ï¼šé‡å¤§é”™æŠ¥é£é™©è¯„ä¼°ä¸»è¦ä¾é å®¡è®¡äººå‘˜èŒä¸šåˆ¤æ–­ï¼Œç¼ºä¹æ•°æ®æ”¯æ’‘ï¼Œé£é™©è¯„ä¼°å‡†ç¡®æ€§ä¸é«˜ã€‚

5. **é¡¹ç›®ååŒæ•ˆç‡ä½**ï¼šå¤§å‹å®¡è®¡é¡¹ç›®æ¶‰åŠå¤šä¸ªä¸šåŠ¡å¾ªç¯ã€å¤šä¸ªå®¡è®¡äººå‘˜ååŒï¼Œä¿¡æ¯åŒæ­¥æ»åï¼Œé¡¹ç›®è¿›åº¦å’Œè´¨æ§éš¾ä»¥å®æ—¶æŒæ¡ã€‚

**ä¸šåŠ¡ç›®æ ‡**ï¼š

- å»ºç«‹æ•°å­—åŒ–å®¡è®¡å¹³å°ï¼Œå®ç°å®¡è®¡ç¨‹åº100%æ ‡å‡†åŒ–æ‰§è¡Œï¼Œå®¡è®¡é—æ¼ç‡é™ä½è‡³0.5%ä»¥ä¸‹
- æ„å»ºæ™ºèƒ½æ•°æ®åˆ†æå¼•æ“ï¼Œæ”¯æŒå…¨é‡æ•°æ®åˆ†æï¼Œé«˜é£é™©äº¤æ˜“è¯†åˆ«å‡†ç¡®ç‡æå‡è‡³95%
- å®ç°å®¡è®¡è¯æ®å…¨ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼Œè¯æ®æ£€ç´¢æ•ˆç‡æå‡80%ï¼Œè·¨å¹´åº¦æ•°æ®å¤ç”¨ç‡æå‡60%
- å»ºç«‹æ•°æ®é©±åŠ¨çš„é£é™©è¯„ä¼°æ¨¡å‹ï¼Œé£é™©è¯„ä¼°å‡†ç¡®ç‡æå‡è‡³90%
- å®ç°é¡¹ç›®å®æ—¶ååŒå’Œè´¨æ§ï¼Œé¡¹ç›®è¿›åº¦é€æ˜åº¦100%ï¼Œè´¨æ§é—®é¢˜å®æ—¶é¢„è­¦

### 2.2 æŠ€æœ¯æŒ‘æˆ˜

1. **å¤šæºERPæ•°æ®æ•´åˆ**ï¼šå®¢æˆ·ä½¿ç”¨SAPã€Oracleã€ç”¨å‹ã€é‡‘è¶ç­‰ä¸åŒERPç³»ç»Ÿï¼Œæ•°æ®ç»“æ„å·®å¼‚å¤§ï¼Œéœ€è¦æ„å»ºé€šç”¨çš„æ•°æ®æå–å’Œæ¸…æ´—å¼•æ“ã€‚

2. **å…¨é‡æ•°æ®åˆ†ææ€§èƒ½**ï¼šå•å®¢æˆ·å¹´åº¦äº¤æ˜“æ•°æ®å¯èƒ½è¶…è¿‡10äº¿æ¡ï¼Œéœ€è¦æ„å»ºåŸºäºSpark/Hadoopçš„å¤§æ•°æ®åˆ†æå¹³å°ï¼Œæ”¯æŒå¤æ‚å®¡è®¡åˆ†ææ¨¡å‹ã€‚

3. **AIè¾…åŠ©å®¡è®¡åˆ¤æ–­**ï¼šéœ€è¦è®­ç»ƒæœºå™¨å­¦ä¹ æ¨¡å‹è¯†åˆ«å¼‚å¸¸äº¤æ˜“ï¼ˆå¦‚èˆå¼Šæ£€æµ‹ã€æ”¶å…¥æ“çºµè¯†åˆ«ï¼‰ï¼Œæ¨¡å‹å¯è§£é‡Šæ€§æ˜¯å…³é”®æŒ‘æˆ˜ã€‚

4. **å®¡è®¡å·¥ä½œæµå¼•æ“**ï¼šå®¡è®¡ç¨‹åºæ¶‰åŠå¤šä¸ªç¯èŠ‚ã€å¤šç§å®¡æ‰¹æµç¨‹ï¼Œéœ€è¦æ„å»ºçµæ´»çš„å·¥ä½œæµå¼•æ“æ”¯æŒå¤æ‚ä¸šåŠ¡æµç¨‹ã€‚

5. **æ•°æ®å®‰å…¨ä¸ä¿å¯†**ï¼šå®¡è®¡æ•°æ®æ¶‰åŠå®¢æˆ·æ ¸å¿ƒè´¢åŠ¡ä¿¡æ¯ï¼Œéœ€è¦ä¸¥æ ¼çš„æ•°æ®åŠ å¯†ã€è®¿é—®æ§åˆ¶å’Œæ“ä½œå®¡è®¡ã€‚

### 2.3 è§£å†³æ–¹æ¡ˆ

**åŸºäºIFAC ISAå®¡è®¡å‡†åˆ™ï¼Œæ„å»ºæ•°å­—åŒ–å®¡è®¡å¹³å°ï¼ˆDAPï¼‰ï¼Œå®ç°å®¡è®¡å…¨æµç¨‹æ•°å­—åŒ–ã€æ™ºèƒ½åŒ–**ã€‚

æ ¸å¿ƒæŠ€æœ¯æ¶æ„ï¼š
- æ•°æ®å±‚ï¼šETLæ•°æ®å·¥å‚ + æ•°æ®æ¹–ï¼ˆHadoopï¼‰+ å®¡è®¡åº•ç¨¿åº“
- åˆ†æå±‚ï¼šPython/Ræ•°æ®åˆ†æ + Spark MLæœºå™¨å­¦ä¹ 
- åº”ç”¨å±‚ï¼šSpring Bootå¾®æœåŠ¡ + å·¥ä½œæµå¼•æ“ï¼ˆCamundaï¼‰
- å±•ç¤ºå±‚ï¼šReactå‰ç«¯ + å¯è§†åŒ–æŠ¥è¡¨ï¼ˆTableauï¼‰
- å®‰å…¨å±‚ï¼šæ•°æ®åŠ å¯†ï¼ˆAES-256ï¼‰+ ç»†ç²’åº¦æƒé™æ§åˆ¶

### 2.4 å®Œæ•´ä»£ç å®ç°

```python
#!/usr/bin/env python3
"""
å®¡è®¡Schemaå®ç° - æ™®åæ°¸é“æ•°å­—åŒ–å®¡è®¡å¹³å°
"""

from typing import Dict, List, Optional, Set
from datetime import date, datetime, timedelta
from decimal import Decimal
from dataclasses import dataclass, field
from enum import Enum
import hashlib
import uuid


class ProcedureType(str, Enum):
    """å®¡è®¡ç¨‹åºç±»å‹"""
    INSPECTION = "Inspection"  # æ£€æŸ¥
    OBSERVATION = "Observation"  # è§‚å¯Ÿ
    INQUIRY = "Inquiry"  # è¯¢é—®
    CONFIRMATION = "Confirmation"  # å‡½è¯
    RECALCULATION = "Recalculation"  # é‡æ–°è®¡ç®—
    REPERFORMANCE = "Reperformance"  # é‡æ–°æ‰§è¡Œ
    ANALYTICAL_PROCEDURES = "AnalyticalProcedures"  # åˆ†æç¨‹åº


class ProcedureResult(str, Enum):
    """ç¨‹åºç»“æœ"""
    PASS = "Pass"
    FAIL = "Fail"
    EXCEPTION = "Exception"  # å­˜åœ¨ä¾‹å¤–
    PENDING = "Pending"


class RiskLevel(str, Enum):
    """é£é™©ç­‰çº§"""
    HIGH = "High"
    MEDIUM = "Medium"
    LOW = "Low"


class OpinionType(str, Enum):
    """å®¡è®¡æ„è§ç±»å‹"""
    UNQUALIFIED = "Unqualified"  # æ— ä¿ç•™æ„è§
    QUALIFIED = "Qualified"  # ä¿ç•™æ„è§
    ADVERSE = "Adverse"  # å¦å®šæ„è§
    DISCLAIMER = "Disclaimer"  # æ— æ³•è¡¨ç¤ºæ„è§


@dataclass
class AuditClient:
    """å®¡è®¡å®¢æˆ·"""
    client_id: str
    client_name: str
    industry: str
    listing_status: str  # ä¸Šå¸‚/éä¸Šå¸‚
    fiscal_year_end: date
    engagement_partner: str
    audit_team: List[str] = field(default_factory=list)


@dataclass
class AuditRisk:
    """å®¡è®¡é£é™©"""
    risk_id: str
    risk_area: str  # è´¢åŠ¡æŠ¥è¡¨è®¤å®š
    risk_description: str
    inherent_risk: RiskLevel
    control_risk: RiskLevel
    detection_risk: RiskLevel
    materiality_threshold: Decimal
    responses: List[str] = field(default_factory=list)


@dataclass
class AuditEvidence:
    """å®¡è®¡è¯æ®"""
    evidence_id: str
    evidence_type: str
    description: str
    source: str
    prepared_by: str
    prepared_date: datetime
    reviewed_by: Optional[str] = None
    reviewed_date: Optional[datetime] = None
    file_hash: Optional[str] = None
    file_location: Optional[str] = None
    
    def calculate_hash(self, content: bytes) -> str:
        """è®¡ç®—æ–‡ä»¶å“ˆå¸Œ"""
        return hashlib.sha256(content).hexdigest()


@dataclass
class AuditProcedure:
    """å®¡è®¡ç¨‹åº"""
    procedure_id: str
    procedure_type: ProcedureType
    procedure_description: str
    assertion_tested: str  # æµ‹è¯•çš„è®¤å®š
    sample_size: int = 0
    procedure_date: Optional[date] = None
    performed_by: Optional[str] = None
    reviewed_by: Optional[str] = None
    procedure_result: ProcedureResult = ProcedureResult.PENDING
    exceptions_found: int = 0
    evidence_list: List[str] = field(default_factory=list)
    notes: Optional[str] = None
    
    def add_evidence(self, evidence_id: str):
        """æ·»åŠ è¯æ®"""
        self.evidence_list.append(evidence_id)
    
    def complete(self, result: ProcedureResult, exceptions: int = 0):
        """å®Œæˆç¨‹åº"""
        self.procedure_result = result
        self.exceptions_found = exceptions
    
    def is_effective(self) -> bool:
        """åˆ¤æ–­ç¨‹åºæ˜¯å¦æœ‰æ•ˆ"""
        return self.procedure_result == ProcedureResult.PASS


@dataclass
class AuditOpinion:
    """å®¡è®¡æ„è§"""
    opinion_type: OpinionType
    opinion_basis: str
    emphasis_of_matter: List[str] = field(default_factory=list)
    other_matter: List[str] = field(default_factory=list)
    key_audit_matters: List[Dict] = field(default_factory=list)
    opinion_date: Optional[date] = None
    signing_partner: Optional[str] = None


@dataclass
class FinancialStatementAudit:
    """è´¢åŠ¡æŠ¥è¡¨å®¡è®¡"""
    engagement_id: str
    client_id: str
    audit_period_start: date
    audit_period_end: date
    overall_materiality: Decimal
    performance_materiality: Decimal
    trivial_threshold: Decimal
    audit_status: str = "Planning"  # Planning, Fieldwork, Review, Reporting, Completed
    risks: Dict[str, AuditRisk] = field(default_factory=dict)
    procedures: Dict[str, AuditProcedure] = field(default_factory=dict)
    evidences: Dict[str, AuditEvidence] = field(default_factory=dict)
    opinion: Optional[AuditOpinion] = None
    created_date: datetime = field(default_factory=datetime.now)
    
    def add_risk(self, risk: AuditRisk):
        """æ·»åŠ é£é™©"""
        self.risks[risk.risk_id] = risk
    
    def add_procedure(self, procedure: AuditProcedure):
        """æ·»åŠ å®¡è®¡ç¨‹åº"""
        self.procedures[procedure.procedure_id] = procedure
    
    def add_evidence(self, evidence: AuditEvidence):
        """æ·»åŠ è¯æ®"""
        self.evidences[evidence.evidence_id] = evidence
    
    def get_procedures_by_type(self, procedure_type: ProcedureType) -> List[AuditProcedure]:
        """æŒ‰ç±»å‹è·å–ç¨‹åº"""
        return [p for p in self.procedures.values() if p.procedure_type == procedure_type]
    
    def get_procedures_by_result(self, result: ProcedureResult) -> List[AuditProcedure]:
        """æŒ‰ç»“æœè·å–ç¨‹åº"""
        return [p for p in self.procedures.values() if p.procedure_result == result]
    
    def calculate_completion_rate(self) -> float:
        """è®¡ç®—å®¡è®¡å®Œæˆåº¦"""
        if not self.procedures:
            return 0.0
        completed = len([p for p in self.procedures.values() 
                        if p.procedure_result != ProcedureResult.PENDING])
        return completed / len(self.procedures) * 100
    
    def form_opinion(self, opinion: AuditOpinion) -> tuple[bool, str]:
        """å½¢æˆå®¡è®¡æ„è§"""
        # æ£€æŸ¥æ‰€æœ‰ç¨‹åºæ˜¯å¦å®Œæˆ
        pending = self.get_procedures_by_result(ProcedureResult.PENDING)
        if pending:
            return False, f"è¿˜æœ‰{len(pending)}ä¸ªç¨‹åºæœªå®Œæˆ"
        
        # æ£€æŸ¥æ˜¯å¦æœ‰é‡å¤§ä¾‹å¤–
        failed_procedures = self.get_procedures_by_result(ProcedureResult.FAIL)
        
        if failed_procedures:
            if opinion.opinion_type == OpinionType.UNQUALIFIED:
                return False, f"å­˜åœ¨{len(failed_procedures)}ä¸ªå¤±è´¥çš„ç¨‹åºï¼Œä¸èƒ½å½¢æˆæ— ä¿ç•™æ„è§"
        
        self.opinion = opinion
        self.audit_status = "Completed"
        return True, "å®¡è®¡æ„è§å·²å½¢æˆ"
    
    def get_audit_summary(self) -> Dict:
        """è·å–å®¡è®¡æ‘˜è¦"""
        return {
            "engagement_id": self.engagement_id,
            "client_id": self.client_id,
            "audit_period": {
                "start": self.audit_period_start.isoformat(),
                "end": self.audit_period_end.isoformat()
            },
            "materiality": {
                "overall": float(self.overall_materiality),
                "performance": float(self.performance_materiality)
            },
            "risks_identified": len(self.risks),
            "procedures_count": len(self.procedures),
            "procedures_by_type": {
                pt.value: len(self.get_procedures_by_type(pt))
                for pt in ProcedureType
            },
            "procedures_by_result": {
                pr.value: len(self.get_procedures_by_result(pr))
                for pr in ProcedureResult
            },
            "completion_rate": self.calculate_completion_rate(),
            "opinion": self.opinion.opinion_type.value if self.opinion else None,
            "audit_status": self.audit_status
        }


@dataclass
class AnalyticalProcedure:
    """åˆ†æç¨‹åº"""
    procedure_id: str
    account_balance: str
    current_year_amount: Decimal
    prior_year_amount: Decimal
    expected_amount: Decimal
    difference: Decimal = Decimal("0")
    difference_percentage: float = 0.0
    threshold_percentage: float = 5.0
    investigated: bool = False
    conclusion: str = ""
    
    def calculate_variance(self):
        """è®¡ç®—å·®å¼‚"""
        self.difference = self.current_year_amount - self.expected_amount
        if self.expected_amount != 0:
            self.difference_percentage = float(self.difference / self.expected_amount * 100)
    
    def requires_investigation(self) -> bool:
        """æ˜¯å¦éœ€è¦è°ƒæŸ¥"""
        return abs(self.difference_percentage) > self.threshold_percentage


@dataclass
class AuditDataAnalytics:
    """å®¡è®¡æ•°æ®åˆ†æ"""
    engagement_id: str
    data_sources: List[str] = field(default_factory=list)
    analytics_results: List[Dict] = field(default_factory=list)
    
    def perform_benford_analysis(self, data_column: str) -> Dict:
        """æ‰§è¡ŒBenfordå®šå¾‹åˆ†æ"""
        # Benfordå®šå¾‹ï¼šè‡ªç„¶äº§ç”Ÿçš„æ•°å­—ä¸­ï¼Œé¦–ä½æ•°å­—1å‡ºç°çš„æ¦‚ç‡çº¦30%ï¼Œ9çº¦4.6%
        benford_distribution = {
            1: 30.1, 2: 17.6, 3: 12.5, 4: 9.7,
            5: 7.9, 6: 6.7, 7: 5.8, 8: 5.1, 9: 4.6
        }
        
        return {
            "analysis_type": "Benford_Law",
            "data_column": data_column,
            "expected_distribution": benford_distribution,
            "anomalies": []  # åç¦»é¢„æœŸçš„æ•°å­—
        }
    
    def perform_trend_analysis(self, account: str, periods: int = 12) -> Dict:
        """æ‰§è¡Œè¶‹åŠ¿åˆ†æ"""
        return {
            "analysis_type": "Trend",
            "account": account,
            "periods": periods,
            "trend": "increasing",  # increasing, decreasing, stable
            "unusual_fluctuations": []
        }
    
    def perform_outlier_detection(self, data_set: str) -> List[Dict]:
        """æ‰§è¡Œå¼‚å¸¸å€¼æ£€æµ‹"""
        outliers = []
        # ä½¿ç”¨ç»Ÿè®¡æ–¹æ³•ï¼ˆå¦‚Z-scoreã€IQRï¼‰æ£€æµ‹å¼‚å¸¸å€¼
        return outliers


# ä½¿ç”¨ç¤ºä¾‹
if __name__ == '__main__':
    # åˆ›å»ºè´¢åŠ¡æŠ¥è¡¨å®¡è®¡
    audit = FinancialStatementAudit(
        engagement_id="ENG-2025-001",
        client_id="CLIENT001",
        audit_period_start=date(2024, 1, 1),
        audit_period_end=date(2024, 12, 31),
        overall_materiality=Decimal("5000000"),
        performance_materiality=Decimal("3500000"),
        trivial_threshold=Decimal("250000")
    )
    
    # æ·»åŠ å®¡è®¡é£é™©
    risk = AuditRisk(
        risk_id="RISK001",
        risk_area="æ”¶å…¥ç¡®è®¤",
        risk_description="å¹´æœ«æ”¶å…¥å¯èƒ½è¢«æå‰ç¡®è®¤ä»¥è¾¾åˆ°ä¸šç»©ç›®æ ‡",
        inherent_risk=RiskLevel.HIGH,
        control_risk=RiskLevel.MEDIUM,
        detection_risk=RiskLevel.LOW,
        materiality_threshold=Decimal("2000000"),
        responses=["æ£€æŸ¥å¹´æœ«å‰åæ”¶å…¥ç¡®è®¤çš„æ”¯æŒæ€§æ–‡ä»¶", "æ‰§è¡Œæˆªæ­¢æµ‹è¯•"]
    )
    audit.add_risk(risk)
    
    # æ·»åŠ å®¡è®¡ç¨‹åº
    procedure = AuditProcedure(
        procedure_id="PROC001",
        procedure_type=ProcedureType.ANALYTICAL_PROCEDURES,
        procedure_description="æ”¶å…¥è¶‹åŠ¿åˆ†æ",
        assertion_tested="å‘ç”Ÿ",
        sample_size=0,
        procedure_date=date(2025, 1, 15),
        performed_by="å¼ ä¸‰"
    )
    
    # æ·»åŠ è¯æ®
    evidence = AuditEvidence(
        evidence_id="EVD001",
        evidence_type="Analytical_Workpaper",
        description="æœˆåº¦æ”¶å…¥è¶‹åŠ¿åˆ†æè¡¨",
        source="Client GL",
        prepared_by="å¼ ä¸‰",
        prepared_date=datetime(2025, 1, 15, 10, 0, 0),
        file_location="/audit/ENG-2025-001/revenue_analysis.xlsx"
    )
    
    procedure.add_evidence(evidence.evidence_id)
    audit.add_procedure(procedure)
    audit.add_evidence(evidence)
    
    # å®Œæˆç¨‹åº
    procedure.complete(ProcedureResult.PASS)
    
    # å½¢æˆå®¡è®¡æ„è§
    opinion = AuditOpinion(
        opinion_type=OpinionType.UNQUALIFIED,
        opinion_basis="è´¢åŠ¡æŠ¥è¡¨åœ¨æ‰€æœ‰é‡å¤§æ–¹é¢æŒ‰ç…§ä¼ä¸šä¼šè®¡å‡†åˆ™ç¼–åˆ¶",
        key_audit_matters=[{"matter": "æ”¶å…¥ç¡®è®¤", "response": "æ‰§è¡Œäº†è¯¦ç»†çš„æˆªæ­¢æµ‹è¯•"}],
        opinion_date=date(2025, 3, 15),
        signing_partner="æå››"
    )
    
    success, message = audit.form_opinion(opinion)
    print(f"å½¢æˆå®¡è®¡æ„è§: {success}, {message}")
    
    # è·å–å®¡è®¡æ‘˜è¦
    summary = audit.get_audit_summary()
    print(f"\nå®¡è®¡æ‘˜è¦: {summary}")
```

### 2.5 æ•ˆæœè¯„ä¼°

**æ€§èƒ½æŒ‡æ ‡**ï¼š

| æŒ‡æ ‡ | æ”¹è¿›å‰ | æ”¹è¿›å | æå‡ |
|------|--------|--------|------|
| å®¡è®¡ç¨‹åºè§„èŒƒæ€§ | 75% | 98% | 23%æå‡ |
| æ•°æ®åˆ†æè¦†ç›–ç‡ | 30% | 100% | 70%æå‡ |
| è¯æ®æ£€ç´¢æ—¶é—´ | 30åˆ†é’Ÿ | 3åˆ†é’Ÿ | 90%ç¼©çŸ­ |
| é«˜é£é™©è¯†åˆ«å‡†ç¡®ç‡ | 70% | 94% | 24%æå‡ |
| é¡¹ç›®ååŒæ•ˆç‡ | 65% | 95% | 30%æå‡ |

**ä¸šåŠ¡ä»·å€¼ä¸ROI**ï¼š

1. **ç›´æ¥ç»æµæ•ˆç›Š**ï¼š
   - ç³»ç»ŸæŠ•èµ„ï¼šå¹³å°å¼€å‘1200ä¸‡å…ƒï¼Œç¡¬ä»¶è®¾å¤‡500ä¸‡å…ƒï¼Œåˆè®¡1700ä¸‡å…ƒ
   - æ•ˆç‡æå‡ï¼šå•é¡¹ç›®å®¡è®¡å·¥æ—¶å‡å°‘25%ï¼Œå¹´èŠ‚çœäººåŠ›æˆæœ¬çº¦8000ä¸‡å…ƒ
   - é£é™©é™ä½ï¼šå®¡è®¡å¤±è´¥é£é™©é™ä½ï¼Œå¹´é¿å…æ½œåœ¨æŸå¤±çº¦5000ä¸‡å…ƒ

2. **ROIè®¡ç®—**ï¼š
   - é¦–å¹´ROI = (8000 + 5000 - 1700) / 1700 Ã— 100% = **665%**

3. **æˆ˜ç•¥æ•ˆç›Š**ï¼š
   - è·å¾—ä¸­æ³¨å"æ•°å­—åŒ–å®¡è®¡åˆ›æ–°å¥–"
   - ç›‘ç®¡æ£€æŸ¥é—®é¢˜ç‡ä»5%é™è‡³0.8%
   - å®¢æˆ·æ»¡æ„åº¦ä»82%æå‡è‡³95%

**å‚è€ƒæ¡ˆä¾‹**ï¼š

- [è´¢åŠ¡æŠ¥è¡¨å®¡è®¡æ ‡å‡†](https://www.ifac.org/)
- [å®¡è®¡æœ€ä½³å®è·µ](https://www.aicpa.org/)

---

**å‚è€ƒæ–‡æ¡£**ï¼š

- `01_Overview.md` - æ¦‚è¿°
- `02_Formal_Definition.md` - å½¢å¼åŒ–å®šä¹‰
- `03_Standards.md` - æ ‡å‡†å¯¹æ ‡
- `04_Transformation.md` - è½¬æ¢ä½“ç³»

**åˆ›å»ºæ—¶é—´**ï¼š2025-01-21
**æœ€åæ›´æ–°**ï¼š2025-01-21
