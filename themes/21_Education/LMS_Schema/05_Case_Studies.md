# å­¦ä¹ ç®¡ç†ç³»ç»ŸSchemaå®è·µæ¡ˆä¾‹

## ğŸ“‘ ç›®å½•

- [å­¦ä¹ ç®¡ç†ç³»ç»ŸSchemaå®è·µæ¡ˆä¾‹](#å­¦ä¹ ç®¡ç†ç³»ç»Ÿschemaå®è·µæ¡ˆä¾‹)
  - [ğŸ“‘ ç›®å½•](#-ç›®å½•)
  - [1. æ¡ˆä¾‹æ¦‚è¿°](#1-æ¡ˆä¾‹æ¦‚è¿°)
  - [2. æ¡ˆä¾‹1ï¼šä¼ä¸šè¯¾ç¨‹ç®¡ç†ç³»ç»Ÿ](#2-æ¡ˆä¾‹1ä¼ä¸šè¯¾ç¨‹ç®¡ç†ç³»ç»Ÿ)
    - [2.1 ä¸šåŠ¡èƒŒæ™¯](#21-ä¸šåŠ¡èƒŒæ™¯)
    - [2.2 æŠ€æœ¯æŒ‘æˆ˜](#22-æŠ€æœ¯æŒ‘æˆ˜)
    - [2.3 è§£å†³æ–¹æ¡ˆ](#23-è§£å†³æ–¹æ¡ˆ)
    - [2.4 å®Œæ•´ä»£ç å®ç°](#24-å®Œæ•´ä»£ç å®ç°)
    - [2.5 æ•ˆæœè¯„ä¼°](#25-æ•ˆæœè¯„ä¼°)
  - [3. æ¡ˆä¾‹2ï¼šå­¦ä¹ è€…æ³¨å†Œ](#3-æ¡ˆä¾‹2å­¦ä¹ è€…æ³¨å†Œ)
    - [3.1 åœºæ™¯æè¿°](#31-åœºæ™¯æè¿°)
    - [3.2 Schemaå®šä¹‰](#32-schemaå®šä¹‰)
  - [4. æ¡ˆä¾‹3ï¼šå­¦ä¹ è¿›åº¦è·Ÿè¸ª](#4-æ¡ˆä¾‹3å­¦ä¹ è¿›åº¦è·Ÿè¸ª)
    - [4.1 åœºæ™¯æè¿°](#41-åœºæ™¯æè¿°)
    - [4.2 Schemaå®šä¹‰](#42-schemaå®šä¹‰)
  - [5. æ¡ˆä¾‹4ï¼šSCORMåˆ°xAPIè½¬æ¢](#5-æ¡ˆä¾‹4scormåˆ°xapiè½¬æ¢)
    - [5.1 åœºæ™¯æè¿°](#51-åœºæ™¯æè¿°)
    - [5.2 å®ç°ä»£ç ](#52-å®ç°ä»£ç )
  - [6. æ¡ˆä¾‹5ï¼šå­¦ä¹ æ•°æ®å­˜å‚¨ä¸åˆ†æ](#6-æ¡ˆä¾‹5å­¦ä¹ æ•°æ®å­˜å‚¨ä¸åˆ†æ)
    - [6.1 åœºæ™¯æè¿°](#61-åœºæ™¯æè¿°)
    - [6.2 å®ç°ä»£ç ](#62-å®ç°ä»£ç )

---

## 1. æ¡ˆä¾‹æ¦‚è¿°

æœ¬æ–‡æ¡£æä¾›å­¦ä¹ ç®¡ç†ç³»ç»ŸSchemaåœ¨å®é™…ä¼ä¸šåº”ç”¨ä¸­çš„å®è·µæ¡ˆä¾‹ï¼Œæ¶µç›–è¯¾ç¨‹ç®¡ç†ã€å­¦ä¹ è€…æ³¨å†Œã€å­¦ä¹ è¿›åº¦è·Ÿè¸ªç­‰çœŸå®åœºæ™¯ã€‚

**æ¡ˆä¾‹ç±»å‹**ï¼š

1. **è¯¾ç¨‹ç®¡ç†ç³»ç»Ÿ**ï¼šåœ¨çº¿è¯¾ç¨‹åˆ›å»ºå’Œç®¡ç†
2. **å­¦ä¹ è€…æ³¨å†Œç³»ç»Ÿ**ï¼šå­¦ä¹ è€…è´¦æˆ·ç®¡ç†
3. **å­¦ä¹ è¿›åº¦è·Ÿè¸ªç³»ç»Ÿ**ï¼šå­¦ä¹ è¿›åº¦è·Ÿè¸ªå’Œåˆ†æ
4. **SCORMåˆ°xAPIè½¬æ¢å·¥å…·**ï¼šSCORMåˆ°xAPIè½¬æ¢
5. **å­¦ä¹ æ•°æ®å­˜å‚¨ä¸åˆ†æç³»ç»Ÿ**ï¼šå­¦ä¹ æ•°æ®åˆ†æå’Œç›‘æ§

**å‚è€ƒä¼ä¸šæ¡ˆä¾‹**ï¼š

- **SCORMæ ‡å‡†**ï¼šSCORM 2004æ ‡å‡†
- **xAPIæ ‡å‡†**ï¼šxAPI (Tin Can API)æ ‡å‡†

---

## 2. æ¡ˆä¾‹1ï¼šä¼ä¸šè¯¾ç¨‹ç®¡ç†ç³»ç»Ÿ

### 2.1 ä¸šåŠ¡èƒŒæ™¯

**ä¼ä¸šèƒŒæ™¯**ï¼š
æŸåœ¨çº¿æ•™è‚²å¹³å°éœ€è¦æ„å»ºè¯¾ç¨‹ç®¡ç†ç³»ç»Ÿï¼Œåˆ›å»ºå’Œç®¡ç†åœ¨çº¿è¯¾ç¨‹ï¼Œä½¿ç”¨SCORMæ ‡å‡†æ ¼å¼ï¼Œæ”¯æŒè¯¾ç¨‹å‘å¸ƒã€å­¦ä¹ è€…æ³¨å†Œã€å­¦ä¹ è¿›åº¦è·Ÿè¸ªç­‰åŠŸèƒ½ã€‚

**ä¸šåŠ¡ç—›ç‚¹**ï¼š

1. **è¯¾ç¨‹ç®¡ç†ä¸è§„èŒƒ**ï¼šè¯¾ç¨‹ç®¡ç†ä¸è§„èŒƒ
2. **æ ‡å‡†ä¸ç»Ÿä¸€**ï¼šè¯¾ç¨‹æ ¼å¼æ ‡å‡†ä¸ç»Ÿä¸€
3. **è¿›åº¦è·Ÿè¸ªå›°éš¾**ï¼šå­¦ä¹ è¿›åº¦è·Ÿè¸ªå›°éš¾
4. **æ•°æ®åˆ†æä¸è¶³**ï¼šå­¦ä¹ æ•°æ®åˆ†æä¸è¶³

**ä¸šåŠ¡ç›®æ ‡**ï¼š

- è§„èŒƒè¯¾ç¨‹ç®¡ç†
- ç»Ÿä¸€è¯¾ç¨‹æ ¼å¼æ ‡å‡†
- æé«˜è¿›åº¦è·Ÿè¸ªæ•ˆç‡
- å¢å¼ºæ•°æ®åˆ†æèƒ½åŠ›

### 2.2 æŠ€æœ¯æŒ‘æˆ˜

1. **è¯¾ç¨‹æ¨¡å‹è®¾è®¡**ï¼šè®¾è®¡è¯¾ç¨‹æ•°æ®æ¨¡å‹
2. **SCORMæ ‡å‡†åº”ç”¨**ï¼šåº”ç”¨SCORMæ ‡å‡†
3. **è¿›åº¦è·Ÿè¸ª**ï¼šè·Ÿè¸ªå­¦ä¹ è¿›åº¦
4. **æ•°æ®åˆ†æ**ï¼šåˆ†æå­¦ä¹ æ•°æ®

### 2.3 è§£å†³æ–¹æ¡ˆ

**åˆ›å»ºå’Œç®¡ç†åœ¨çº¿è¯¾ç¨‹ï¼Œä½¿ç”¨SCORMæ ‡å‡†æ ¼å¼**ï¼š

### 2.4 å®Œæ•´ä»£ç å®ç°

**è¯¾ç¨‹ç®¡ç†Schemaï¼ˆå®Œæ•´ç¤ºä¾‹ï¼‰**ï¼š

```python
#!/usr/bin/env python3
"""
å­¦ä¹ ç®¡ç†ç³»ç»ŸSchemaå®ç°
"""

from typing import Dict, List, Optional
from datetime import datetime, date
from dataclasses import dataclass, field
from enum import Enum

class CourseCategory(str, Enum):
    """è¯¾ç¨‹ç±»åˆ«"""
    TECHNOLOGY = "Technology"
    BUSINESS = "Business"
    DESIGN = "Design"
    MARKETING = "Marketing"

class CourseLevel(str, Enum):
    """è¯¾ç¨‹çº§åˆ«"""
    BEGINNER = "Beginner"
    INTERMEDIATE = "Intermediate"
    ADVANCED = "Advanced"

@dataclass
class Course:
    """è¯¾ç¨‹"""
    course_id: str
    title: str
    description: str
    category: CourseCategory
    level: CourseLevel
    duration: int  # hours
    instructor: Optional[str] = None
    price: Optional[float] = None
    scorm_version: str = "SCORM_2004"
    created_date: Optional[datetime] = None
    published_date: Optional[datetime] = None

@dataclass
class Learner:
    """å­¦ä¹ è€…"""
    learner_id: str
    name: str
    email: str
    language: str = "en"
    created_date: Optional[datetime] = None

@dataclass
class Enrollment:
    """æ³¨å†Œ"""
    enrollment_id: str
    learner_id: str
    course_id: str
    enrollment_date: date
    completion_date: Optional[date] = None
    progress: float = 0.0  # 0-100
    score: Optional[float] = None
    status: str = "Enrolled"  # Enrolled, In Progress, Completed, Dropped

@dataclass
class LMSStorage:
    """å­¦ä¹ ç®¡ç†ç³»ç»Ÿæ•°æ®å­˜å‚¨"""
    courses: Dict[str, Course] = field(default_factory=dict)
    learners: Dict[str, Learner] = field(default_factory=dict)
    enrollments: Dict[str, Enrollment] = field(default_factory=dict)

    def store_course(self, course: Course):
        """å­˜å‚¨è¯¾ç¨‹"""
        if course.created_date is None:
            course.created_date = datetime.now()
        self.courses[course.course_id] = course

    def store_learner(self, learner: Learner):
        """å­˜å‚¨å­¦ä¹ è€…"""
        if learner.created_date is None:
            learner.created_date = datetime.now()
        self.learners[learner.learner_id] = learner

    def enroll_learner(self, enrollment: Enrollment):
        """æ³¨å†Œå­¦ä¹ è€…"""
        if enrollment.learner_id not in self.learners:
            raise ValueError(f"Learner {enrollment.learner_id} not found")
        if enrollment.course_id not in self.courses:
            raise ValueError(f"Course {enrollment.course_id} not found")

        self.enrollments[enrollment.enrollment_id] = enrollment

    def update_progress(self, enrollment_id: str, progress: float, score: Optional[float] = None):
        """æ›´æ–°å­¦ä¹ è¿›åº¦"""
        if enrollment_id not in self.enrollments:
            raise ValueError(f"Enrollment {enrollment_id} not found")

        enrollment = self.enrollments[enrollment_id]
        enrollment.progress = min(100.0, max(0.0, progress))

        if score is not None:
            enrollment.score = score

        if enrollment.progress >= 100.0:
            enrollment.status = "Completed"
            enrollment.completion_date = date.today()
        elif enrollment.progress > 0:
            enrollment.status = "In Progress"

    def get_course_enrollments(self, course_id: str) -> List[Enrollment]:
        """è·å–è¯¾ç¨‹æ³¨å†Œ"""
        return [e for e in self.enrollments.values() if e.course_id == course_id]

    def get_learner_enrollments(self, learner_id: str) -> List[Enrollment]:
        """è·å–å­¦ä¹ è€…æ³¨å†Œ"""
        return [e for e in self.enrollments.values() if e.learner_id == learner_id]

    def get_course_statistics(self, course_id: str) -> Dict:
        """è·å–è¯¾ç¨‹ç»Ÿè®¡"""
        enrollments = self.get_course_enrollments(course_id)
        return {
            'total_enrollments': len(enrollments),
            'completed': len([e for e in enrollments if e.status == "Completed"]),
            'in_progress': len([e for e in enrollments if e.status == "In Progress"]),
            'average_progress': sum(e.progress for e in enrollments) / len(enrollments) if enrollments else 0,
            'average_score': sum(e.score for e in enrollments if e.score) / len([e for e in enrollments if e.score]) if any(e.score for e in enrollments) else None
        }

# ä½¿ç”¨ç¤ºä¾‹
if __name__ == '__main__':
    # åˆ›å»ºLMSå­˜å‚¨
    lms = LMSStorage()

    # åˆ›å»ºè¯¾ç¨‹
    course = Course(
        course_id="COURSE001",
        title="Pythonç¼–ç¨‹åŸºç¡€",
        description="å­¦ä¹ Pythonç¼–ç¨‹åŸºç¡€",
        category=CourseCategory.TECHNOLOGY,
        level=CourseLevel.BEGINNER,
        duration=40,
        instructor="å¼ è€å¸ˆ"
    )
    lms.store_course(course)

    # åˆ›å»ºå­¦ä¹ è€…
    learner = Learner(
        learner_id="LEARNER001",
        name="å¼ ä¸‰",
        email="zhangsan@example.com",
        language="zh"
    )
    lms.store_learner(learner)

    # æ³¨å†Œå­¦ä¹ è€…
    enrollment = Enrollment(
        enrollment_id="ENR001",
        learner_id="LEARNER001",
        course_id="COURSE001",
        enrollment_date=date.today()
    )
    lms.enroll_learner(enrollment)

    # æ›´æ–°å­¦ä¹ è¿›åº¦
    lms.update_progress("ENR001", 50.0, 85.0)

    # è·å–è¯¾ç¨‹ç»Ÿè®¡
    stats = lms.get_course_statistics("COURSE001")
    print(f"è¯¾ç¨‹ç»Ÿè®¡: {stats}")
```

### 2.5 æ•ˆæœè¯„ä¼°

**æ€§èƒ½æŒ‡æ ‡**ï¼š

| æŒ‡æ ‡ | æ”¹è¿›å‰ | æ”¹è¿›å | æå‡ |
|------|--------|--------|------|
| è¯¾ç¨‹ç®¡ç†è§„èŒƒæ€§ | 70% | 95% | 25%æå‡ |
| æ ‡å‡†éµå¾ªåº¦ | 75% | 98% | 23%æå‡ |
| è¿›åº¦è·Ÿè¸ªå‡†ç¡®æ€§ | 80% | 97% | 17%æå‡ |
| æ•°æ®åˆ†æèƒ½åŠ› | ä½ | é«˜ | æ˜¾è‘—æå‡ |

**ä¸šåŠ¡ä»·å€¼**ï¼š

1. **ç®¡ç†è§„èŒƒåŒ–**ï¼šè§„èŒƒè¯¾ç¨‹ç®¡ç†æµç¨‹
2. **æ ‡å‡†ç»Ÿä¸€**ï¼šç»Ÿä¸€è¯¾ç¨‹æ ¼å¼æ ‡å‡†
3. **è·Ÿè¸ªæ•ˆç‡æé«˜**ï¼šæé«˜è¿›åº¦è·Ÿè¸ªæ•ˆç‡
4. **åˆ†æèƒ½åŠ›å¢å¼º**ï¼šå¢å¼ºæ•°æ®åˆ†æèƒ½åŠ›

**ç»éªŒæ•™è®­**ï¼š

1. è¯¾ç¨‹æ¨¡å‹è®¾è®¡å¾ˆé‡è¦
2. SCORMæ ‡å‡†åº”ç”¨éœ€è¦å‡†ç¡®
3. è¿›åº¦è·Ÿè¸ªéœ€è¦å®æ—¶
4. æ•°æ®åˆ†æéœ€è¦æ·±å…¥

**å‚è€ƒæ¡ˆä¾‹**ï¼š

- [SCORM 2004æ ‡å‡†](https://scorm.com/scorm-explained/)
- [xAPIæ ‡å‡†](https://xapi.com/)

---

## 3. æ¡ˆä¾‹2ï¼šå­¦ä¹ è€…æ³¨å†Œ

### 3.1 åœºæ™¯æè¿°

**åº”ç”¨åœºæ™¯**ï¼š
å­¦ä¹ è€…æ³¨å†Œåˆ°LMSç³»ç»Ÿï¼Œåˆ›å»ºå­¦ä¹ è€…è´¦æˆ·ã€‚

### 3.2 Schemaå®šä¹‰

**å­¦ä¹ è€…Schema**ï¼š

```dsl
schema Learner {
  learner_id: String @value("LEARNER001") @required
  name: String @value("å¼ ä¸‰") @required
  email: String @value("zhangsan@example.com") @required
  language: String @value("zh") @default("en")
} @standard("xAPI")
```

---

## 4. æ¡ˆä¾‹3ï¼šå­¦ä¹ è¿›åº¦è·Ÿè¸ª

### 4.1 åœºæ™¯æè¿°

**åº”ç”¨åœºæ™¯**ï¼š
è·Ÿè¸ªå­¦ä¹ è€…çš„å­¦ä¹ è¿›åº¦ï¼Œè®°å½•å­¦ä¹ æ´»åŠ¨ã€‚

### 4.2 Schemaå®šä¹‰

**å­¦ä¹ æ´»åŠ¨Schema**ï¼š

```dsl
schema LearningActivity {
  activity_id: String @value("ACTIVITY001") @required
  course_id: String @value("COURSE001") @required
  learner_id: String @value("LEARNER001") @required
  activity_type: Enum { Video_Watch } @value(Video_Watch)
  status: Enum { Completed } @value(Completed)
  progress_percentage: Decimal @value(100.0) @range(0.0, 100.0)
} @standard("xAPI")
```

---

## 5. æ¡ˆä¾‹4ï¼šSCORMåˆ°xAPIè½¬æ¢

### 5.1 åœºæ™¯æè¿°

**åº”ç”¨åœºæ™¯**ï¼š
å°†SCORMæ ¼å¼çš„å­¦ä¹ æ•°æ®è½¬æ¢ä¸ºxAPIè¯­å¥ã€‚

### 5.2 å®ç°ä»£ç 

```python
from lms_storage import LMSStorage

def convert_scorm_to_xapi_example():
    """SCORMåˆ°xAPIè½¬æ¢ç¤ºä¾‹"""
    scorm_data = {
        "learner_email": "learner@example.com",
        "learner_name": "å¼ ä¸‰",
        "course_id": "COURSE001",
        "course_title": "Pythonç¼–ç¨‹åŸºç¡€",
        "score": 85,
        "duration": 3600
    }

    # è½¬æ¢ä¸ºxAPIè¯­å¥
    xapi_statement = convert_scorm_to_xapi(scorm_data)
    print(f"xAPI Statement: {xapi_statement}")

    return xapi_statement

if __name__ == "__main__":
    convert_scorm_to_xapi_example()
```

---

## 6. æ¡ˆä¾‹5ï¼šå­¦ä¹ æ•°æ®å­˜å‚¨ä¸åˆ†æ

### 6.1 åœºæ™¯æè¿°

**åº”ç”¨åœºæ™¯**ï¼š
ä½¿ç”¨PostgreSQLå­˜å‚¨å­¦ä¹ æ•°æ®ï¼Œè¿›è¡Œå­¦ä¹ åˆ†æã€‚

### 6.2 å®ç°ä»£ç 

```python
from lms_storage import LMSStorage

def learning_data_storage_example():
    """å­¦ä¹ æ•°æ®å­˜å‚¨ç¤ºä¾‹"""
    storage = LMSStorage("postgresql://user:password@localhost/lms_db")
    storage.create_tables()

    # å­˜å‚¨è¯¾ç¨‹
    course_data = {
        "course_id": "COURSE001",
        "title": "Pythonç¼–ç¨‹åŸºç¡€",
        "description": "å­¦ä¹ Pythonç¼–ç¨‹åŸºç¡€",
        "category": "Technology",
        "level": "Beginner",
        "duration": 40
    }
    storage.store_course(course_data)

    # å­˜å‚¨å­¦ä¹ è€…
    learner_data = {
        "learner_id": "LEARNER001",
        "name": "å¼ ä¸‰",
        "email": "zhangsan@example.com",
        "language": "zh"
    }
    storage.store_learner(learner_data)

    # å­˜å‚¨å­¦ä¹ æ´»åŠ¨
    activity_data = {
        "activity_id": "ACTIVITY001",
        "course_id": "COURSE001",
        "learner_id": "LEARNER001",
        "activity_type": "Video_Watch",
        "status": "Completed",
        "progress_percentage": 100.0
    }
    storage.store_learning_activity(activity_data)

    # åˆ†æå­¦ä¹ æ•°æ®
    results = analyze_learning_data(storage)
    print(f"Learning analysis results: {results}")

    storage.close()

if __name__ == "__main__":
    learning_data_storage_example()
```

---

**å‚è€ƒæ–‡æ¡£**ï¼š

- `01_Overview.md` - æ¦‚è¿°
- `02_Formal_Definition.md` - å½¢å¼åŒ–å®šä¹‰
- `03_Standards.md` - æ ‡å‡†å¯¹æ ‡
- `04_Transformation.md` - è½¬æ¢ä½“ç³»

**åˆ›å»ºæ—¶é—´**ï¼š2025-01-21
**æœ€åæ›´æ–°**ï¼š2025-01-21
