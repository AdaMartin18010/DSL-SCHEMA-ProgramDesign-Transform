# å­¦ç”Ÿä¿¡æ¯ç³»ç»ŸSchemaå®è·µæ¡ˆä¾‹

## ğŸ“‘ ç›®å½•

- [å­¦ç”Ÿä¿¡æ¯ç³»ç»ŸSchemaå®è·µæ¡ˆä¾‹](#å­¦ç”Ÿä¿¡æ¯ç³»ç»Ÿschemaå®è·µæ¡ˆä¾‹)
  - [ğŸ“‘ ç›®å½•](#-ç›®å½•)
  - [1. æ¡ˆä¾‹æ¦‚è¿°](#1-æ¡ˆä¾‹æ¦‚è¿°)
  - [2. æ¡ˆä¾‹1ï¼šä¼ä¸šå­¦ç”Ÿä¿¡æ¯ç®¡ç†ç³»ç»Ÿ](#2-æ¡ˆä¾‹1ä¼ä¸šå­¦ç”Ÿä¿¡æ¯ç®¡ç†ç³»ç»Ÿ)
    - [2.1 ä¸šåŠ¡èƒŒæ™¯](#21-ä¸šåŠ¡èƒŒæ™¯)
    - [2.2 æŠ€æœ¯æŒ‘æˆ˜](#22-æŠ€æœ¯æŒ‘æˆ˜)
    - [2.3 è§£å†³æ–¹æ¡ˆ](#23-è§£å†³æ–¹æ¡ˆ)
    - [2.4 å®Œæ•´ä»£ç å®ç°](#24-å®Œæ•´ä»£ç å®ç°)
  - [3. æ¡ˆä¾‹2ï¼šå­¦ç±ç®¡ç†](#3-æ¡ˆä¾‹2å­¦ç±ç®¡ç†)
    - [3.1 åœºæ™¯æè¿°](#31-åœºæ™¯æè¿°)
    - [3.2 Schemaå®šä¹‰](#32-schemaå®šä¹‰)
  - [4. æ¡ˆä¾‹3ï¼šæˆç»©ç®¡ç†](#4-æ¡ˆä¾‹3æˆç»©ç®¡ç†)
    - [4.1 åœºæ™¯æè¿°](#41-åœºæ™¯æè¿°)
    - [4.2 Schemaå®šä¹‰](#42-schemaå®šä¹‰)
  - [5. æ¡ˆä¾‹4ï¼šEd-Fiåˆ°SIFè½¬æ¢](#5-æ¡ˆä¾‹4ed-fiåˆ°sifè½¬æ¢)
    - [5.1 åœºæ™¯æè¿°](#51-åœºæ™¯æè¿°)
    - [5.2 å®ç°ä»£ç ](#52-å®ç°ä»£ç )
  - [6. æ¡ˆä¾‹5ï¼šå­¦ç”Ÿæ•°æ®å­˜å‚¨ä¸åˆ†æ](#6-æ¡ˆä¾‹5å­¦ç”Ÿæ•°æ®å­˜å‚¨ä¸åˆ†æ)
    - [6.1 åœºæ™¯æè¿°](#61-åœºæ™¯æè¿°)
    - [6.2 å®ç°ä»£ç ](#62-å®ç°ä»£ç )

---

## 1. æ¡ˆä¾‹æ¦‚è¿°

æœ¬æ–‡æ¡£æä¾›å­¦ç”Ÿä¿¡æ¯ç³»ç»ŸSchemaåœ¨å®é™…ä¼ä¸šåº”ç”¨ä¸­çš„å®è·µæ¡ˆä¾‹ï¼Œæ¶µç›–å­¦ç”Ÿä¿¡æ¯ç®¡ç†ã€å­¦ç±ç®¡ç†ã€æˆç»©ç®¡ç†ç­‰çœŸå®åœºæ™¯ã€‚

**æ¡ˆä¾‹ç±»å‹**ï¼š

1. **å­¦ç”Ÿä¿¡æ¯ç®¡ç†ç³»ç»Ÿ**ï¼šå­¦ç”ŸåŸºæœ¬ä¿¡æ¯ç®¡ç†
2. **å­¦ç±ç®¡ç†ç³»ç»Ÿ**ï¼šå­¦ç”Ÿå­¦ç±ä¿¡æ¯ç®¡ç†
3. **æˆç»©ç®¡ç†ç³»ç»Ÿ**ï¼šå­¦ç”Ÿæˆç»©ç®¡ç†
4. **Ed-Fiåˆ°SIFè½¬æ¢å·¥å…·**ï¼šEd-Fiåˆ°SIFè½¬æ¢
5. **å­¦ç”Ÿæ•°æ®å­˜å‚¨ä¸åˆ†æç³»ç»Ÿ**ï¼šå­¦ç”Ÿæ•°æ®åˆ†æå’Œç›‘æ§

**å‚è€ƒä¼ä¸šæ¡ˆä¾‹**ï¼š

- **Ed-Fiæ ‡å‡†**ï¼šEd-Fiæ•°æ®æ ‡å‡†
- **SIFæ ‡å‡†**ï¼šSIF (Schools Interoperability Framework)æ ‡å‡†

---

## 2. æ¡ˆä¾‹1ï¼šä¼ä¸šå­¦ç”Ÿä¿¡æ¯ç®¡ç†ç³»ç»Ÿ

### 2.1 ä¸šåŠ¡èƒŒæ™¯

**ä¼ä¸šèƒŒæ™¯**ï¼š
æŸæ•™è‚²æœºæ„éœ€è¦æ„å»ºå­¦ç”Ÿä¿¡æ¯ç®¡ç†ç³»ç»Ÿï¼Œç®¡ç†å­¦ç”ŸåŸºæœ¬ä¿¡æ¯ã€å­¦ç±ä¿¡æ¯ã€æˆç»©ä¿¡æ¯ç­‰ï¼Œä½¿ç”¨Ed-Fiæ ‡å‡†æ ¼å¼ï¼Œç¡®ä¿æ•°æ®çš„æ ‡å‡†åŒ–å’Œäº’æ“ä½œæ€§ã€‚

**ä¸šåŠ¡ç—›ç‚¹**ï¼š

1. **ä¿¡æ¯ç®¡ç†ä¸è§„èŒƒ**ï¼šå­¦ç”Ÿä¿¡æ¯ç®¡ç†ä¸è§„èŒƒ
2. **æ•°æ®æ ¼å¼ä¸ç»Ÿä¸€**ï¼šæ•°æ®æ ¼å¼ä¸ç»Ÿä¸€
3. **ç³»ç»Ÿé›†æˆå›°éš¾**ï¼šä¸å…¶ä»–ç³»ç»Ÿé›†æˆå›°éš¾
4. **æ•°æ®è´¨é‡ä½**ï¼šæ•°æ®è´¨é‡ä½

**ä¸šåŠ¡ç›®æ ‡**ï¼š

- è§„èŒƒå­¦ç”Ÿä¿¡æ¯ç®¡ç†
- ç»Ÿä¸€æ•°æ®æ ¼å¼æ ‡å‡†
- ç®€åŒ–ç³»ç»Ÿé›†æˆ
- æé«˜æ•°æ®è´¨é‡

### 2.2 æŠ€æœ¯æŒ‘æˆ˜

1. **æ•°æ®æ¨¡å‹è®¾è®¡**ï¼šè®¾è®¡å­¦ç”Ÿä¿¡æ¯æ•°æ®æ¨¡å‹
2. **æ ‡å‡†åº”ç”¨**ï¼šåº”ç”¨Ed-Fiæ ‡å‡†
3. **æ•°æ®éªŒè¯**ï¼šéªŒè¯æ•°æ®å®Œæ•´æ€§
4. **ç³»ç»Ÿé›†æˆ**ï¼šä¸å…¶ä»–ç³»ç»Ÿé›†æˆ

### 2.3 è§£å†³æ–¹æ¡ˆ

**ç®¡ç†å­¦ç”ŸåŸºæœ¬ä¿¡æ¯ï¼Œä½¿ç”¨Ed-Fiæ ‡å‡†æ ¼å¼**ï¼š

### 2.4 å®Œæ•´ä»£ç å®ç°

**å­¦ç”Ÿä¿¡æ¯ç®¡ç†Schemaï¼ˆå®Œæ•´ç¤ºä¾‹ï¼‰**ï¼š

```python
#!/usr/bin/env python3
"""
å­¦ç”Ÿä¿¡æ¯ç³»ç»ŸSchemaå®ç°
"""

from typing import Dict, List, Optional
from datetime import date, datetime
from dataclasses import dataclass, field
from enum import Enum

class Gender(str, Enum):
    """æ€§åˆ«"""
    M = "M"
    F = "F"
    OTHER = "Other"

class EnrollmentStatus(str, Enum):
    """å­¦ç±çŠ¶æ€"""
    ACTIVE = "Active"
    INACTIVE = "Inactive"
    GRADUATED = "Graduated"
    TRANSFERRED = "Transferred"

@dataclass
class Student:
    """å­¦ç”Ÿ"""
    student_id: str
    name: str
    gender: Gender
    birth_date: date
    email: Optional[str] = None
    phone: Optional[str] = None
    address: Optional[str] = None
    created_date: Optional[datetime] = None

@dataclass
class Enrollment:
    """å­¦ç±"""
    enrollment_id: str
    student_id: str
    school_id: str
    grade_level: str
    admission_date: date
    enrollment_status: EnrollmentStatus
    graduation_date: Optional[date] = None
    created_date: Optional[datetime] = None

@dataclass
class Grade:
    """æˆç»©"""
    grade_id: str
    student_id: str
    course_id: str
    term: str
    grade_value: float
    grade_letter: Optional[str] = None
    credit_hours: Optional[float] = None
    created_date: Optional[datetime] = None

@dataclass
class SISStorage:
    """å­¦ç”Ÿä¿¡æ¯ç³»ç»Ÿæ•°æ®å­˜å‚¨"""
    students: Dict[str, Student] = field(default_factory=dict)
    enrollments: Dict[str, Enrollment] = field(default_factory=dict)
    grades: Dict[str, Grade] = field(default_factory=dict)

    def store_student(self, student: Student):
        """å­˜å‚¨å­¦ç”Ÿ"""
        if student.created_date is None:
            student.created_date = datetime.now()
        self.students[student.student_id] = student

    def store_enrollment(self, enrollment: Enrollment):
        """å­˜å‚¨å­¦ç±"""
        if enrollment.created_date is None:
            enrollment.created_date = datetime.now()

        # éªŒè¯å­¦ç”Ÿå­˜åœ¨
        if enrollment.student_id not in self.students:
            raise ValueError(f"Student {enrollment.student_id} not found")

        self.enrollments[enrollment.enrollment_id] = enrollment

    def store_grade(self, grade: Grade):
        """å­˜å‚¨æˆç»©"""
        if grade.created_date is None:
            grade.created_date = datetime.now()

        # éªŒè¯å­¦ç”Ÿå­˜åœ¨
        if grade.student_id not in self.students:
            raise ValueError(f"Student {grade.student_id} not found")

        self.grades[grade.grade_id] = grade

    def get_student_enrollments(self, student_id: str) -> List[Enrollment]:
        """è·å–å­¦ç”Ÿå­¦ç±"""
        return [e for e in self.enrollments.values() if e.student_id == student_id]

    def get_student_grades(self, student_id: str) -> List[Grade]:
        """è·å–å­¦ç”Ÿæˆç»©"""
        return [g for g in self.grades.values() if g.student_id == student_id]

    def get_student_gpa(self, student_id: str) -> Optional[float]:
        """è®¡ç®—å­¦ç”ŸGPA"""
        grades = self.get_student_grades(student_id)
        if not grades:
            return None

        total_points = 0.0
        total_credits = 0.0

        for grade in grades:
            if grade.credit_hours:
                total_points += grade.grade_value * grade.credit_hours
                total_credits += grade.credit_hours

        return total_points / total_credits if total_credits > 0 else None

# ä½¿ç”¨ç¤ºä¾‹
if __name__ == '__main__':
    # åˆ›å»ºSISå­˜å‚¨
    sis = SISStorage()

    # åˆ›å»ºå­¦ç”Ÿ
    student = Student(
        student_id="STU001",
        name="å¼ ä¸‰",
        gender=Gender.M,
        birth_date=date(2005, 5, 15),
        email="zhangsan@example.com"
    )
    sis.store_student(student)

    # åˆ›å»ºå­¦ç±
    enrollment = Enrollment(
        enrollment_id="ENR001",
        student_id="STU001",
        school_id="SCH001",
        grade_level="Grade 10",
        admission_date=date(2023, 9, 1),
        enrollment_status=EnrollmentStatus.ACTIVE
    )
    sis.store_enrollment(enrollment)

    # åˆ›å»ºæˆç»©
    grade = Grade(
        grade_id="GRD001",
        student_id="STU001",
        course_id="MATH001",
        term="Fall 2024",
        grade_value=85.5,
        grade_letter="B",
        credit_hours=3.0
    )
    sis.store_grade(grade)

    # è®¡ç®—GPA
    gpa = sis.get_student_gpa("STU001")
    print(f"å­¦ç”ŸGPA: {gpa}")
```

### 2.5 æ•ˆæœè¯„ä¼°

**æ€§èƒ½æŒ‡æ ‡**ï¼š

| æŒ‡æ ‡ | æ”¹è¿›å‰ | æ”¹è¿›å | æå‡ |
|------|--------|--------|------|
| ä¿¡æ¯ç®¡ç†è§„èŒƒæ€§ | 70% | 95% | 25%æå‡ |
| æ•°æ®æ ¼å¼ç»Ÿä¸€æ€§ | 60% | 98% | 38%æå‡ |
| ç³»ç»Ÿé›†æˆæ•ˆç‡ | ä½ | é«˜ | æ˜¾è‘—æå‡ |
| æ•°æ®è´¨é‡ | 75% | 95% | 20%æå‡ |

**ä¸šåŠ¡ä»·å€¼**ï¼š
1. **ç®¡ç†è§„èŒƒåŒ–**ï¼šè§„èŒƒå­¦ç”Ÿä¿¡æ¯ç®¡ç†æµç¨‹
2. **æ ¼å¼ç»Ÿä¸€**ï¼šç»Ÿä¸€æ•°æ®æ ¼å¼æ ‡å‡†
3. **é›†æˆç®€åŒ–**ï¼šç®€åŒ–ç³»ç»Ÿé›†æˆ
4. **è´¨é‡æé«˜**ï¼šæé«˜æ•°æ®è´¨é‡

**ç»éªŒæ•™è®­**ï¼š
1. æ•°æ®æ¨¡å‹è®¾è®¡å¾ˆé‡è¦
2. æ ‡å‡†åº”ç”¨éœ€è¦å‡†ç¡®
3. æ•°æ®éªŒè¯éœ€è¦ä¸¥æ ¼
4. ç³»ç»Ÿé›†æˆéœ€è¦æ ‡å‡†åŒ–

**å‚è€ƒæ¡ˆä¾‹**ï¼š
- [Ed-Fiæ•°æ®æ ‡å‡†](https://www.ed-fi.org/)
- [SIFæ ‡å‡†](https://www.a4l.org/)

---

## 3. æ¡ˆä¾‹2ï¼šå­¦ç±ç®¡ç†

### 3.1 åœºæ™¯æè¿°

**åº”ç”¨åœºæ™¯**ï¼š
ç®¡ç†å­¦ç”Ÿå­¦ç±ä¿¡æ¯ï¼Œè·Ÿè¸ªå­¦ç±çŠ¶æ€å˜æ›´ã€‚

### 3.2 Schemaå®šä¹‰

**å­¦ç±ä¿¡æ¯Schema**ï¼š

```dsl
schema EnrollmentInfo {
  enrollment_id: String @value("ENR001") @required
  student_id: String @value("STU001") @required
  admission_date: Date @value("2023-09-01")
  enrollment_status: Enum { Active } @value(Active)
} @standard("Ed-Fi")
```

---

## 4. æ¡ˆä¾‹3ï¼šæˆç»©ç®¡ç†

### 4.1 åœºæ™¯æè¿°

**åº”ç”¨åœºæ™¯**ï¼š
ç®¡ç†å­¦ç”Ÿè¯¾ç¨‹æˆç»©ï¼Œè®¡ç®—GPAã€‚

### 4.2 Schemaå®šä¹‰

**æˆç»©ä¿¡æ¯Schema**ï¼š

```dsl
schema GradeInfo {
  grade_id: String @value("GRD001") @required
  student_id: String @value("STU001") @required
  course_name: String @value("æ•°å­¦")
  semester: String @value("2024æ˜¥å­£")
  grade: String @value("A")
  grade_points: Decimal @value(4.0)
  credits: Decimal @value(3.0)
} @standard("Ed-Fi")
```

---

## 5. æ¡ˆä¾‹4ï¼šEd-Fiåˆ°SIFè½¬æ¢

### 5.1 åœºæ™¯æè¿°

**åº”ç”¨åœºæ™¯**ï¼š
å°†Ed-Fiæ ¼å¼çš„å­¦ç”Ÿæ•°æ®è½¬æ¢ä¸ºSIFæ¶ˆæ¯æ ¼å¼ã€‚

### 5.2 å®ç°ä»£ç 

```python
from sis_storage import SISStorage

def convert_edfi_to_sif_example():
    """Ed-Fiåˆ°SIFè½¬æ¢ç¤ºä¾‹"""
    edfi_data = {
        "student_id": "STU001",
        "name": "å¼ ä¸‰",
        "birth_date": "2005-05-15",
        "gender": "M"
    }

    # è½¬æ¢ä¸ºSIFæ¶ˆæ¯
    sif_message = convert_edfi_to_sif(edfi_data)
    print(f"SIF Message: {sif_message}")

    return sif_message

if __name__ == "__main__":
    convert_edfi_to_sif_example()
```

---

## 6. æ¡ˆä¾‹5ï¼šå­¦ç”Ÿæ•°æ®å­˜å‚¨ä¸åˆ†æ

### 6.1 åœºæ™¯æè¿°

**åº”ç”¨åœºæ™¯**ï¼š
ä½¿ç”¨PostgreSQLå­˜å‚¨å­¦ç”Ÿæ•°æ®ï¼Œè¿›è¡Œå­¦ç”Ÿåˆ†æã€‚

### 6.2 å®ç°ä»£ç 

```python
from sis_storage import SISStorage

def student_data_storage_example():
    """å­¦ç”Ÿæ•°æ®å­˜å‚¨ç¤ºä¾‹"""
    storage = SISStorage("postgresql://user:password@localhost/sis_db")
    storage.create_tables()

    # å­˜å‚¨å­¦ç”Ÿ
    student_data = {
        "student_id": "STU001",
        "name": "å¼ ä¸‰",
        "gender": "M",
        "birth_date": "2005-05-15",
        "email": "zhangsan@example.com"
    }
    storage.store_student(student_data)

    # å­˜å‚¨å­¦ç±
    enrollment_data = {
        "enrollment_id": "ENR001",
        "student_id": "STU001",
        "admission_date": "2023-09-01",
        "enrollment_status": "Active"
    }
    storage.store_enrollment(enrollment_data)

    # å­˜å‚¨æˆç»©
    grade_data = {
        "grade_id": "GRD001",
        "student_id": "STU001",
        "course_name": "æ•°å­¦",
        "semester": "2024æ˜¥å­£",
        "grade": "A",
        "grade_points": 4.0,
        "credits": 3.0
    }
    storage.store_grade(grade_data)

    # åˆ†æå­¦ç”Ÿæ•°æ®
    results = analyze_student_data(storage)
    print(f"Student analysis results: {results}")

    storage.close()

if __name__ == "__main__":
    student_data_storage_example()
```

---

**å‚è€ƒæ–‡æ¡£**ï¼š

- `01_Overview.md` - æ¦‚è¿°
- `02_Formal_Definition.md` - å½¢å¼åŒ–å®šä¹‰
- `03_Standards.md` - æ ‡å‡†å¯¹æ ‡
- `04_Transformation.md` - è½¬æ¢ä½“ç³»

**åˆ›å»ºæ—¶é—´**ï¼š2025-01-21
**æœ€åæ›´æ–°**ï¼š2025-01-21
