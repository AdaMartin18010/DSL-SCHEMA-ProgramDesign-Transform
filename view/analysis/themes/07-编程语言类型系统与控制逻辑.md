# Schema ä¸ç¼–ç¨‹è¯­è¨€ç±»å‹ç³»ç»Ÿã€æ§åˆ¶é€»è¾‘çš„è½¬æ¢è®ºè¯

## ğŸ“š ç›¸å…³æ–‡æ¡£

- **[01-é¢†åŸŸè¯­è¨€è½¬æ¢ä¸AIæ—¶ä»£é€‚é…æ–¹æ¡ˆ](./01-é¢†åŸŸè¯­è¨€è½¬æ¢ä¸AIæ—¶ä»£é€‚é…æ–¹æ¡ˆ.md)** - AI+Codeæ—¶ä»£çš„é€‚é…æ–¹æ¡ˆ
- **[03-DSLè½¬æ¢æ–¹æ¡ˆä¸æŠ€æœ¯åˆ†æ](./03-DSLè½¬æ¢æ–¹æ¡ˆä¸æŠ€æœ¯åˆ†æ.md)** - DSLè½¬æ¢çš„æŠ€æœ¯æ–¹æ¡ˆ
- **[06-å¤šç»´æ¨¡å‹è½¬æ¢è®ºè¯](./06-å¤šç»´æ¨¡å‹è½¬æ¢è®ºè¯.md)** - å¤šç»´æ¨¡å‹è½¬æ¢çš„ç†è®ºåŸºç¡€
- **[02-DSLåˆ†ç±»ä¸å…¸å‹ç¤ºä¾‹](./02-DSLåˆ†ç±»ä¸å…¸å‹ç¤ºä¾‹.md)** - DSLåˆ†ç±»ä½“ç³»

---

## ä¸€ã€Schema ä¸ç¼–ç¨‹è¯­è¨€ç±»å‹ç³»ç»Ÿçš„æ˜ å°„

### 1.1 ç±»å‹ç³»ç»Ÿå¯¹æ¯”çŸ©é˜µ

#### ğŸ“Š ç¼–ç¨‹è¯­è¨€ç±»å‹ç³»ç»Ÿå¯¹æ¯”

| è¯­è¨€ | ç±»å‹ç³»ç»Ÿ | ç±»å‹å®‰å…¨ | è¿è¡Œæ—¶æ£€æŸ¥ | Schemaæ˜ å°„ | ä»£ç ç”Ÿæˆ | æ¨èå·¥å…· |
|------|----------|----------|------------|------------|----------|----------|
| **Python** | åŠ¨æ€/é™æ€ | âš ï¸ å¯é€‰ | âš ï¸ éƒ¨åˆ† | âœ… Pydantic | âœ… ä¼˜ç§€ | Pydantic |
| **TypeScript** | é™æ€ | âœ… å¼º | âœ… ç¼–è¯‘æ—¶ | âœ… åŸç”Ÿ | âœ… ä¼˜ç§€ | TypeScript |
| **Java** | é™æ€ | âœ… å¼º | âœ… è¿è¡Œæ—¶ | âœ… Jackson | âœ… ä¼˜ç§€ | Jackson |
| **Go** | é™æ€ | âœ… å¼º | âœ… ç¼–è¯‘æ—¶ | âš ï¸ æ‰‹åŠ¨ | âš ï¸ æœ‰é™ | è‡ªå®šä¹‰ |
| **Rust** | é™æ€ | âœ… æå¼º | âœ… ç¼–è¯‘æ—¶ | âš ï¸ æ‰‹åŠ¨ | âš ï¸ æœ‰é™ | serde |
| **C#** | é™æ€ | âœ… å¼º | âœ… è¿è¡Œæ—¶ | âœ… åŸç”Ÿ | âœ… ä¼˜ç§€ | System.Text.Json |

#### ğŸ—ºï¸ Schemaåˆ°ç±»å‹ç³»ç»Ÿæ˜ å°„æ€ç»´å¯¼å›¾

```mermaid
mindmap
  root((Schemaç±»å‹æ˜ å°„))
    Python
      Pydantic
      BaseModel
      ç±»å‹éªŒè¯
      æ•°æ®æ ¡éªŒ
    TypeScript
      æ¥å£å®šä¹‰
      ç±»å‹æ¨æ–­
      ç¼–è¯‘æ£€æŸ¥
      æ³›å‹æ”¯æŒ
    Java
      Jackson
      æ³¨è§£é©±åŠ¨
      åºåˆ—åŒ–
      ååºåˆ—åŒ–
    Go
      ç»“æ„ä½“æ ‡ç­¾
      æ‰‹åŠ¨æ˜ å°„
      ç±»å‹æ–­è¨€
    Rust
      serde
      æ´¾ç”Ÿå®
      é›¶æˆæœ¬æŠ½è±¡
```

### 1.2 ç±»å‹ç³»ç»Ÿæ˜ å°„è§„åˆ™

| **Schema ç±»å‹**       | **Python (Pydantic)**     | **TypeScript**            | **Java (Jackson)**        |
|------------------------|---------------------------|---------------------------|---------------------------|
| `string`               | `str`                     | `string`                  | `String`                  |
| `number`               | `float`                   | `number`                  | `Double`                  |
| `integer`              | `int`                     | `integer`                 | `Integer`                 |
| `boolean`              | `bool`                    | `boolean`                 | `Boolean`                 |
| `array`                | `List[T]`                 | `Array<T>`                | `List<T>`                 |
| `object`               | `Dict[str, Any]`          | `Record<string, any>`     | `Map<String, Object>`     |
| `date-time`            | `datetime`                | `Date`                    | `LocalDateTime`           |

### 1.2 è‡ªåŠ¨ä»£ç ç”Ÿæˆå·¥å…·

#### OpenAPI â†’ Pydantic (Python)

**å·¥å…·**ï¼š`openapi2pydantic`

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```bash
openapi2pydantic -i openapi.yaml -o models.py
```

**ç”Ÿæˆä»£ç **ï¼š

```python
from pydantic import BaseModel
from datetime import datetime

class User(BaseModel):
    id: int
    name: str
    created_at: datetime
```

#### OpenAPI â†’ TypeScript

**å·¥å…·**ï¼š`openapi-generator-cli`

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```bash
openapi-generator-cli generate -i openapi.yaml -g typescript-fetch
```

**ç”Ÿæˆä»£ç **ï¼š

```typescript
interface User {
  id: number;
  name: string;
  createdAt: string; // ISO 8601 format
}
```

#### OpenAPI â†’ Java (Jackson)

**å·¥å…·**ï¼š`openapi-generator-cli`

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```bash
openapi-generator-cli generate -i openapi.yaml -g java
```

**ç”Ÿæˆä»£ç **ï¼š

```java
@Data
public class User {
  private Integer id;
  private String name;
  private LocalDateTime createdAt;
}
```

### 1.3 ç±»å‹ç³»ç»Ÿçš„ä¼˜åŠ¿

#### ç¼–è¯‘æ—¶éªŒè¯

**é™æ€ç±»å‹è¯­è¨€**ï¼ˆå¦‚ TypeScriptã€Javaï¼‰åœ¨ç¼–è¯‘é˜¶æ®µæ•è·ç±»å‹é”™è¯¯ï¼š

```typescript
// TypeScript - ç¼–è¯‘æ—¶é”™è¯¯
const user: User = {
  id: "123", // é”™è¯¯ï¼šç±»å‹ä¸åŒ¹é…
  name: "Alice"
};
```

#### è¿è¡Œæ—¶éªŒè¯

**åŠ¨æ€ç±»å‹è¯­è¨€**ï¼ˆå¦‚ Pythonï¼‰é€šè¿‡ Pydantic ç­‰åº“è¿›è¡Œè¿è¡Œæ—¶æ ¡éªŒï¼š

```python
# Python - è¿è¡Œæ—¶éªŒè¯
from pydantic import ValidationError

try:
    user = User(id="123", name="Alice")  # é”™è¯¯ï¼šid å¿…é¡»æ˜¯ int
except ValidationError as e:
    print(e)
```

#### IDE æ”¯æŒ

ç±»å‹æç¤ºæå‡ä»£ç å¯è¯»æ€§å’Œå¼€å‘æ•ˆç‡ï¼š

- **è‡ªåŠ¨è¡¥å…¨**ï¼šIDE å¯ä»¥æ ¹æ®ç±»å‹æç¤ºæä¾›ä»£ç è¡¥å…¨
- **é”™è¯¯æ£€æµ‹**ï¼šIDE å¯ä»¥å®æ—¶æ£€æµ‹ç±»å‹é”™è¯¯
- **é‡æ„æ”¯æŒ**ï¼šç±»å‹ä¿¡æ¯æ”¯æŒå®‰å…¨çš„ä»£ç é‡æ„

## äºŒã€Schema ä¸æ§åˆ¶é€»è¾‘çš„æ˜ å°„

### 2.1 æ§åˆ¶é€»è¾‘æ˜ å°„è§„åˆ™

| **Schema çº¦æŸ**        | **Python æ§åˆ¶é€»è¾‘**                          | **TypeScript æ§åˆ¶é€»è¾‘**                  | **Java æ§åˆ¶é€»è¾‘**                          |
|------------------------|----------------------------------------------|------------------------------------------|--------------------------------------------|
| `required`             | `assert model.id is not None`                | `if (!user.id) throw new Error()`        | `if (user.getId() == null) throw new Exception()` |
| `format: date-time`    | `datetime.fromisoformat(model.created_at)`   | `new Date(user.createdAt)`               | `LocalDateTime.parse(user.getCreatedAt())` |
| `maximum: 100`         | `assert model.temperature <= 100`            | `if (user.age > 100) throw new Error()`  | `if (user.getAge() > 100) throw new Exception()` |

### 2.2 æ§åˆ¶é€»è¾‘è‡ªåŠ¨ç”Ÿæˆ

#### OpenAPI â†’ æ§åˆ¶é€»è¾‘ä»£ç 

**å·¥å…·**ï¼š`openapi2pydantic` with validation

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```bash
openapi2pydantic -i openapi.yaml -o models.py --generate-validation
```

**ç”Ÿæˆä»£ç **ï¼š

```python
from pydantic import BaseModel, validator

class User(BaseModel):
    id: int
    name: str

    @validator('name')
    def name_length(cls, v):
        if len(v) > 100:
            raise ValueError('name too long')
        return v
```

#### OpenAPI â†’ Java æ§åˆ¶é€»è¾‘

**ç”Ÿæˆä»£ç **ï¼š

```java
@Data
public class User {
  @NotNull
  private Integer id;

  @Size(max = 100)
  private String name;

  @Past
  private LocalDateTime createdAt;
}
```

### 2.3 æ§åˆ¶é€»è¾‘çš„ä¼˜åŠ¿

#### æ•°æ®å®Œæ•´æ€§

é€šè¿‡æ ¡éªŒè§„åˆ™ï¼ˆå¦‚ `required`ã€`format`ï¼‰ç¡®ä¿æ•°æ®åˆæ³•æ€§ï¼š

```python
# Python - Pydantic éªŒè¯
class User(BaseModel):
    id: int
    name: str = Field(..., min_length=1, max_length=100)
    email: str = Field(..., regex=r'^[\w\.-]+@[\w\.-]+\.\w+$')
```

#### å¼‚å¸¸å¤„ç†

è‡ªåŠ¨æŠ›å‡ºå¼‚å¸¸æˆ–è¿”å›é”™è¯¯ç ï¼Œé¿å…è„æ•°æ®è¿›å…¥ç³»ç»Ÿï¼š

```typescript
// TypeScript - éªŒè¯å‡½æ•°
function validateUser(user: User): void {
  if (!user.id) {
    throw new ValidationError('id is required');
  }
  if (user.name.length > 100) {
    throw new ValidationError('name too long');
  }
}
```

#### å¹¶å‘æ§åˆ¶

åœ¨å¤šçº¿ç¨‹/å¼‚æ­¥åœºæ™¯ä¸­ï¼Œé€šè¿‡é”æœºåˆ¶æˆ–åŸå­æ“ä½œç¡®ä¿ä¸€è‡´æ€§ï¼š

```java
// Java - å¹¶å‘æ§åˆ¶
public class UserService {
  private final Lock lock = new ReentrantLock();

  public void updateUser(User user) {
    lock.lock();
    try {
      validateUser(user);
      userRepository.save(user);
    } finally {
      lock.unlock();
    }
  }
}
```

## ä¸‰ã€æ‰©å±•å¤šç»´å¯¹æ¯”çŸ©é˜µ

| **ç»´åº¦**          | **Schema**                | **API**                   | **SQL**                   | **JSON**                  | **MQTT/Kafka**            | **ç¼–ç¨‹è¯­è¨€ç±»å‹ç³»ç»Ÿ**      | **æ§åˆ¶é€»è¾‘**              |
|-------------------|---------------------------|---------------------------|---------------------------|---------------------------|---------------------------|---------------------------|---------------------------|
| **æ•°æ®æ ¼å¼**       | å®šä¹‰ç»“æ„ï¼ˆYAML/JSONï¼‰     | è¯·æ±‚/å“åº”ï¼ˆHTTPï¼‰         | è¡¨ç»“æ„ï¼ˆDDLï¼‰             | é”®å€¼å¯¹ï¼ˆæ— æ¨¡å¼ï¼‰          | äºŒè¿›åˆ¶/JSON               | ç±»å‹å®šä¹‰ï¼ˆç±»/æ¥å£ï¼‰       | æ ¡éªŒè§„åˆ™ï¼ˆrequired/formatï¼‰|
| **é€šä¿¡æ–¹å¼**       | æ— ï¼ˆå®šä¹‰è§„åˆ™ï¼‰            | HTTP/HTTPS                | æ— ï¼ˆæŒä¹…åŒ–ï¼‰              | æ— ï¼ˆæ•°æ®è½½ä½“ï¼‰            | TCPï¼ˆè½»é‡çº§ï¼‰             | ç±»å‹æ˜ å°„ï¼ˆç¼–è¯‘/è¿è¡Œæ—¶ï¼‰   | å¼‚å¸¸å¤„ç†ï¼ˆtry/catchï¼‰     |
| **è¯­ä¹‰çº¦æŸ**       | å¼ºï¼ˆå­—æ®µç±»å‹ã€å¿…å¡«é¡¹ï¼‰    | å¼ºï¼ˆSchema éªŒè¯ï¼‰         | å¼ºï¼ˆè¡¨çº¦æŸï¼‰              | å¼±ï¼ˆåŠ¨æ€å­—æ®µï¼‰            | å¼±ï¼ˆåŠ¨æ€ä¸»é¢˜ï¼‰            | å¼ºï¼ˆç±»å‹ç³»ç»Ÿï¼‰            | å¼ºï¼ˆæ ¡éªŒé€»è¾‘ï¼‰            |
| **å…¸å‹åœºæ™¯**       | API æ–‡æ¡£ã€æ•°æ®æ ¡éªŒ        | ç³»ç»Ÿé—´é€šä¿¡                | æ•°æ®æŒä¹…åŒ–                | API å“åº”ã€æ¶ˆæ¯è´Ÿè½½        | å®æ—¶ä¼ æ„Ÿå™¨æ•°æ®            | ç±»å‹å®‰å…¨çš„ä»£ç ç”Ÿæˆ        | æ•°æ®å®Œæ•´æ€§ä¿éšœ            |
| **å·¥å…·/åè®®**      | OpenAPI, IOT Schema       | REST, GraphQL             | PostgreSQL, MySQL         | JSON, XML                 | MQTT, Kafka               | Pydantic, Jackson, Typescript | Pydantic, Java Validation |
| **è½¬æ¢ç­–ç•¥**       | â†’ API å®šä¹‰æ¥å£            | â†’ SQL/JSON/Kafka          | â† JSON/MQTT/Kafka         | â† SQL/â†’ API/MQTT/Kafka    | â† JSON/â†’ SQL/API          | â†’ ç±»å‹å®šä¹‰ â†’ æ§åˆ¶é€»è¾‘     | â†’ æ ¡éªŒè§„åˆ™ â†’ å¼‚å¸¸å¤„ç†     |

## å››ã€è¡¥å……æ¡ˆä¾‹è®ºè¯

### 4.1 OpenAPI Schema â†’ Pydantic + æ§åˆ¶é€»è¾‘

#### Schema å®šä¹‰

```yaml
components:
  schemas:
    User:
      type: object
      properties:
        id:
          type: integer
          required: true
        name:
          type: string
          maxLength: 100
        createdAt:
          type: string
          format: date-time
```

#### Python ä»£ç ç”Ÿæˆ

```python
from pydantic import BaseModel, validator
from datetime import datetime

class User(BaseModel):
    id: int
    name: str
    created_at: datetime

    @validator('name')
    def name_length(cls, v):
        if len(v) > 100:
            raise ValueError('name too long')
        return v
```

### 4.2 JSON Schema â†’ Java æ§åˆ¶é€»è¾‘

#### JSON Schema å®šä¹‰

```json
{
  "type": "object",
  "properties": {
    "id": {
      "type": "integer",
      "minimum": 1
    },
    "name": {
      "type": "string",
      "maxLength": 50
    }
  },
  "required": ["id", "name"]
}
```

#### Java ä»£ç ç”Ÿæˆ

```java
@Data
public class User {
    @Min(1)
    private Integer id;

    @Size(max = 50)
    private String name;
}
```

## äº”ã€æ€»ç»“ä¸å»ºè®®

### 5.1 ç±»å‹ç³»ç»Ÿæ˜ å°„

**å»ºè®®**ï¼š

- åˆ©ç”¨ Pydanticï¼ˆPythonï¼‰ã€Jacksonï¼ˆJavaï¼‰ã€TypeScript æ¥å£ç­‰å·¥å…·ï¼Œå°† Schema è½¬æ¢ä¸ºå¼ºç±»å‹ä»£ç 
- æå‡ç±»å‹å®‰å…¨æ€§å’Œå¼€å‘æ•ˆç‡
- å‡å°‘è¿è¡Œæ—¶é”™è¯¯

### 5.2 æ§åˆ¶é€»è¾‘ç”Ÿæˆ

**å»ºè®®**ï¼š

- é€šè¿‡æ ¡éªŒåº“ï¼ˆå¦‚ Pydantic çš„ `@validator`ã€Java çš„ `@Size`ï¼‰è‡ªåŠ¨å®ç° Schema çº¦æŸçš„æ§åˆ¶é€»è¾‘
- å‡å°‘æ‰‹åŠ¨ç¼–ç é”™è¯¯
- æå‡ä»£ç å¯ç»´æŠ¤æ€§

### 5.3 å·¥å…·æ¨è

**ä»£ç ç”Ÿæˆ**ï¼š

- `openapi2pydantic`ï¼šPython ä»£ç ç”Ÿæˆ
- `openapi-generator`ï¼šå¤šè¯­è¨€ä»£ç ç”Ÿæˆ
- `swagger-codegen`ï¼šä¼ ç»Ÿä»£ç ç”Ÿæˆå·¥å…·

**ç±»å‹æ ¡éªŒ**ï¼š

- **Pydantic**ï¼šPython è¿è¡Œæ—¶éªŒè¯
- **Jackson**ï¼šJava åºåˆ—åŒ–/ååºåˆ—åŒ–
- **TypeScript**ï¼šç¼–è¯‘æ—¶ç±»å‹æ£€æŸ¥
- **zod**ï¼šTypeScript è¿è¡Œæ—¶éªŒè¯

### 5.4 æœªæ¥è¶‹åŠ¿

**AI é©±åŠ¨ç±»å‹æ˜ å°„**ï¼š

- è®­ç»ƒæ¨¡å‹è‡ªåŠ¨ç”Ÿæˆç±»å‹ä»£ç ï¼ˆå¦‚ GitHub Copilotï¼‰
- æ”¯æŒè‡ªç„¶è¯­è¨€åˆ°ç±»å‹å®šä¹‰çš„è½¬æ¢
- æå‡å¼€å‘æ•ˆç‡

**è‡ªåŠ¨åŒ–æ§åˆ¶é€»è¾‘**ï¼š

- åŸºäº Schema è‡ªåŠ¨ç”Ÿæˆå¼‚å¸¸å¤„ç†é€»è¾‘ï¼ˆå¦‚ `try/catch`ï¼‰
- æ”¯æŒæ™ºèƒ½é”™è¯¯æ¢å¤
- æå‡ç³»ç»Ÿå¥å£®æ€§

---

## å»¶ä¼¸é˜…è¯»

### ç›¸å…³ä¸»é¢˜æ–‡æ¡£

- **[01-é¢†åŸŸè¯­è¨€è½¬æ¢ä¸AIæ—¶ä»£é€‚é…æ–¹æ¡ˆ](./01-é¢†åŸŸè¯­è¨€è½¬æ¢ä¸AIæ—¶ä»£é€‚é…æ–¹æ¡ˆ.md)** - äº†è§£AI+Codeæ—¶ä»£çš„é€‚é…æ–¹æ¡ˆ
- **[03-DSLè½¬æ¢æ–¹æ¡ˆä¸æŠ€æœ¯åˆ†æ](./03-DSLè½¬æ¢æ–¹æ¡ˆä¸æŠ€æœ¯åˆ†æ.md)** - æ·±å…¥å­¦ä¹ DSLè½¬æ¢çš„æŠ€æœ¯å®ç°
- **[06-å¤šç»´æ¨¡å‹è½¬æ¢è®ºè¯](./06-å¤šç»´æ¨¡å‹è½¬æ¢è®ºè¯.md)** - å­¦ä¹ å¤šç»´æ¨¡å‹è½¬æ¢çš„ç†è®ºåŸºç¡€
- **[02-DSLåˆ†ç±»ä¸å…¸å‹ç¤ºä¾‹](./02-DSLåˆ†ç±»ä¸å…¸å‹ç¤ºä¾‹.md)** - äº†è§£DSLåˆ†ç±»ä½“ç³»

### å¯¼èˆªæ–‡æ¡£

- **[æ€»ä½“å¯¼èˆª](./æ€»ä½“å¯¼èˆª.md)** - æŸ¥çœ‹å®Œæ•´çš„æ–‡æ¡£å¯¼èˆªç³»ç»Ÿ
- **[ä¸»é¢˜åˆ†æç´¢å¼•](./ä¸»é¢˜åˆ†æç´¢å¼•.md)** - å¿«é€ŸæŸ¥æ‰¾ç›¸å…³ä¸»é¢˜
- **[æ–‡æ¡£æ€»ç´¢å¼•](./æ–‡æ¡£æ€»ç´¢å¼•.md)** - æŸ¥çœ‹æ‰€æœ‰æ–‡æ¡£çš„å®Œæ•´æ¸…å•

é€šè¿‡è¡¥å…… Schema ä¸ç¼–ç¨‹è¯­è¨€ç±»å‹ç³»ç»Ÿã€æ§åˆ¶é€»è¾‘çš„æ˜ å°„ï¼Œå¼€å‘è€…å¯æ„å»ºæ›´å¥å£®çš„ç³»ç»Ÿï¼Œç¡®ä¿æ•°æ®ä¸€è‡´æ€§ã€ç±»å‹å®‰å…¨æ€§å’Œæ§åˆ¶å®Œæ•´æ€§ã€‚
