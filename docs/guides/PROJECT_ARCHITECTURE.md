# DSL Schema 项目架构图

**版本**: v1.0  
**最后更新**: 2026-02-16  
**维护者**: DSL Schema研究团队

---

## 📐 系统架构概览

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           DSL Schema 平台                                    │
│                     DSL Schema Platform                                      │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                     🌐 统一API网关 (Unified API Gateway)              │   │
│  │                        Port: 8080                                    │   │
│  │     路由管理 │ 负载均衡 │ 认证授权 │ 请求转发 │ 限流熔断               │   │
│  └────────────────────┬────────────────────────────────────────────────┘   │
│                       │                                                      │
│           ┌───────────┼───────────┬───────────┬───────────┐                 │
│           ▼           ▼           ▼           ▼           ▼                 │
│  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌────────┐ │
│  │ 🧠 多模态   │ │ ⏱️ 时序     │ │ 🤖 LLM     │ │ 📋 USL     │ │ 🔄 版本 │ │
│  │  知识图谱   │ │  知识图谱   │ │  推理引擎   │ │  解析器    │ │  管理  │ │
│  │  :8000     │ │  :8001     │ │  :8002     │ │  :8003     │ │ :8004  │ │
│  └──────┬──────┘ └──────┬──────┘ └──────┬──────┘ └──────┬──────┘ └───┬────┘ │
│         │               │               │               │              │     │
│         └───────────────┴───────────────┴───────────────┴──────────────┘     │
│                                       │                                      │
│                                       ▼                                      │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                    🔧 核心服务层 (Core Services)                     │   │
│  │  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐   │   │
│  │  │ 层次化知识  │ │  知识链     │ │ 可解释性    │ │ Schema      │   │   │
│  │  │  表示       │ │  方法       │ │  推理       │ │ 转换引擎    │   │   │
│  │  └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘   │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                       │                                      │
│                                       ▼                                      │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                    💾 数据存储层 (Data Layer)                        │   │
│  │  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐   │   │
│  │  │  Vector DB  │ │  Graph DB   │ │  Time-Series│ │  Document   │   │   │
│  │  │ (ChromaDB)  │ │  (Neo4j)    │ │  (Prometheus│ │  (MongoDB)  │   │   │
│  │  └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘   │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────┐
│                           📦 代码组织结构                                    │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  DSL-SCHEMA-ProgramDesign-Transform/                                         │
│  ├── 📁 code/                    # 源代码 (~6840行)                         │
│  │   ├── multimodal_kg/         # 多模态知识图谱模块                        │
│  │   ├── temporal_kg/            # 时序知识图谱模块                          │
│  │   ├── llm_reasoning/          # LLM推理引擎                              │
│  │   ├── usl/                    # 统一Schema语言                           │
│  │   ├── hierarchical_knowledge/ # 层次化知识表示                           │
│  │   ├── knowledge_chain/        # 知识链方法                               │
│  │   ├── explainable_reasoning/  # 可解释性推理                            │
│  │   ├── schema_version/         # Schema版本管理                           │
│  │   ├── api_gateway/            # API网关                                 │
│  │   └── tests/                  # 测试代码                                 │
│  │                                                                              │
│  ├── 📁 docs/                    # 文档 (163个)                             │
│  │   ├── guides/                 # 指南文档                                 │
│  │   ├── theory/                 # 理论文档                                 │
│  │   ├── standards/              # 标准文档                                 │
│  │   └── api/                    # API文档                                  │
│  │                                                                              │
│  ├── 📁 themes/                  # Schema文档 (320个)                       │
│  │   └── 64个Schema × 5个文档                                              │
│  │                                                                              │
│  ├── 📁 examples/                # 示例代码                                 │
│  ├── 📁 docker/                  # Docker配置                               │
│  ├── 📁 view/                    # 视图理论                                  │
│  └── 📁 scripts/                 # 脚本工具                                  │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────┐
│                          🔄 数据流架构                                       │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   用户请求                                                                    │
│      │                                                                       │
│      ▼                                                                       │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐  │
│  │   API网关   │───▶│   路由层    │───▶│  服务处理   │───▶│   响应      │  │
│  │  (Port 8080)│    │  (Router)   │    │  (Service)  │    │  (Response) │  │
│  └─────────────┘    └─────────────┘    └──────┬──────┘    └─────────────┘  │
│                                               │                              │
│                    ┌──────────────────────────┼─────────────────────────┐   │
│                    ▼                          ▼                         ▼   │
│              ┌─────────┐               ┌─────────┐               ┌────────┐ │
│              │ 知识图谱 │               │ 推理引擎 │               │ 存储层 │ │
│              │   KG    │               │   LLM   │               │  Store │ │
│              └─────────┘               └─────────┘               └────────┘ │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────┐
│                          🧩 模块依赖关系                                     │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│                         ┌─────────────────┐                                  │
│                         │   API Gateway   │                                  │
│                         │   (统一入口)     │                                  │
│                         └────────┬────────┘                                  │
│                                  │                                           │
│              ┌───────────────────┼───────────────────┐                       │
│              │                   │                   │                       │
│              ▼                   ▼                   ▼                       │
│      ┌───────────────┐   ┌───────────────┐   ┌───────────────┐              │
│      │  知识图谱层    │   │   推理引擎层   │   │  Schema管理层  │              │
│      │               │   │               │   │               │              │
│      │ • Multimodal  │   │ • LLM Engine  │   │ • USL Parser  │              │
│      │ • Temporal    │   │ • Explainable │   │ • Version Mgr │              │
│      │ • Hierarchical│   │ • Knowledge   │   │ • Transform   │              │
│      │               │   │   Chain       │   │               │              │
│      └───────┬───────┘   └───────┬───────┘   └───────┬───────┘              │
│              │                   │                   │                       │
│              └───────────────────┼───────────────────┘                       │
│                                  │                                           │
│                                  ▼                                           │
│                         ┌─────────────────┐                                  │
│                         │   Data Layer    │                                  │
│                         │  (数据持久化)    │                                  │
│                         └─────────────────┘                                  │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 🐳 Docker 容器架构

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         Docker Compose 服务拓扑                              │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                        Docker Network: dsl-schema                   │   │
│  │                                                                      │   │
│  │   ┌──────────────┐  ┌──────────────┐  ┌──────────────┐             │   │
│  │   │  api-gateway │  │multimodal-kg │  │ temporal-kg  │             │   │
│  │   │    :8080     │  │    :8000     │  │    :8001     │             │   │
│  │   └──────────────┘  └──────────────┘  └──────────────┘             │   │
│  │                                                                      │   │
│  │   ┌──────────────┐  ┌──────────────┐  ┌──────────────┐             │   │
│  │   │ llm-reasoning│  │     usl      │  │schema-version│             │   │
│  │   │    :8002     │  │    :8003     │  │    :8004     │             │   │
│  │   └──────────────┘  └──────────────┘  └──────────────┘             │   │
│  │                                                                      │   │
│  │   ┌──────────────┐  ┌──────────────┐  ┌──────────────┐             │   │
│  │   │    neo4j     │  │   chromadb   │  │   mongodb    │             │   │
│  │   │    :7474     │  │    :8000     │  │   :27017     │             │   │
│  │   └──────────────┘  └──────────────┘  └──────────────┘             │   │
│  │                                                                      │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 📊 核心组件说明

### 1. 知识图谱层 (Knowledge Graph Layer)

| 组件 | 功能 | 端口 | 存储 |
|------|------|------|------|
| 多模态知识图谱 | 文本+图像知识存储 | 8000 | ChromaDB |
| 时序知识图谱 | 时间演化追踪 | 8001 | 时间序列DB |
| 层次化知识表示 | 金字塔知识抽象 | - | Neo4j |

### 2. 推理引擎层 (Reasoning Engine Layer)

| 组件 | 功能 | 端口 | 依赖 |
|------|------|------|------|
| LLM推理引擎 | OpenAI/Claude集成 | 8002 | OpenAI API |
| 可解释性推理 | 规则+路径记录 | - | KG |
| 知识链方法 | 低层到高层抽象 | - | LLM+KG |

### 3. Schema管理层 (Schema Management Layer)

| 组件 | 功能 | 端口 | 特性 |
|------|------|------|------|
| USL解析器 | 统一Schema语言 | 8003 | 语法解析 |
| 版本管理 | Schema版本控制 | 8004 | 迁移工具 |
| 转换引擎 | Schema转换 | - | 增量转换 |

---

## 🔗 接口规范

### REST API 规范

```
Base URL: http://localhost:8080/api/v1

Endpoints:
├── /health              # 健康检查
├── /services            # 服务列表
├── /multimodal_kg/*     # 多模态知识图谱
├── /temporal_kg/*       # 时序知识图谱
├── /llm_reasoning/*     # LLM推理
├── /usl/*               # USL解析
├── /hierarchical/*      # 层次化知识
├── /knowledge_chain/*   # 知识链
├── /explainable/*       # 可解释推理
└── /schema_version/*    # 版本管理
```

---

## 📈 性能指标

| 指标 | 目标值 | 说明 |
|------|--------|------|
| API响应时间 | < 200ms | P95延迟 |
| 并发处理 | 1000 QPS | 网关处理能力 |
| 知识图谱查询 | < 100ms | 简单查询 |
| LLM推理 | < 5s | 复杂推理 |
| 系统可用性 | 99.9% | 年度可用性 |

---

## 🛡️ 安全架构

```
┌─────────────────────────────────────────────────────────────┐
│                        安全层                                │
├─────────────────────────────────────────────────────────────┤
│  • API认证 (API Key / JWT)                                  │
│  • 请求限流 (Rate Limiting)                                 │
│  • 输入验证 (Input Validation)                              │
│  • 数据加密 (TLS/SSL)                                       │
│  • 访问控制 (RBAC)                                          │
└─────────────────────────────────────────────────────────────┘
```

---

**相关文档**:
- [DEPLOYMENT_GUIDE.md](DEPLOYMENT_GUIDE.md) - 部署指南
- [API_REFERENCE.md](API_REFERENCE.md) - API参考
- [QUICK_START.md](QUICK_START.md) - 快速入门

---

*最后更新: 2026-02-16*
